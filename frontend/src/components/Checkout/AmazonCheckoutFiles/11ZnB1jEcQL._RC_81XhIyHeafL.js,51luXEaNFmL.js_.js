(function(c){var g=window.AmazonUIPageJS||window.P,h=g._namespace||g.attributeErrors,a=h?h("WidgetStreamer",""):g;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,g,h){c.when("jQuery","widget-streamer-action-ws-append","widget-streamer-action-ws-prepend","widget-streamer-action-ws-update","widget-streamer-action-ws-event").register("widget-streamer-actions",function(a,d,e,b,f){var c={"ws-append":d,"ws-prepend":e,"ws-update":b,"ws-event":f},k={execute:a.noop};
return{create:function(f){var b,e,d;b=k;if(a.isArray(f)&&f.length&&f[0]){b=f[0];e=c[b];d="widget-streamer-action-"+b;if("function"!==typeof e)throw Error("Action: "+b+" is not supported. Register component "+d+" to handle this action");b=e(f)}return b}}});"use strict";c.register("widget-streamer-jquery-action",function(){return function(a,d,e){var b,f;if(!a||3>a.length)throw Error("Can not create update action, insufficient data in chunk: "+JSON.stringify(a));b=a[1];f=a[2];return{execute:function(a){var c=
a._$target.find(b).add(a._$target.filter(b));a._isTargetUpdated?e(c,f):d(c.get(0),f)}}}});"use strict";c.when("widget-streamer-jquery-action").register("widget-streamer-action-ws-update",function(a){return function(d){return a(d,function(a,b){a.innerHTML=b},function(a,b){a.html(b)})}});"use strict";c.when("widget-streamer-jquery-action").register("widget-streamer-action-ws-append",function(a){return function(d){return a(d,function(a,b){a.innerHTML+=b},function(a,b){a.append(b)})}});"use strict";c.when("widget-streamer-jquery-action").register("widget-streamer-action-ws-prepend",
function(a){return function(d){return a(d,function(a,b){a.innerHTML=b+a.innerHTML},function(a,b){a.prepend(b)})}});c.register("widget-streamer-action-ws-event",function(){return function(a){var d=a[1],c;try{c=JSON.parse(a[2])}catch(b){c=null}return{execute:function(a){a._emitEvent(d,c)}}}});"use strict";c.register("widget-streamer-utils",function(){return{isStreamingAjax:function(a){if(a&&"function"===typeof a.getResponseHeader)a=a.getResponseHeader("Content-Type");else if(a&&a.http&&"function"===
typeof a.http.getResponseHeader)a=a.http.getResponseHeader("Content-Type");else throw Error("Unable to retrive headers for the given xhr object: "+a);return"application/json-amazonui-streaming"===a}}});"use strict";c.when("A","jQuery","widget-streamer-actions").register("widget-streamer",function(a,c,e){function b(a){a=a||{};this._$originalTarget=a.$target;this._$target=a.$target.clone();this._actions=[];this._isExecutable="undefined"===typeof a.immediateExecution||a.immediateExecution;this._onUpdate=
a.onUpdate||c.noop;this._hasExecutionStarted=!1;this._events=a.events||{};this._isTargetUpdated=!1;this._updateTriggerEvent=a.updateTriggerEvent;this.chunkHandler=c.proxy(this.chunkHandler,this)}b.prototype.chunkHandler=function(a){a=e.create(a);this._actions.push(a);this.executeActions()};b.prototype.enableExecution=function(){this._isExecutable=!0;this.executeActions()};b.prototype.executeActions=function(){var a;if(this._isExecutable&&this._actions.length)for(this._hasExecutionStarted||(this._hasExecutionStarted=
!0,this._updateTriggerEvent||this._updateTarget()),a=this._actions.shift();a;)a.execute(this),a=this._actions.shift()};b.prototype._emitEvent=function(a,b){var e=(this._events||{})[a]||c.noop;a===this._updateTriggerEvent&&this._updateTarget(b);e.call(this,b)};b.prototype._updateTarget=function(){this._onUpdate.apply(this,arguments);this._$originalTarget.html(this._$target.html());this._$target=this._$originalTarget;this._isTargetUpdated=!0};return function(a){return new b(a)}})});
/* ******** */
(function(q){var p=window.AmazonUIPageJS||window.P,C=p._namespace||p.attributeErrors,oa=C?C("CheckoutCommonAsset",""):p;oa.guardFatal?oa.guardFatal(q)(oa,window):oa.execute(function(){q(oa,window)})})(function(q,p,C){q.register("polyfill-indexof",function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(a,k){if(null==this)throw new TypeError('"this" is null or not defined');var g=Object(this),b=g.length>>>0;if(0===b)return-1;k=+k||0;Infinity===Math.abs(k)&&(k=0);if(k>=b)return-1;for(k=
Math.max(0<=k?k:b-Math.abs(k),0);k<b;){if(k in g&&g[k]===a)return k;k++}return-1})});"use strict";q.register("polyfill-filter",function(){Array.prototype.filter||(Array.prototype.filter=function(a){if(void 0===this||null===this)throw new TypeError;var k=Object(this),g=k.length>>>0;if("function"!==typeof a)throw new TypeError;for(var b=[],e=2<=arguments.length?arguments[1]:void 0,f=0;f<g;f++)if(f in k){var m=k[f];a.call(e,m,f,k)&&b.push(m)}return b})});"use strict";q.register("polyfill-json-stringify",
function(){"object"!==typeof JSON&&(JSON={});(function(){function a(a){return 10>a?"0"+a:a}function k(){return this.valueOf()}function g(a){n.lastIndex=0;return n.test(a)?'"'+a.replace(n,function(a){var c=t[a];return"string"===typeof c?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function b(a,e){var d,h,f=c,n,t=e[a];t&&"object"===typeof t&&"function"===typeof t.toJSON&&(t=t.toJSON(a));"function"===typeof w&&(t=w.call(e,a,t));switch(typeof t){case "string":return g(t);case "number":return isFinite(t)?
String(t):"null";case "boolean":case "null":return String(t);case "object":if(!t)return"null";c+=l;n=[];if("[object Array]"===Object.prototype.toString.apply(t)){h=t.length;for(a=0;a<h;a+=1)n[a]=b(a,t)||"null";e=0===n.length?"[]":c?"[\n"+c+n.join(",\n"+c)+"\n"+f+"]":"["+n.join(",")+"]";c=f;return e}if(w&&"object"===typeof w)for(h=w.length,a=0;a<h;a+=1)"string"===typeof w[a]&&(d=w[a],(e=b(d,t))&&n.push(g(d)+(c?": ":":")+e));else for(d in t)Object.prototype.hasOwnProperty.call(t,d)&&(e=b(d,t))&&n.push(g(d)+
(c?": ":":")+e);e=0===n.length?"{}":c?"{\n"+c+n.join(",\n"+c)+"\n"+f+"}":"{"+n.join(",")+"}";c=f;return e}}var e=/^[\],:{}\s]*$/,f=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,m=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,d=/(?:^|:|,)(?:\s*\[)+/g,n=/[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,h=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;
"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=k,Number.prototype.toJSON=k,String.prototype.toJSON=k);var c,l,t,w;"function"!==typeof JSON.stringify&&(t={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=
function(a,e,d){var h;l=c="";if("number"===typeof d)for(h=0;h<d;h+=1)l+=" ";else"string"===typeof d&&(l=d);if((w=e)&&"function"!==typeof e&&("object"!==typeof e||"number"!==typeof e.length))throw Error("JSON.stringify");return b("",{"":a})});"function"!==typeof JSON.parse&&(JSON.parse=function(a,c){function b(a,e){var d,h,f=a[e];if(f&&"object"===typeof f)for(d in f)Object.prototype.hasOwnProperty.call(f,d)&&(h=b(f,d),h!==C?f[d]=h:delete f[d]);return c.call(a,e,f)}a=String(a);h.lastIndex=0;h.test(a)&&
(a=a.replace(h,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(e.test(a.replace(f,"@").replace(m,"]").replace(d,"")))return a=eval("("+a+")"),"function"===typeof c?b({"":a},""):a;throw new SyntaxError("JSON.parse");})})()});"use strict";q.when("A","jQuery","client-side-metrics","weblab-helper","polyfill-filter","polyfill-json-stringify").register("ajax-wrapper",function(a,k,g,b){function e(a,c){function b(a,c){for(var e=0;e<a._options.length;e++){var d=a._options[e];
if(d=c.call(a,d,"object"===typeof d?d.name:d))return d}}this._options=a instanceof e&&c&&c.length?a._options.concat(c):a instanceof e?a._options:a&&a.length?a:[];this.filter=function(a){var c={};b(this,function(b,d){d in a&&(c[d]=a[d])});return c};this.getOption=function(a){return b(this,function(c,b){if(b===a)return c})};return this}function f(a){this._options=a.allowedOptions;this._messageForViolation=a.messageForViolation;this._messageForViolationWithValue=a.messageForViolationWithValue;this._optionName=
a.optionName;this._valueName=a.valueName;this.validate=function(a){for(var c in a)if(a.hasOwnProperty(c)){var b=this._options.getOption(c);if(!b)throw b=this._messageForViolation.replace(this._optionName,c),Error(b);if("object"===typeof b&&!b.validate(a[c]))throw b=this._messageForViolationWithValue.replace(this._optionName,c),b=b.replace(this._valueName,a[c]),Error(b);}};return this}function m(a){try{D.validate(a)}catch(c){console.error(c)}var b=r.filter(a),b=k.extend(b,d(a));return k.ajax(b)}function d(a){if(a.params){if(a.data&&
a.params)throw Error("The option data can not be present with the emulated params option. Merge both and use just one.");return{data:a.params}}}function n(d){try{L.validate(d)}catch(e){console.error(e)}var f={url:C,options:u.filter(d)},n=new k.Deferred;f.url=d.url;if(d.data){if(d.data&&d.params)throw Error("Unsupported options. 'params' and 'data' options are both specified. Remove one of them.");if("object"===typeof d.data)f.options.params=d.data;else if("string"===typeof d.data)b.isSetParamsFormatAsStirngWeblabOn()?
"GET"===d.type?f.url+="?"+d.data:(f.options.params=d.data,f.options.paramsFormat="string"):f.url+="?"+d.data;else throw Error("Unsupported type provided in the 'data' attribute of an AJAX call");}if(d.type){if(d.type&&d.method)throw Error("Unsupported options. 'type' and 'method' options are both specified. Remove one of them.");f.options.method=d.type}if("crossDomain"in d){if("crossDomain"in d&&"withCredentials"in d)throw Error("Unsupported options. 'crossDomain' and 'withCredentials' options are both specified. Remove one of them.");
f.options.withCredentials=d.crossDomain}f=c(f,d,n);f=h(f,d,n);f=t(f,d,n);f=l(f,d,n);f=w(f,d,n);d.beforeSend&&d.beforeSend(f.options);f=z(f,d,n);d=a.ajax(f.url,f.options);return d=n.promise(d)}function h(a,c,d){var b=a.options.success;a.options.success=function(a,c,e){b&&b(a,c,e);d.resolve(a,c,e)};var e=a.options.error;a.options.error=function(a,c,b){e&&e(a,c,b);d.reject(a,c,b)};var f=a.options.abort;a.options.abort=function(a){f&&f(a);d.reject(a,"abort")};return a}function c(a,c){if(!c.complete)return a;
var d=a.options.success;a.options.success=function(a,b,e){d&&d(a,b,e);c.complete(e,"success")};var b=a.options.error;a.options.error=function(a,d,e){b&&b(a,d,e);c.complete(a,"error")};var e=a.options.abort;a.options.abort=function(a){e&&e(a);c.complete(a,"abort")};return a}function l(a,c){var d=a.options.success;a.options.success=function(a,b,e){d&&("text"===c.dataType&&"object"===typeof a&&(a=JSON.stringify(a)),d(a,b,e))};return a}function t(a,c){if(!c.useXMLHttp)return a;var d=a.options.success;
a.options.success=function(a,c,b){b&&(b=b.http);d(a,c,b)};var b=a.options.error;a.options.error=function(a,c,d){a&&(a=a.http);b(a,c,d)};var e=a.options.abort;a.options.abort=function(a){a&&(a=a.http);e(a)};return a}function w(a,c){var d=a.options.success;a.options.success=function(a,c,b){b&&304===b.http.status?d(a,"notmodified",b):d(a,"success",b)};var b=a.options.error;a.options.error=function(a,c,e){a&&a.http.readyState<A.DONE?b(a,"timeout",e):a&&200<=a.http.status&&300>a.http.status&&a.http.readyState===
A.DONE?d(a.http.responseText,"success",a):a&&0==a.http.status?b(a,"abort",e):b(a,"error",e)};return a}function z(a,c){var b=a.options.success;a.options.success=function(a,c,d){v(d,"success");b(a,c,d)};var d=a.options.error;a.options.error=function(a,c,b){v(a,"error");d(a,c,b)};return a}function v(a,c){a?(g.increaseCount("AUI:Ajax:"+c+":xhr:defined"),a.http?g.increaseCount("AUI:Ajax:"+c+":xhr:http:defined"):a.http===C?g.increaseCount("AUI:Ajax:"+c+":xhr:http:undefined"):null===a.http&&g.increaseCount("AUI:Ajax:"+
c+":xhr:http:null")):a===C?g.increaseCount("AUI:Ajax:"+c+":xhr:undefined"):null===a&&g.increaseCount("AUI:Ajax:"+c+":xhr:null")}var A={UNSET:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},r=new e("accepts async beforeSend cache complete contents contentType context converters crossDomain data dataFilter dataType error global headers ifModified isLocal jsonp jsonpCallback method mimeType password processData scriptCharset statusCode success timeout traditional type url username xhr xhrFields".split(" ")),
u=new e("abort accepts cache chunk contentType error headers indicator method params success timeout withCredentials".split(" ")),K=new e(u,[{name:"async",validate:function(a){return a}},"useXMLHttp","beforeSend","complete","crossDomain","dataType","data","type","url"]),x=new e(r,["params"]),L=new f({allowedOptions:K,messageForViolation:"The option %O is not supported in AUI ajax calls and default ajax. Consider using jQuery ajax.",messageForViolationWithValue:"The option %O with value %V is not supported in AUI ajax calls and default ajax. Consider using jQuery ajax.",
optionName:"%O",valueName:"%V"}),D=new f({allowedOptions:x,messageForViolation:"The option %O is not supported in jQuery ajax calls and default ajax. Consider using AUI ajax.",messageForViolationWithValue:"The option %O with value %V is not supported in jQuery ajax calls and default ajax. Consider using AUI ajax.",optionName:"%O",valueName:"%V"}),H=k("meta[name\x3ddefaultAJAX]").attr("content");"jQuery"!==H&&"AUI"!==H&&(H="jQuery");return{default:function(a){try{L.validate(a),D.validate(a)}catch(c){console.error(c)}if("jQuery"===
H)m(a);else if("AUI"===H)n(a);else throw Error("Unknown AJAX method: "+H);},jQuery:m,aui:n,READY_STATE:A}});"use strict";q.when("jQuery").register("weblab-helper",function(a){return{isAJAXWeblabOn:function(){return"1"===a("meta[name\x3dPAGE_CONDUCTOR_AUI_AJAX]").attr("content")},isAjaxStreamingEnabled:function(){return"1"===a("meta[name\x3dENABLE_AJAX_STREAMING]").attr("content")},isNavCFWeblabOn:function(){return"1"===a("meta[name\x3dEMIT_NAV_CF]").attr("content")},isFixExtraPspPrefetchEnabled:function(){return"1"===
a("meta[name\x3dFIX_EXTRA_PSP_PREFETCH]").attr("content")},isRemoveOrderSummaryPrimaryActionBtnTextWeblabOff:function(){return"1"!==a("#is-remove-os-pabt").val()},isSetParamsFormatAsStirngWeblabOn:function(){return"1"===a("meta[name\x3dSET_PARAMS_FORMAT_AS_STRING]").attr("content")},disablePrefetchForScheduledDeliveryWeblabOn:function(){return"1"===a("meta[name\x3dDISABLE_PREFETCH_FOR_SCHEDULED_DELIVERY]").attr("content")},isRemoveAddressFormOnDeleteAddressWeblabOn:function(){return"1"===a("meta[name\x3dREMOVE_ADDRESS_FORM_ON_DELETE_ADDRESS]").attr("content")},
isSOSPExclusiveJSHandlerWeblabOn:function(){return"1"===a("meta[name\x3dSOSP_EXCLUSIVE_JS]").attr("content")},sospPartialAvailabilityWeblabOn:function(){return"1"===a("meta[name\x3dSOSP_PARTIAL_UNAVAILABILITY]").attr("content")},refactorExtractURL:function(){return"1"===a("meta[name\x3dREFACTOR_EXTRACT_URL]").attr("content")},showGiftTextAreaOnWarning:function(){return"1"===a("meta[name\x3dSHOW_GIFT_TEXT_AREA_ON_WARNING]").attr("content")},isInterceptionAddressFormWidthFixEnabled:function(){return"1"===
a("meta[name\x3dFIX_FIELD_WIDTH_IN_CHECKOUT_INTERCEPTION_FIX_ENABLED]").attr("content")},removesGiftOptionOnRush:function(){return"1"===a("meta[name\x3dREMOVE_GIFT_OPTION_RUSH]").attr("content")},isSPCMobileDisplayMoreShipOptionsEnabled:function(){return"1"===a("meta[name\x3dSPC_MOBILE_DISPLAY_MORE_SHIP_OPTIONS]").attr("content")},isMCBMultiTenderWeblabEnabled:function(){return"1"===a("meta[name\x3dMCB_MULTI_TENDER_ENABLED]").attr("content")},isCreateAddressLinkForTaxAddressFormWeblabOn:function(){return"1"===
a("meta[name\x3dCREATE_ADDRESS_IN_TAX_COLLECTION_ENABLED]").attr("content")},isMfaPSD2DeviceDescriptionCollectionEnabled:function(){return"1"===a("meta[name\x3dMFA_PSD2_DEVICE_DESCRIPTION_COLLECTION_ENABLED]").attr("content")},isSospCalendarFixEnabled:function(){return"1"===a("meta[name\x3dSOSP_CALENDAR_FIX]").attr("content")},isUpdateMobileNumberEnabled:function(){return"1"===a("meta[name\x3dUPDATE_MOBILE_NUMBER]").attr("content")},isGILCreditCardEnabled:function(){return"1"===a("meta[name\x3dGIL_CREDIT_CARD_PAYMENT_METHOD]").attr("content")},
isFTCMobileUpsellBannerMetricsEnabled:function(){return"1"===a("meta[name\x3dFTC_MOBILE_UPSELL_BANNER_METRICS_ENABLED]").attr("content")},isPyoClientSideInitiationEnabled:function(){return"1"===a("meta[name\x3dPYO_CLIENT_SIDE_INITIATION]").attr("content")},isNoshiGiftMessageEnabled:function(){return"1"===a("meta[name\x3dGCX_ENABLE_NOSHI_GIFT_MESSAGE]").attr("content")},isSppItemSelectPageTypeFixEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_SPP_ITEMSELECT_PAGETYPE_FIX_ENABLED]").attr("content")},
isFixTfxCurrencyToggleEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_FIX_TFX_CURRENCY_TOGGLE_ENABLED]").attr("content")},isFixTfxInitializeEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_TFX_INITIALIZE_FIX_ENABLED]").attr("content")},isTFXGuaranteedExchangeFeeEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_TFX_GUARANTEED_EXCHANGE_FEE]").attr("content")},isFreshMobileNoScrollOnRefreshEnabled:function(){return"1"===a("meta[name\x3dF3_CHECKOUT_MOBILE_NO_SCROLL_TO_TOP]").attr("content")},
isCSMErrorLoggingEnabled:function(){return"1"===a("meta[name\x3dENABLE_CSM_ERROR_LOGGING]").attr("content")},isCSMATLoggingEnabled:function(){return"1"===a("meta[name\x3dENABLE_CSM_AT_LOG]").attr("content")},isSOSPLinkPatchEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_SOSP_NAV]").attr("content")},isExecutionIdInQueryStringEnabled:function(){return"1"===a("meta[name\x3dADD_EXECUTION_ID_TO_QUERY_STRING]").attr("content")},isDigitalAsinIndexingFixedOnSOSPEnabled:function(){return"1"===
a("meta[name\x3dDIGITAL_ASIN_INDEXING_FIXED_ON_SOSP]").attr("content")},isGdModelUpdateEnabled:function(){return"1"===a("meta[name\x3dGD_MODEL_UPDATE]").attr("content")},isPointsRedemptionPageTypeHeaderFixEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_SPC_POINTS_REDEMPTION]").attr("content")},isCvfOldAmazonUiFixesEnabled:function(){return"1"===a("meta[name\x3dCVF_OLD_AUI_FIXES]").attr("content")}}});"use strict";q.when("A","client-side-metrics").register("weekend-availability-expander-helper",
function(a,k){function g(a){return(a=m[a])?f("#weekend-availability-expander-header-text-"+a).text():f("#weekend-availability-default").text()}function b(){return 1==f("input[name\x3d'isBusinessDefaultWeekendDeliveryEnabled']").attr("value")?!0:!1}function e(a,b){return a&&b?"BOTH":a?"SAT":b?"SUN":"NONE"}var f=a.$,m={BOTH:"both",SAT:"sat",SUN:"sun",NONE:"none"};return{isBusinessDefaultWeekendDeliveryViewActive:b,logExpanderState:function(a,b,e,c){k.increaseCount("checkout:delivery-preferences:"+a+
":expander:"+b+":"+(e&&c?"neverExpanded":c?"collapsed":"expanded"),1)},stateToCheckboxes:function(a){var e=!1,f=!1;if(b()){if("BOTH"===a||"SAT"===a)e=!0;if("BOTH"===a||"SUN"===a)f=!0}else{if("BOTH"===a||"OTH"===a||"SAT"===a)e=!0;if("BOTH"===a||"OTH"===a||"SUN"===a)f=!0}return{isSaturdayChecked:e,isSundayChecked:f}},updateAllOptOutMessages:function(a){1==f("input[name\x3d'isSundayDeliveryPreferenceSuppressed']").attr("value")?a.isSaturdayChecked?f(".weekend-availability-opt-out-box").toggleClass("aok-hidden",
!0):(f(".weekend-availability-opt-out-message").text(f("#weekend-availability-opt-out-sat-text").text()),f(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!1)):a.isSaturdayChecked||a.isSundayChecked?a.isSaturdayChecked?a.isSundayChecked?f(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!0):(f(".weekend-availability-opt-out-message").text(f("#weekend-availability-opt-out-sun-text").text()),f(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!1)):(f(".weekend-availability-opt-out-message").text(f("#weekend-availability-opt-out-sat-text").text()),
f(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!1)):(f(".weekend-availability-opt-out-message").text(f("#weekend-availability-opt-out-both-text").text()),f(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!1))},updateAllTitles:function(a){a=e(a.isSaturdayChecked,a.isSundayChecked);f(".sat-sun-expander-heading-text").text(g(a))},updateAllWeekendAvailabilityStates:function(a){a=e(a.isSaturdayChecked,a.isSundayChecked);f("input[name\x3d'BusinessHours']").attr("value",a)}}});
"use strict";q.when("A","loading-spinner-controller","page-transition-controller","page-conductor","checkout-general-utils","address-utilities","page-detector-current-page","client-side-metrics","weblab-helper").register("address-popovers",function(a,k,g,b,e,f,m,d,n){function h(a){a.getResponseHeader("x-amz-checkout-popover-valid")||b.redirect({conductoraction:{url:"/gp/cart/view.html",type:"redirect"}})}function c(c,l,r){e.protectAgainstDoubleAction("show-add-address-popover",200)||(H=c.popover,
!D('input[name\x3d"preloadAddressPopover"]').length||l.is(":empty")?(l.empty(),l.css("min-height",397),H.updatePosition(!0),k.showSpinner(l,!1,H),c=(new Date).getTime(),r=m.getCurrentPage(),d.increaseCount("checkout:address-popover-pagetype:".curPage,1),r="itemselect"===r||"spp-itemselect"===r&&n.isSppItemSelectPageTypeFixEnabled()?1:0,D.ajax({type:"POST",url:"/gp/buy/addressselect/handlers/popover/display.html?cachebuster\x3d"+c,data:{isBilling:N,isMultiAddress:r},async:!0,cache:!1,headers:{"x-amz-checkout-page":"itemselect"},
success:function(a,c,b){h(b);l.css("min-height",0);u(l,a)},error:b.ajaxRedirect})):(f.customizeFormFromIdentity(l),f.countrySpecificPopoverOptimizationCheck(D("html")),r&&a.trigger("identity-assets")))}function l(a,c){if(!e.protectAgainstDoubleAction("add-new-address",200)){d.resetMetrics();var f=!1;D(".identity-protect-from-errant").each(function(){var a=D(this),a=a.is("input")?a:a.find("input:first");-1!==a.val().search(/(\d[ -]?){13}/)&&(f=!0)});if(f){var l=D(".address-form-security-error:first");
l.length?alert(l.text()):alert("Please check that the address you have entered is correct.")}else{c.$event.preventDefault();k.showSpinner(a,!1,H);var r=D("#domestic-address-popover-form, #international-address-popover-form, #address-popover-suggestions-form").filter(":visible"),l=r.serialize(),n=(new Date).getTime();c=c.$currentTarget.find('input[type\x3d"submit"]').attr("name");"useSelectedAddress"===c?l+="\x26fromSuggestionPage\x3d1":"fromAddressEditToContinue"===c&&(l+="\x26fromAddressEditToContinue\x3d1");
D("#addAddressOnly").length&&(l+="\x26addOnly\x3d1");N&&(l+="\x26isBilling\x3d1");var g="/gp/buy/addressselect/handlers/popover/new.html";if(H){if("domestic-address-popover-form"===r.attr("id")&&(r.find(".enterAddressFormField").blur(),r="#"+a.attr("id")+" div[id^\x3donblur-character-validation-error-]",0<D(r).size())){k.hideSpinner(a);return}g+="/ref\x3dchk_addr_editPopoverSubmit";b.isSPP()&&(H.lock(11),setTimeout(function(){H.unlock(12)},2E3))}var m=null!==M&&M!==C&&null!==P&&P!==C;"useSelectedAddress"===
c&&!N&&m&&(l+="\x26fromSTMAPopover\x3d1");D("#international-address-popover-form").filter(":visible").length&&(l+="\x26showSecondaryForm\x3d1");x()&&Q?t(a,n,l):D.ajax({type:"POST",url:g+"?cachebuster\x3d"+n,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",data:l,async:!0,cache:!1,error:b.ajaxRedirect,success:function(c,e,d){b.isSPP()&&H.unlock(12);h(d);d.getResponseHeader("x-amz-checkout-open-new-popover")?z(c,e,d):d.getResponseHeader("x-amz-checkout-reload-popover")?u(a,c):m?v(d):
A("added",d)}})}}}function t(a,c,d){var f=Q.getNewTaxAddressPopoverURL();D.ajax({type:"POST",url:f+"?cachebuster\x3d"+c,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",data:d,async:!0,cache:!1,error:b.ajaxRedirect,success:function(c,d,f){b.isSPP()&&H.unlock(12);h(f);f.getResponseHeader("x-amz-checkout-reload-popover")?u(a,c):f.getResponseHeader("x-amz-checkout-new-address-id")&&(D(".a-button-close").trigger("click"),e.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"),
c=f.getResponseHeader("x-amz-checkout-new-address-id"),Q.submitTaxAddressFormWithNewAddressId(c))}})}function w(a){if(!e.protectAgainstDoubleAction("show-edit-address-popover",200)){var c=D("#address-suggestions-popover");a.$event.preventDefault();k.showSpinner(c,!1,H);a=D("#address-popover-suggestions-form");var d=a.serialize();a.find('input[type\x3d"radio"]').each(function(){var a=D(this);a.attr("checked")&&(d+="\x26edit_"+a.val()+"\x3d1")});N&&(d+="\x26isBilling\x3d1");H&&b.isSPP()&&(H.lock(11),
setTimeout(function(){H.unlock(12)},2E3));a=(new Date).getTime();D.ajax({type:"POST",url:"/gp/buy/addressselect/handlers/popover/edit.html?cachebuster\x3d"+a,data:d,async:!0,cache:!1,error:b.ajaxRedirect,success:function(a,c,d){b.isSPP()&&H.unlock(12);h(d);z(a,c,d)}})}}function z(c,b,d){D('input[name\x3d"preloadAddressPopover"]').remove();b=d.getResponseHeader("x-amz-checkout-open-new-popover");"suggestions"===b?(D("#address-suggestions-popover").empty().append(c),D("#address-suggestions-popover-link").trigger("click")):
"edit"===b&&(p=1,b=D("#edit-address-popover"),b.empty().append(c),D("#edit-address-popover-link").trigger("click"),u(b,c));a.trigger("identity-assets")}function v(a){a=a.getResponseHeader("x-amz-checkout-new-address-id");var c=(new Date).getTime();D.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html?cachebuster\x3d"+c,data:{action:"update-address",lineitems:M,quantities:P,addresses:a+".home..",returnHTML:0},async:!0,cache:!1,error:b.ajaxRedirect,success:function(a,c,b){A("applied",b)}})}
function A(c,d){var f=(new Date).getTime();D('input[name\x3d"shipToAddress"]').length?(c=function(){b.isSPP()?(g.blockAllActions(),g.shrinkPanel(D(".spp-panel.expanded"),!0)):g.show()},b.isNonBlockingAnimationEnabled()?a.delay(c,0):c(),c=m.getCurrentPage(),b.loadPage(c,"",C,{refTag:"chk_addr_editPopoverSubmit"},C,d)):(d=b.setAjaxTransitionHeader(),D.ajax({type:"POST",headers:d,url:"/gp/buy/shared/handlers/pipeline-dispatch.html?cachebuster\x3d"+f,data:{useCase:"multiAddress",showAddressAdded:c,page:"itemselect"},
dataType:"text",async:!0,cache:!1,error:b.ajaxRedirect,success:function(a,c,d){b.ajaxUpdatePage(a,c,d);D(".a-button-close").trigger("click");e.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")}}))}function r(a){a=D("#"+a);a.length&&a.empty()}function u(c,b){c.html(b);f.customizeFormFromIdentity(c);H.updatePosition(!0);a.trigger("identity-assets");f.countrySpecificPopoverOptimizationCheck(D("html"))}function K(a){a=a.$currentTarget.closest(".lineitem");M=a.find('input[name^\x3d"lineItemEntityID."]').val();
P=a.find('input[name^\x3d"quantity."]').val();a=D("#add-address-popover-link");a.length?a.trigger("click"):D("#add-new-address-popover").trigger("click")}function x(){return n.isCreateAddressLinkForTaxAddressFormWeblabOn()&&0<D("#isTaxAddress").length}function L(){N=D("#isBilling").length?1:0;if(n.isInterceptionAddressFormWidthFixEnabled()){var a=D(".enter-address-form");f.customizeFormFromIdentity(a)}}var D=a.$,H,M,P,p=0,N=0,Q=null;if(!D("html").hasClass("a-ie6"))return a.on("a:popover:show:add-address",
function(a){r("edit-address-popover");r("add-billing-address-popover");N=0;c(a,D("#add-address-popover"),!1)}),a.on("a:popover:show:add-billing-address",function(a){r("edit-address-popover");r("add-address-popover");c(a,D("#add-billing-address-popover"),!0)}),a.on("a:popover:show:address-suggestions",function(a){H=a.popover}),a.on("a:popover:show:edit-address",function(a){H=a.popover;if(e.protectAgainstDoubleAction("show-edit-address-popover",200)||p)p=0;else{var c=D("#edit-address-popover"),d=H.$trigger.closest(".address-edit-link").find("a").attr("href");
c.empty();r("add-address-popover");r("add-billing-address-popover");var f=D("#delete-address-popover-button");f.length&&f.addClass("aok-hidden").addClass("a-disabled");a.popover.updatePosition(!0);k.showSpinner(c,!1,H);a=(new Date).getTime();D.ajax({type:"POST",url:d+"\x26cachebuster\x3d"+a,async:!0,cache:!1,success:function(a,b,d){h(d);u(c,a);f.length&&D("#delete-address-button").length&&f.removeClass("aok-hidden").removeClass("a-disabled")},error:b.ajaxRedirect})}}),a.on("a:popover:show:select-billing-address",
function(c){if(!e.protectAgainstDoubleAction("show-select-billing-address-popover",200)){var d=D("#select-billing-address-popover");d.empty();d.css("min-height",250);c.popover.updatePosition(!0);k.showSpinner(d,!1,c.popover);var f=(new Date).getTime(),l="/gp/buy/billingaddressselect/handlers/popover.html";b.isSPP()&&(l+="/ref\x3dchk_pay_billing_change_coll");r("add-billing-address-popover");D.ajax({type:"POST",url:l+"?cachebuster\x3d"+f,async:!0,cache:!1,success:function(b,e,f){h(f);d.html(b);a.trigger("checkout:reload:spp-billing-address");
d.css("min-height",0);c.popover.updatePosition(!0)},error:b.ajaxRedirect})}}),a.on("a:expander:delivery-expander:toggle:expand",function(a){a=D(".a-expander-content");f.fixOverflow(a)}),a.declarative("close-delete-popover",["click","touchend"],function(a){q.when("a-popover-base").execute(function(c){(c=c.get(a.data.popoverName))&&c.hide()})}),a.declarative("rm-address-action",["click","touchend"],function(a){q.when("a-popover-base").execute(function(c){(c=c.get(a.data.popoverName))&&c.hide()});n.isRemoveAddressFormOnDeleteAddressWeblabOn()&&
(r("edit-address-popover"),r("add-address-popover"),r("add-billing-address-popover"));q.when("page-conductor").execute(function(c){c.continueClicked(null,a.$target)})}),a.declarative("select-billing-address-action",["click","touchend"],function(a){q.when("a-popover-base").execute(function(a){a.get("select-billing-address").hide()});q.when("page-conductor").execute(function(c){c.continueClicked(null,a.$target)})}),D(document).delegate("a.prevent-default-marker","click",function(a){a.preventDefault()}),
a.declarative("select-billing-address-in-popover",["click","touchend"],function(a){q.when("a-popover-base").execute(function(a){(a=a.get("select-billing-address"))&&a.hide()})}),a.declarative("trigger-popover-from-link",["click","touchend"],function(a){e.protectAgainstDoubleAction("trigger-popover-from-link",200)||(P=M=null,D("#add-address-popover-link").trigger("click"))}),a.declarative("add-address-popover-submit",["click","touchend"],function(a){l(D("#add-address-popover"),a)}),a.declarative("add-billing-address-popover-submit",
["click","touchend"],function(a){l(D("#add-billing-address-popover"),a)}),a.declarative("edit-address-popover-submit",["click","touchend"],function(a){l(D("#edit-address-popover"),a)}),a.declarative("address-suggestions-submit",["click","touchend"],function(a){l(D("#address-suggestions-popover"),a)}),a.declarative("delete-address-popover-submit",["click","touchend"],function(a){a=D("#delete-address-button");0<a.length&&a.click()}),a.declarative("edit-address-suggestions",["click","touchend"],w),a.declarative("add-address-popover-edit",
["click","touchend"],function(a){if(!e.protectAgainstDoubleAction("add-address-popover-edit",200)){a.$event.preventDefault();var c=D("#add-address-popover");k.showSpinner(c,!1,H);a=D("#address-popover-suggestions-form").serialize()+"\x26"+a.$currentTarget.find('input[type\x3d"submit"]').attr("name")+"\x3d1";var d=(new Date).getTime();D.ajax({type:"POST",url:"/gp/buy/addressselect/handlers/popover/edit.html?cachebuster\x3d"+d,data:a,async:!0,cache:!1,error:b.ajaxRedirect,success:function(a,b,d){h(d);
u(c,a)}})}}),a.declarative("add-address-popover-toggle",["click","touchend"],function(a){e.protectAgainstDoubleAction("add-address-popover-toggle",200)||(a.$event.preventDefault(),a=a.$currentTarget.closest(".enter-address-form"),f.toggleAddressForm(a,a.siblings(".enter-address-form")))}),a.declarative("select-radio-option",["click","touchend"],function(a){a=a.$currentTarget.find(".radio-option");a.find('input[type\x3d"radio"]').attr("checked","checked");a.closest(".radio-option-list").find(".radio-option").removeClass("radio-option-selected");
a.addClass("radio-option-selected")}),a.declarative("trigger-address-popover",["click","touchend"],function(a){e.protectAgainstDoubleAction("trigger-address-popover",200)||D("#add-address-popover-link").trigger("click")}),a.on("checkout:reload:spp-shipaddress",L),a.on("checkout:reload:spp-billing-address",L),a.on("checkout:reload:itemselect",L),a.on("checkout:reload:spp-itemselect",L),{actionTriggerPopoverFromDropdown:K,actionRegisterTaxAddressController:function(a){x()&&!Q&&a&&(Q=a)}}});"use strict";
q.when("A").register("address-book-controller",function(a){function k(){g("div.address-book").unbind("recalculate-address-height").bind("recalculate-address-height",function(){var a,e=g(),f=0,m=g("div.address-book .js-same-height"),d=m.length;m.css({height:"auto"}).each(function(n){var h=g(this);a=a||h.offset().top;a!==h.offset().top&&(e.height(f),e=g(),f=0,a=h.offset().top);var c=h.height();e=e.add(h);c>f&&(f=c);n===d-1&&0<f&&e.height(f)})}).trigger("recalculate-address-height");g(p).unbind("resize.checkout-as").bind("resize.checkout-as",
function(){g("div.address-book").trigger("recalculate-address-height")})}var g=a.$;a.on("checkout:reload:spp-shipaddress",k);a.on("checkout:reload:shipaddressselect",k);a.on("checkout:reload:billingaddressselect",k);a.on("checkout:reload:spp-billing-address",k)});"use strict";q.when("A","client-side-metrics","weblab-helper").register("address-utilities",function(a,k,g){function b(a){a.find("input").each(function(){var a=d(this),c=a.outerWidth(!0),b=a.parent().outerWidth(!0);c>b&&a.attr("size")&&(document.getElementById(a.attr("id")).removeAttribute("size"),
a.width("100%"))})}function e(a){if(d('input[name\x3d"useLiveAUI"]').length)q.when("p-detect").execute(function(c){c.capabilities.inputPlaceholder&&a.find(".field-description").each(function(){var a=d(this),c=a.text(),b=a.closest(".a-col-right").find(":not(.address-form-skip-js-tweaks):not(.address-form-skip-js-tweaks *) input");b.attr("maxlength")<c.length&&b.attr("size",c.length);b.attr("placeholder",a.text())})}),a.find("input").each(function(){d(this).outerWidth()}),a.find("input[type\x3d'text'], select").each(function(){var a=
d(this).closest(".full-width-config"),c=d(this);0===a.find(".a-popover-trigger").length&&(g.isInterceptionAddressFormWidthFixEnabled()?c.addClass("addressform-textfield-width"):c.width("96%"))});else{q.when("p-detect").execute(function(c){c.capabilities.inputPlaceholder?a.find(".field-description").each(function(){var a=d(this),c=a.text(),b=a.closest(".a-column").find(":not(.address-form-skip-js-tweaks):not(.address-form-skip-js-tweaks *) input");b.attr("maxlength")<c.length&&b.attr("size",c.length);
b.attr("placeholder",a.text())}):a.find(".field-description").each(function(){var a=d(this);a.find("br").remove();a.show()})});a.find(".popover-field-label").each(function(){var a=d(this);a.find("b").each(function(){var a=d(this);a.text(d.trim(a.text()))});a.find("font").each(function(){var a=d(this);"-2"===a.attr("size")&&a.remove()})});var e=d(".enter-address-form");b(e);var c=0,e=a.find(".one-new-address-form-field").first();e.length&&e.find(".a-column").each(function(){c+=d(this).outerWidth()});
a.width(0<c?c:"")}}function f(b){function d(){v=e.val();(A=m[v])&&f.find(".learn-more a").text(A.popOverLinkText)}var c=p.P&&p.P.AUI_BUILD_DATE,e=b.find("#enterAddressCountryCode"),f=b.find(".country-specific-form-input"),g,m;c?(g=f.find("input"),m=b.find(".country-specific-config").data("popovercountryconfig")):(k.increaseCount("removeauijs2"),g=f.find("#"+f.data("inputid")),m=f.find(".country-specific-config").data("popovercountryconfig"));if(e.length&&f.length&&g.length&&m){var v=e.val(),A=m[v];
e.unbind("change.countryChangeConfigUpdate").bind("change.countryChangeConfigUpdate",d);d();var r=c?"show":"beforeShow";a.on("a:popover:"+r+":checkout-"+f.data("inputid")+"Name",function(a){"beforeShow"===r&&k.increaseCount("removeauijs3");A&&(a.popover.$popover.find(".a-popover-header h4").html(A.popOverTitle),a.popover.$popover.find(".a-popover-inner").html(A.popOverText),a.popover.updatePosition())})}}function m(a){function b(){var a=e.val();(a=m[a])?(a=(a=a.label)||"",g.attr("placeholder",d("\x3cdiv /\x3e").html(a).text().replace(":",
"")),f.show()):f.hide()}var c=p.P&&p.P.AUI_BUILD_DATE,e=a.find("#enterAddressCountryCode"),f=a.find(".country-specific-form-input-mobile"),g,m;c?(g=f.find("input"),m=a.find(".country-specific-config").data("labelcountryconfig")):(k.increaseCount("removeauijs3"),g=f.find("#"+f.data("inputid")),m=f.find(".country-specific-config").data("labelcountryconfig"));e.length&&f.length&&g.length&&m&&(e.unbind("change.countryChangeLabelUpdate").bind("change.countryChangeLabelUpdate",function(){f.hasClass("initial-edit-value")?
f.removeClass("initial-edit-value"):g.val("");b()}),b())}var d=a.$;q.when("a-checkbox").execute(function(b){a.declarative("delivery-preferences-weekend-availability-checkbox-triggered","click",function(a){if("undefined"!==typeof a.$target){var c=a.$target.val();a.$target.is(":checked")&&("NONE"===c?(b("#delivery-preferences-weekend-availability-sat").uncheck(),b("#delivery-preferences-weekend-availability-sun").uncheck()):"SAT"!==c&&"SUN"!==c||b("#delivery-preferences-weekend-availability-none").uncheck())}})});
a.declarative("wdp-redesign-addresstype-radio-clicked","click",function(a){var b=a.$target.context.id;a=d(".com-businesshours-text");var c=d("#delivery-preferences-weekend-availability-sat").is(":checked"),e=d("#delivery-preferences-weekend-availability-sun").is(":checked");"devyPrefs_AddressType_COM"===b?(k.increaseCount("WDPTotalCOMClick"),d(".wdp-res").removeClass("a-color-base-background").addClass("a-color-alternate-background"),d(".wdp-com").removeClass("a-color-alternate-background").addClass("a-color-base-background"),
d(".wdp-BusinessHours").removeClass("aok-hidden")):"devyPrefs_AddressType_RES"===b?(k.increaseCount("WDPTotalRESClick"),d(".wdp-com").removeClass("a-color-base-background").addClass("a-color-alternate-background"),d(".wdp-res").removeClass("a-color-alternate-background").addClass("a-color-base-background"),d(".wdp-BusinessHours").addClass("aok-hidden")):"delivery-preferences-weekend-availability-sat"===b?(k.increaseCount("WDPTotalSATClick"),b=c?e?"BOTH":"SAT":e?"SUN":"OTH",a.addClass("aok-hidden"),
d(".com-businesshours-"+b).removeClass("aok-hidden")):"delivery-preferences-weekend-availability-sun"===b&&(k.increaseCount("WDPTotalSUNClick"),b=e?c?"BOTH":"SUN":c?"SAT":"OTH",a.addClass("aok-hidden"),d(".com-businesshours-"+b).removeClass("aok-hidden"))});return{toggleAddressForm:function(a,f){a.hide();f.find("div.a-alert-error:not(.js-originally-shown-imb)").hide();a.find("input[type\x3d'text'], select, input[type\x3d'radio']:checked, input[type\x3d'hidden']").each(function(){var a=d(this),b=a.attr("name")||
a.data("copyto")||a.attr("id");if(!a.is(":disabled")&&!a.find(":selected").is(".js-not-a-value")){var e=f.find("input[name\x3d'"+b+"']");"enterAddressLandmark"===b&&(e=f.find("input[name\x3d'Landmark']"));"Landmark"!==b||e.length||(e=f.find("input[name\x3d'enterAddressLandmark']"));1<e.length&&a.is("input[type\x3d'radio']")?e.filter("[value\x3d'"+a.val()+"']").attr("checked",!0):e.is("select")?e.find("option[value\x3d'"+a.val()+"']").attr("selected",!0):a.is("input[type\x3d'hidden']")||e.is("input[type\x3d'hidden']")||
e.val(a.val())}});f.show();b(f);e(f)},customizeFormFromIdentity:e,fixOverflow:b,countrySpecificLabelOptimizationCheck:function(a){var b=a.find(".enter-address-form");1===b.data("taxidOpt")?setTimeout(function(){m(b)},100):m(b)},countrySpecificPopoverOptimizationCheck:function(a){var b=a.find(".enter-address-form");1===b.data("taxidOpt")?setTimeout(function(){f(b)},100):f(b)}}});"use strict";q.when("A","page-conductor","page-transition-controller","client-side-metrics").register("address-form-helper",
function(a,k,g,b){var e=a.$;a.on("a:popover:afterUpdatePosition:edit-address",function(b){b.popover&&b.popover.isVisible()&&a.trigger("checkout:popoverContentLoaded:edit-address",b.popover)});a.on("a:popover:afterUpdatePosition:add-address",function(b){b.popover&&b.popover.isVisible()&&a.trigger("checkout:popoverContentLoaded:add-address",b.popover)});a.on("a:popover:visible:add-address",function(b){b.popover&&b.popover.isVisible()&&a.trigger("checkout:popoverContentLoaded:add-address",b.popover)});
return{setDestination:function(a){a||(b.increaseCount("checkout:addressForm:setDestination:noRequest",1),a={});var g=a.addressId;g||b.increaseCount("checkout:addressForm:setDestination:noAddressId",1);var d=a.purchaseId||e("input[name\x3d'purchaseId']").val();d||b.increaseCount("checkout:addressForm:setDestination:noPurchaseId",1);a=a.ref||"ox_shipaddress_add_new_addr";e(".a-button-close").trigger("click");a=e("\x3cform/\x3e").attr("action","/gp/buy/addressselect/handlers/continue.html/ref\x3d"+a);
e('\x3cinput name\x3d"addressID"/\x3e').val(g).appendTo(a);e('\x3cinput name\x3d"purchaseId"/\x3e').val(d).appendTo(a);e('\x3cinput name\x3d"action" value\x3d"select-shipping"/\x3e').appendTo(a);k.continueClicked(null,a)},onPageTransitionStart:function(a){k.isSPP()?(g.blockAllActions(),g.showTransitionInContainer(a)):g.show()},onPageTransitionComplete:function(a){k.isSPP()?(g.unblockAllActions(),e(a).find("div.section-overwrap").remove()):g.hide()}}});"use strict";q.when("A","client-side-metrics",
"weblab-helper").register("action-logger",function(a,k){var g=a.$;a.declarative("ue-count",["click","touchend"],function(a){k.increaseCount(a.data.countFlag,a.data.countValue)});return{logUsedPrefetch:function(a,e,f,m){m||(k.increaseCount("Checkout:action-log:MissingRefMarker"),m="");g.ajax({type:"GET",url:"/gp/buy/shared/handlers/log-used-prefetch.html"+m,data:"pageType\x3d"+a+"\x26subPageType\x3d"+e+"\x26relatedRequestId\x3d"+f,dataType:"text",cache:!1})}}});"use strict";q.when("A","weblab-helper").register("ajax-utility",
function(a,k){return{jsonify:function(g){var b;if(b=k.isAJAXWeblabOn()){b=g instanceof Function;var e=g instanceof Array,f=g instanceof String;b=g instanceof Object&&!e&&!b&&!f}if(b)return g;try{g=a.$.parseJSON(g)}catch(m){g=null}return g}}});"use strict";q.when("A","page-conductor","client-side-metrics","weblab-helper").register("button-blocker",function(a,k,g,b){function e(a,c,b,d){k.isSPP()?c.closest("span.a-declarative").data("blockerText",b):c.find("input.a-button-text").data("blockerText",b);
f(d);l?(a.addClass("aok-hidden"),c.removeClass("aok-hidden"),m("#hasTVNavigation").length&&q.when("a-tv").execute(function(c){c.remove(a)})):(g.increaseCount("removeauijs10"),a.hide(),c.show(),c.hasClass("aok-hidden")&&c.removeClass("aok-hidden"))}function f(a){var c=m(".continue-button-blocker-text");c.length&&(a?(c.html(a),c.removeClass("aok-hidden")):(c.addClass("aok-hidden"),c.empty()))}var m=a.$,d={},n=[],h,c,l=p.P&&p.P.AUI_BUILD_DATE,t=!1;b=b.isPyoClientSideInitiationEnabled()?"checkout:unload":
"checkout:beforeReload";a.on(b,function(){n=[];d={};h=""});return{show:function(a,c,b){if(!t){var f=m(".continue-button");if(f.length)if(c){var l=m(".continue-button-blocker");if(l.length){b=b||"";var u=d[a]!==C&&d[a].tooltipText!==c,k=d[a]!==C&&d[a].buttonInlineText!==b;if(0===n.length||!d[a]||u||k)e(f,l,c,b),h=a;d[a]===C&&n.push(a);d[a]={tooltipText:c,buttonInlineText:b}}}else p.console&&p.console.error&&console.error("showBlockerOnContinue should not be called with an empty tooltip."),g.increaseCount("Checkout:ButtonBlocker:EmptyTooltip")}},
hide:function(a){if(!t){if(d[a]!==C){delete d[a];var c=m.inArray(a,n);n.splice(c,1)}var b=m(".continue-button");b.length&&(c=m(".continue-button-blocker"),c.length&&(0===n.length?(f(),l?(c.addClass("aok-hidden"),b.removeClass("aok-hidden"),m("#hasTVNavigation").length&&q.when("a-tv").execute(function(a){a.add(b)})):(g.increaseCount("removeauijs11"),c.hide(),b.show(),b.hasClass("aok-hidden")&&b.removeClass("aok-hidden"))):h===a&&(h=n[0],e(b,c,d[h].tooltipText,d[h].buttonInlineText))))}},lock:function(){t=
!0},unlock:function(){t=!1},getButtonBlocker:function(){c||(c=m(".continue-button-blocker"));return c}}});"use strict";q.when("A","button-blocker","client-side-metrics").register("button-blocker-controller",function(a,k,g){function b(a,c){m[a]!==C&&m[a].state!==c&&(m[a].state=c,e())}function e(){var a=!0,c;f.each(m,function(b,e){c=e.owner;if(e.state===n.DISABLE_CONTINUE)return a=!1,k.show(c,e.toolTipMessage,e.buttonInlineMessage),d||(g.increaseCount("removeauijs12"),f(".continue-button-blocker").css("display",
"inline-block")),!1});a&&k.hide(c)}var f=a.$,m={},d=p.P&&p.P.AUI_BUILD_DATE,n={ENABLE_CONTINUE:"enableContinue",DISABLE_CONTINUE:"disableContinue"};a.on("checkout:beforeReload",function(){m={}});return{disableContinue:function(a,c,d,f){f=f||"";m[c]===C&&(d?(m[c]!==C||(m[c]={state:n.ENABLE_CONTINUE,owner:a,toolTipMessage:d,buttonInlineMessage:f}),e()):p.console&&p.console.error&&console.error("_registerElement should not be called with an empty tooltip."));b(c,n.DISABLE_CONTINUE)},enableContinue:function(a){m[a]!==
C&&b(a,n.ENABLE_CONTINUE)}}});"use strict";q.when("jQuery").register("cache-page-data-controller",function(a){var k={};return{clearCache:function(){k={}},setCachedPageData:function(g,b,e,f,m){var d=[],n=!0;a(".cacheable-spp-panel").each(function(){var c=a(this),b;b=!c||c.find(".is-scheduled-delivery").length?!1:!0;if(!b)return n=!1;c.find(".expand-panel-button").removeClass("a-button-focus");d.push({id:c.attr("id"),content:c[0].outerHTML})});if(n){var h={panels:d};a(".cacheable-spp-section").each(function(){var c=
a(this);h[c.attr("id")]=c[0].outerHTML});k[g+"-"+b]={curPageData:h,state:p.history?history.state:e,page:g,title:document.title||f,url:p.location.href||m}}},getCachedPageData:function(a,b){return k[a+"-"+b]}}});"use strict";q.when("A").register("checkout-general-utils",function(a){function k(a,f,m,d){var n=b.getAssocParamValuesFromUrl(a);!m&&d?delete n[f]:n[f]=m;f=0<=a.indexOf("?")?a.substring(0,a.indexOf("?")):a;f=f+"?"+g.param(n,1);(a=b.getFragmentFromUrl(a))&&(f+="#"+a);return f}var g=a.$,b={moveToNextInput:function(a){a=
a.nextAll(":visible").find("input").get(0);a!==[]&&a.focus()},hide:function(a){a.hide()},show:function(a){p.P&&p.P.AUI_BUILD_DATE&&a.hasClass("aok-hidden")&&a.removeClass("aok-hidden");a.show()},getAssocParamValuesFromUrl:function(a){var b={};if("string"!==typeof a||-1===a.indexOf("?"))return b;a=a.slice(a.indexOf("?")+1);if(!a)return b;-1!=a.indexOf("#")&&(a=a.substring(a,a.indexOf("#")));a=a.split("\x26");for(var g=0;g<a.length;g++){var d=a[g].split("\x3d");b[d[0]]=d[1]}return b},addQueryStringParameter:function(a,
b,g){return k(a,b,g,!1)},addQueryStringParameterOrDeleteIfEmpty:function(a,b,g){return k(a,b,g,!0)},getQueryStringParameter:function(a,f){a=b.getAssocParamValuesFromUrl(a);return f in a?a[f]:C},getFragmentFromUrl:function(a){var b=a.indexOf("#");return-1==b?C:a.substring(b+1)},extractURLParts:function(a){if(!a||"string"!==typeof a)return{};a=/(.*html)(\/ref[^?\n]*)?[?]?(.*)/g.exec(a);var b={};a&&(a[1]&&(b.normalizedUrl=a[1]),a[2]&&(b.refMarker=a[2]),a[3]&&(b.query=a[3]));return b},redirectWithJavascript:function(a){p.location=
b.addQueryStringParameter(a,"hasWorkingJavascript","1")},bindActionEnterKeyOnButton:function(a){a.keyup(function(a){13===a.which&&g(a.target).trigger("click")})},toggleExpanderContent:function(a){a=a.$target.closest(".a-box");a.hasClass("a-single")?a.removeClass("a-single").addClass("a-first"):a.addClass("a-single").removeClass("a-first")},validateNumber:function(a,b,m){g.trim(a);return/^\d+$/.test(a)&&a>=b&&a<=m}};b.protectAgainstDoubleAction=function(){var a={};return function(b,g){if(!b)return p.console&&
p.console.error&&console.error("Function is not used properly, use a unique owner to identify the caller."),!1;if(a.hasOwnProperty(b))return!0;a[b]=1;setTimeout(function(){delete a[b]},g||100);return!1}}();b.logErrorOnLevel=function(a,b){(p.ueLogError||g.noop)({message:a,logLevel:b});if(p.console){var m={FATAL:p.console.error,"default":p.console.warn};b=m[b]||m["default"]}else b=g.noop;b.call(p,a)};b.logError=function(a){b.logErrorOnLevel(a,"FATAL")};b.updateCartByMash=function(a){q.when("safe-mash").execute(function(b){null!==
a&&a!==C&&"1"===g("#updateCartByMash").attr("content")&&b&&b.cart&&b.cart.didUpdate&&b.cart.didUpdate({newCartQuantity:a})})};b.getPosition=function(a,b,g){for(var d=0,n=a.length,h=0;h<n;h++)if(a.charAt(h)===b&&(d++,d===g))return h;return-1};b.limitInputToNumbers=function(a){var b=a.$event.keyCode;-1!==g.inArray(b,[46,8,9,37,39])||-1!==g.inArray(b,[65,67,86])&&!0===a.ctrlKey||(a.$event.shiftKey||(48>b||57<b)&&(96>b||105<b))&&a.$event.preventDefault()};b.nukeDropdowns=function(a){q.when("a-popover-base").execute(function(b){g.each(g(a),
function(){b.remove(this.name)})})};a.on("checkout:reload",function(){g('input[name\x3d"useLiveAUI"]').length||a.defer(function(){g(".a-declarative, .a-button").filter("[data-action]").unbind("keypress.checkout-page").bind("keypress.checkout-page",function(a){13===a.which&&g(this).trigger("click")})})});a.on("checkout:beforeLoadPage",function(){g("div.a-popover").find(".a-declarative:first:[data-action\x3dcustom-popover-close|a-popover-close]").click()});return b});"use strict";q.when("A","weblab-helper").register("client-side-metrics",
function(a,k){var g=a.$,b=null,e=null,f=0,m;a=function(){};var d=p.uet||a,n=p.uex||a,h=!1,c=!1,l=function(a){p.ue&&p.ue.t&&(p.uet(a,b),r("checkout:client-side-metrics:uet:marker:"+a,1,1),k.isCSMATLoggingEnabled()&&null===b&&null===e&&p.ue.isl&&(r("checkout:client-side-metrics:mark:at",1,1),p.uex("at")));"af"===a?h=!0:"fn"===a&&(c=!0)},t=function(a){p.ue&&p.uex&&(p.uex(a,b),r("checkout:client-side-metrics:uex:marker:"+a,1,1))},w=function(a){p.ue&&p.ues&&p.ues("id",b,a)},z=function(){p.ue&&p.ues&&p.ues("ctb",
b,"1")},v=function(){p.ue&&p.ues&&(p.ues("t0",b,(new Date).getTime()),l("ue"),l("bb"))},A=function(a){a?e="ctbajax"+f++:b="ajax"+f++},r=function(a,c,b){"undefined"!==typeof p.ue&&"undefined"!==typeof p.ue.count&&(c=c?c:1,b?p.ue.count(a,(p.ue.count(a)||0)+1):p.ue.count(a,c))},u=function(a){if(a&&a.length){var c=b;b=e;w(a);b=c}},K=function(){m===C&&(m=0<g("#transitionLogging").length);return m},x=function(a,c,b,d){p.ueLogError&&p.ueLogError(a,{message:c,attribution:b,logLevel:d})};return{getscope:function(){return b},
getasyncscope:function(){return e},setmarker:l,sendue:t,setrid:w,setctb:z,resetue:v,createscope:A,setscope:function(a){b=a},increaseCount:r,resetMetrics:function(){b=e;z();v()},setAsyncRequestId:u,sendUEPageLoadStats:function(){!k.isCSMErrorLoggingEnabled()||h&&c||x({message:"Logged ld without both af and fn logged first af:"+h+" fn:"+c},"","checkout-client-side-metrics","ERROR");t("ld");A(1);c=h=!1},isTransitionLoggingEnabled:K,logPageTransition:function(a,c,b,d){if(K()){var f=(new Date).getTime();
g.ajax({type:"POST",url:"/gp/buy/shared/handlers/log-page-transition.html?cachebuster\x3d"+f,data:{fromPage:a,toPage:c},async:!0,cache:!1,timeout:1E3,success:function(a,c,d){var f=d.getResponseHeader("x-amz-checkout-requestid");u(f);b&&b.call(this,a,c,d)},complete:function(a,c){d&&d.call(this,a,c)}})}},logError:x,startWidgetTiming:function(a){d("bb",a,{wb:1})},finishWidgetTiming:function(a){n("ld",a,{wb:1})},setMarkerForWidget:function(a,c){d(a,c,{wb:1})}}});"use strict";q.register("currency-formatter",
function(){function a(k,g){isNaN(g)||(k=Number(k).toFixed(g));k=k.toString();g=0<=k.lastIndexOf(".")?k.lastIndexOf("."):k.length;return 3>=g?k:a(k.substring(0,g-3),0)+","+k.substring(g-3)}return{getNumberWithSeparators:a}});"use strict";q.when("A","client-side-metrics","page-conductor","page-detector").register("delivery-preferences-csm-helper",function(a,k,g,b){function e(a){var f=g.isSPP()?"spp":"mpp",e="desktop";b.isMobile()?e="mobile":b.isTablet()&&(e="tablet");k.increaseCount("checkout:delivery-preferences:"+
e+":"+f+":"+a,1)}function f(a){return 0===a.length?"NoValueSet":a}var m=a.$;return{recordCSM:e,recordCSMWithCurrentFieldValues:function(a,b,h){b=m("input[name\x3d"+b+"]:checked");b.length&&(b=b.val(),e(a+":preference:"+f(b)));h=m("input[name\x3d"+h+"]");h.length&&e(a+":set-as-default:"+(h.is(":checked")?"yes":"no"))},recordCSMForEligiblePages:function(a){a=a||"";e(a+"eligible-page-displayed");var b=m("input[name\x3ddelivery-preferences-preference-set]");b.length&&e(a+"summary-displayed:preference:"+
f(b.val()))}}});"use strict";q.when("page-detector-current-page","A").register("error-feature-detection",function(a,k){function g(a){p.errorFeatureDetection&&p.errorFeatureDetection.safelyLogError?p.errorFeatureDetection.safelyLogError(a):(p.ueLogError&&p.ueLogError(a),p.console&&p.console.error&&console.error(a))}try{k.on("page-detector:page-changed",function(){var b=a.getCurrentPage();if(b&&"spc"===b)try{p.errorFeatureDetection&&p.errorFeatureDetection.enableErrorHandling&&p.errorFeatureDetection.enableErrorHandling()}catch(e){g(e)}else try{p.errorFeatureDetection&&
p.errorFeatureDetection.disableErrorHandling&&p.errorFeatureDetection.disableErrorHandling()}catch(e){g(e)}})}catch(b){g(b)}return{registerFeature:function(a,e){try{p.errorFeatureDetection&&p.errorFeatureDetection.registerFeature&&p.errorFeatureDetection.registerFeature(a,e)}catch(f){g(f)}},markFeatureAvailable:function(a){try{p.errorFeatureDetection&&p.errorFeatureDetection.markFeatureAvailable&&p.errorFeatureDetection.markFeatureAvailable(a)}catch(e){g(e)}},markFeatureUnavailable:function(a){try{p.errorFeatureDetection&&
p.errorFeatureDetection.markFeatureUnavailable&&p.errorFeatureDetection.markFeatureUnavailable(a)}catch(e){g(e)}}}});q.when("error-feature-detection").execute(function(a){a.registerFeature("continue-action",0);a.markFeatureAvailable("javascript-detection");a.markFeatureAvailable("continue-action")});"use strict";q.when("A","loading-spinner-controller","ajax-utility","currency-formatter","page-conductor","page-transition-controller").register("inline-points-register-controller",function(a,k,g,b,e,
f){function m(a){var c=new RegExp(String.fromCharCode(65340),"g"),b=new RegExp(String.fromCharCode(92,92,92,92),"g");a=a.replace(c,String.fromCharCode(92),"g");a=a.replace(b,String.fromCharCode(92));a=a.replace(/\\1/g,String.fromCharCode(34));return a=a.replace(/\\2/g,String.fromCharCode(10))}function d(a){var c=w.$popover.find(".rewards-registration");k.hideSpinner(c);c.children("div").hide();c=c.find(".rewards-registration-error");a&&a.error?(a=c.find("[data-error\x3d'"+a.error+"']"),a.length?a.show():
c.find("[data-error\x3d'rewards_SystemUnavailable']").show()):c.find("[data-error\x3d'rewards_SystemUnavailable']").show();c.fadeIn(300)}function n(a){w=a.popover;var c=w.$popover.find(".rewards-registration");k.showSpinner(c,!1,w);a=c.data("issuer-id");var b=c.data("program-id"),f=c.data("cc-issuer"),e=c.data("cc-brand"),c=c.data("parent-payment-method-id"),l="/gp/buy/payselect/handlers/get-rewards-configuration.html?cachebuster\x3d"+(new Date).getTime();t.ajax({type:"POST",url:l,data:"programid\x3d"+
b+"\x26partner\x3d"+a+"\x26ccpaymentinstrumentid\x3d"+c+"\x26issuer\x3d"+f+"\x26brand\x3d"+e+"\x26hasWorkingJavascript\x3d1",dataType:"text",async:!0,cache:!1,dataFilter:function(a){return g.jsonify(a)},success:function(a,c,b){c=w.$popover.find(".rewards-registration");k.hideSpinner(c);b=a.fields||{};for(var d in b)if(b.hasOwnProperty(d)){var f=b[d],e=c.find("[data-field\x3d'"+f.type+"']");f.value&&e.filter("input").attr("value",f.value);e.parents(".rewardsfield").show()}a.termshtml&&c.find(".rewardstermstext").html(m(a.termshtml));
a.billingzip&&c.find("[data-field\x3dBILLING_POSTAL_CODE]").attr("value",a.billingzip);if(a.displaydata){d=c.find("[data-field]");for(var l in a.displaydata)a.displaydata.hasOwnProperty(l)&&d.filter("[data-field\x3d"+l+"]").html(a.displaydata[l])}a.marketinglink&&c.find("[data-field\x3d'rewards_marketing_link']").html(a.marketinglink);c.find("#rewards-registration-image").show();c.find(".rewards-registration-main").fadeIn(300);w.updatePosition(!0)},error:function(a){d(a)}})}function h(){if(w){var a=
w.$popover.find(".rewards-registration");k.hideSpinner(a);a.find(".rewards-registration-success").hide();a=a.find(".rewards-registration-error");a.hide();a.find("h4").hide();z&&(f.show(),e.isSPP()?e.reloadPage():t("div.pay").length?e.loadPage("payselect","payselect"):t("div.spc").length&&e.loadPage("spc","spc"))}}function c(a){return a.is("input")?a:a.find("input")}function l(){if(w){var a=w.$popover.find(".rewards-registration");a.find(".rewards-registration-main").hide();a.find("#rewards-registration-image").hide();
k.showSpinner(a,!1,w);var f=(new Date).getTime(),e="programid\x3d"+encodeURIComponent(a.data("programId")),e=e+("\x26paymentinstrumentid\x3d"+encodeURIComponent(a.data("parent-payment-method-id"))+"\x26hasWorkingJavascript\x3d1\x26returnjson\x3d1\x26cachebuster\x3d"+f),l=a.find("[data-field]");l.each(function(){var a=t(this).attr("data-field");if("CVV2"===a)e+="\x26registerRewardsCreditCardVerificationNumber\x3d"+encodeURIComponent(t(this).val());else if(t(this).data("entryindex")){if(1===t(this).data("entryindex")){var b=
l.filter("[data-field\x3d"+a+"]").sort(function(a,c){return Number(t(a).data("entryindex"))-Number(t(c).data("entryindex"))});e+="\x26"+a+"\x3d";b.each(function(){e+=encodeURIComponent(t(this).val())})}}else"TERMS_AND_CONDITIONS"===a?c(t(this)).is(":checked")&&(e+="\x26"+a+"\x3dtrue"):e+="\x26"+a+"\x3d"+encodeURIComponent(t(this).val())});f="ox_pay_page_swp_reg_popover_submit";a.data("programId")&&(f+="_"+a.data("programId"));a="/gp/buy/payselect/handlers/register-rewards-account.html/ref\x3d"+f+
"?cachebuster\x3d"+(new Date).getTime();t.ajax({type:"POST",url:a,data:e,dataType:"text",async:!0,cache:!1,dataFilter:function(a){return g.jsonify(a)},success:function(a,c,f){a?a&&0===a.success?d(a):w&&(c=w.$popover.find(".rewards-registration-success"),c.find(".customername").text(a.customername),a.dollarbalancedisplay&&a.pointsbalance&&(c.find("[data-field\x3d'rewardsamount']").html(a.dollarbalancedisplay),c.find("[data-field\x3d'pointsamount']").html(b.getNumberWithSeparators(a.pointsbalance,a.rewardsdecimalplaces)),
c.find(".rewardsuccessbalance").show()),a.showwarnmessage&&c.find(".warnmessage").show(),z=!0,c.fadeIn(300),k.hideSpinner(w.$popover.find(".rewards-registration"))):d()},error:function(a){d(a)}})}}var t=a.$,w,z=!1;a.on("a:popover:show:rewards-registration",n);a.on("a:popover:hide:rewards-registration",h);a.declarative("close-rewards",["click"],function(a){a.$event.preventDefault();a.$target.closest(".a-popover").find(".a-button-close").trigger("click")});a.declarative("rewards-signup",["click"],function(a){a.$event.preventDefault();
l(a)});a.declarative("toggle-reward-signup-button","change",function(a){a=a.$target;var c=w.$popover.find(".rewards-registration");a&&a.is(":checked")?(c.find("#reward-signup-button").removeClass("aok-hidden"),c.find("#disabled-reward-signup-button").addClass("aok-hidden")):(c.find("#reward-signup-button").addClass("aok-hidden"),c.find("#disabled-reward-signup-button").removeClass("aok-hidden"))});a.on("a:popover:beforeShow:cvv2helpcontent",function(a){a.popover.$popover.find(".a-popover-inner").html(t(".cvv2helpcontent").text());
a.popover.updatePosition()});return{displayRewardsRegister:n,hideRewardsRegister:h}});"use strict";q.when("A","error-feature-detection","safe-mash","ready").register("shared-kitchensink",function(a,k,g){var b=a.$;a.on("checkout:reload",function(){(b("body.a-touch").length||b("div.a-touch:first").length)&&b("html").addClass("a-touch");b("form").each(function(){var a=b(this).find('input[name\x3d"hasWorkingJavascript"]');a&&0<a.length?a.val("1"):b(this).append('\x3cinput type\x3d"hidden" name\x3d"hasWorkingJavascript" value\x3d"1" /\x3e')});
g&&(b("div.checkout-tablet a[target\x3d'AmazonHelp']").each(function(){var a=b(this).attr("href"),a=a+(0<=a.indexOf("?")?"\x26app-nav-type\x3dmodal":"?app-nav-type\x3dmodal"),a=a.replace("#","");b(this).attr("href",a);b(this).removeAttr("data-action");b(this).removeAttr("data-help-popup");b(this).removeAttr("onclick")}),b("div.checkout.mobile a[target\x3d'AmazonHelp']").each(function(){var a=b(this).attr("href"),a=a.replace("#","");b(this).attr("href",a);b(this).removeAttr("data-help-popup");b(this).removeAttr("onclick");
b(this).addClass("a-declarative help-popup");b(this).attr("data-action","help-popup")}));if(0<b("div.checkout-tablet").length)for(var a=document.getElementsByTagName("a"),f=0;f<a.length;f++)a[f].href||(a[f].href="#")});b(document).bind("jsdetection",function(){k.markFeatureAvailable("javascript-detection")})});q.when("A","safe-mash","ready").execute(function(a,k){var g=a.$;a.declarative("mash-navigate",["click"],function(a){a=a.$currentTarget.attr("href");k&&k.navigate?k.navigate({url:a}):p.location.href=
a});a.declarative("expander-scroll-there",["click"],function(a){if("false"!==a.$currentTarget.closest(".a-expander-container").find(".a-expander-content").attr("aria-expanded")){var e=g(p),f=g(document),m=a.$currentTarget.offset().top,d=0,n=0,h=function(){p.setTimeout(function(){e.scrollTop(m);d===f.height()?n++:(n=0,d=f.height());10>n&&h()},10)};h()}})});p.amz_js_PopWin=function(a,k,g){(a=p.open(a,k,g))&&a.focus&&a.focus();return!1};var oa=!1;p.confirmPurchase_onSubmit||(p.confirmPurchase_onSubmit=
function(){return oa?!1:oa=!0});"use strict";q.when("A","error-feature-detection","loading-spinner-spp-controller").register("loading-spinner-controller",function(a,k,g){function b(a){if(f&&m){var b,l,r;h&&t?(a=h.getContent(),b=a.innerHeight(),l=a.innerWidth()):(b=a.height(),l=a.width());r=a.offset();a=m.width();var n=m.height();if(d)r="1"===e("input[name\x3dfromAnywhere]").val()?e(document).height():e(p).height(),f.width(e(document).width()).height(r).css("left","0px").css("z-index",2E3),m.css("left",
l/2-a/2+"px").css("top",b/2-n/2+"px").css("z-index",4E3).show();else{var g=e(p),k=t?g.scrollLeft():0;f.css("position","fixed").width(l).height(b).css("z-index",3E3).css("left",r.left-k).css("top",r.top-g.scrollTop());c?m.css("position","fixed").css("left",r.left-k+(l/2-a/2)+"px").css("top",r.top-g.scrollTop()+(b/2-n/2)+"px").css("z-index",4E3).show():m.css("left",l/2-a/4+"px").css("top",b/2-n/4+"px").css("z-index",4E3).show()}}}var e=a.$,f,m,d,n,h,c=!1,l=!1,t=!1,w=!1;a.on("a:popover:positionUpdated",
function(a){if(t&&h&&h.name===a.popover.name&&f&&m){var c=h.getContent();a=c.innerHeight();var b=c.innerWidth(),c=c.offset(),d=e(p);f.width(b).height(a).css("left",c.left-d.scrollLeft()).css("top",c.top-d.scrollTop());m.css("left",c.left-d.scrollLeft()+(b/2-m.width()/2)+"px").css("top",c.top-d.scrollTop()+(a/2-m.height()/2)+"px")}});a.on("checkout:reload",function(){var a="https://images-na.ssl-images-amazon.com/images/G/01/amazonui/loading/loading-4x._V391853216_.gif",b=e("#first-pipeline-load-page-spinner-img");
b.length&&(a=e.trim(b.attr("src")));1>e("#loading-spinner-blocker-doc").length&&(a=e(['\x3cdiv class\x3d"template loading-spinner" style\x3d"display:none"\x3e\x3cdiv class\x3d"loading-spinner-blocker"\x3e\x3c/div\x3e\x3cdiv class\x3d"loading-spinner-inner"\x3e','\x3cimg id\x3d"loading-spinner-img" class\x3d"loading-spinner-img" src\x3d"'+a+'"/\x3e','\x3c/div\x3e\x3c/div\x3e\x3cdiv id\x3d"loading-spinner-blocker-doc" class\x3d"loading-spinner-blocker" style\x3d"display:none;"\x3e\x3c/div\x3e\x3cdiv id\x3d"spinner-anchor" class\x3d"spinner-anchor" style\x3d"display:none"\x3e\x3c/div\x3e'].join("")),
m=f=n=null,"1"===e("#showSpinnerWithoutBox").attr("content")&&a.find(".loading-spinner-inner").addClass("loading-spinner-inner-no-box"),e("body").prepend(a));e("input[name\x3duseModifiedSpinnerResizeFn]").length&&(c=!0);e("#useRelativeSpinner").length&&(l=!0);e("#modifiedBlockerDivSize").length&&(t=!0)});return{showSpinner:function(a,v,A){if(l&&!v&&t&&c&&A)return w=!0,g.showSpinner(a,A);w=!1;0!==a.length&&(h=(d=v)?C:A,n||(n=e(".loading-spinner.template").clone().removeClass("template"),n.show()),
a.append(n),d?(f=e("#loading-spinner-blocker-doc"),a.find(".loading-spinner-blocker").hide()):f=a.find(".loading-spinner-blocker"),f.show(),d&&k.markFeatureUnavailable("continue-action"),m=a.find(".loading-spinner-inner"),b(a))},hideSpinner:function(a,c){if(w)return w=!1,g.hideSpinner(a,c);w=!1;f&&(d&&(f.hide(),k.markFeatureAvailable("continue-action")),n.detach());c&&a.hide()},adjustSize:function(a){return w?g.adjustSize():b(a)}}});"use strict";q.when("A","error-feature-detection").register("loading-spinner-spp-controller",
function(a,k){function g(){if(e&&f){var a=d.innerHeight(),c=d.innerWidth();e.width(c).height(a);f.css("left",c/2-f.width()/2+"px").css("top",a/2-f.height()/2+"px")}}var b=a.$,e,f,m,d,n;a.on("a:popover:positionUpdated",function(a){n&&n.name===a.popover.name&&g()});a.on("checkout:reload",function(){var a="https://images-na.ssl-images-amazon.com/images/G/01/amazonui/loading/loading-4x._V391853216_.gif",c=b("#first-pipeline-load-page-spinner-img");c.length&&(a=b.trim(c.attr("src")));1>b(".loading-spinner-spp").length&&
(a=b(['\x3cdiv class\x3d"template loading-spinner-spp" style\x3d"display:none"\x3e\x3cdiv class\x3d"loading-spinner-spp-blocker"\x3e\x3c/div\x3e\x3cdiv class\x3d"loading-spinner-spp-inner"\x3e','\x3cimg class\x3d"loading-spinner-spp-img" src\x3d"'+a+'"/\x3e',"\x3c/div\x3e\x3c/div\x3e"].join("")),f=e=m=null,"1"===b("#showSpinnerWithoutBox").attr("content")&&a.find(".loading-spinner-inner").addClass("loading-spinner-inner-no-box"),b("body").prepend(a))});return{showSpinner:function(a,c){0!==a.length&&
(n=c,d=a,m||(m=b(".loading-spinner-spp.template").clone().removeClass("template"),m.show()),c.getContent().before(m),d.prepend(m),e=d.find(".loading-spinner-spp-blocker"),e.show(),f=d.find(".loading-spinner-spp-inner"),g())},hideSpinner:function(a,c){e&&m.detach();c&&a.hide()},adjustSize:g}});"use strict";q.when("A","page-transition-controller","ajax-utility","page-detector-current-page","checkout-general-utils","client-side-metrics","safe-mash","cache-page-data-controller","ajax-wrapper","widget-streamer",
"widget-streamer-utils","weblab-helper","temporary-preference-indicator").register("page-conductor",function(a,k,g,b,e,f,m,d,n,h,c,l,t){function w(a){p.ueLogError&&p.ueLogError({message:a},{logLevel:"WARN",attribution:"CheckoutCommonAsset-PageConductor"})}function z(a){fa&&(a?(a["x-amz-checkout-transition"]||(a["x-amz-checkout-transition"]="ajax"),a["x-amz-checkout-type"]||(a["x-amz-checkout-type"]="spp")):a={"x-amz-checkout-transition":"ajax","x-amz-checkout-type":"spp"});return a}function v(){ka=
!1;ca=null;va=0;la=!1;J=null}function A(a){var c=parseInt(S("#checkoutDisplayPage").data("delaySetTitle"),10)||0;c?p.setTimeout(function(){document.title=a},c):document.title=a}function r(c){"function"===typeof a.state.parse&&a.state.parse();a.trigger("checkout:beforeReload");a.trigger("checkout:reload");c&&("spp-revieworder"===c?a.trigger("checkout:reload:spc"):a.trigger("checkout:reload:"+c));a.trigger("checkout:afterReload")}function u(a){k.show();var c="/gp/buy/addtocart/handlers/display.html";
a&&(c+="?errorType\x3d"+a);p.location=c}function K(c){(c=S("#pageTypeRedirectedTo").text())&&a.trigger("checkout:reload:"+c)}function x(c,b){var d;if(b.getResponseHeader("x-amz-force-full-page-update"))L(c);else{if(b.getResponseHeader("x-amz-checkout-redirect-addtocart")){(b=g.jsonify(c))?u(b.errorCode):u();return}d=za(c)}c=S("#pipelinedPageTitle").text();A(c);var f=b.getResponseHeader("x-amz-checkout-page");fa?a.delay(function(){r(f)},d):r(f)}function L(a){var c=document.open("text/html","replace");
c.write(a);c.close()}function D(a,c){try{if(c.getResponseHeader("x-amz-force-full-page-update"))L(a);else{if(!V)throw Error("Member _updateDisplayPageContent not set in page-conductor. Make sure 'initFunc' is called.");V(a)}}catch(b){a="Error while replacing page content.",b.message&&(a+="  Error message: "+b.message),q.error(a,"page-conductor","replaceDisplayPage",b)}a=S("#pipelinedPageTitle").text();A(a);c=c.getResponseHeader("x-amz-checkout-page");r(c)}function H(a){var c=parseInt(S("#showPageTransition").attr("content"),
10);(c=isNaN(c)?1:c)||k.hide();c="/gp/buy/shared/handlers/dispatch.html";a&&(a.conductoraction&&a.conductoraction.url?c=a.conductoraction.url:a.pipedata&&a.pipedata.conductoraction&&a.pipedata.conductoraction.url&&(c=a.pipedata.conductoraction.url));c=0<c.indexOf("?")?c+"\x26":c+"?";S("input[name\x3dfromAnywhere][value\x3d1]").length&&(c+="fromAnywhere\x3d1");c=ha(c);m&&S("html").hasClass("a-tablet")&&-1<c.indexOf("/gp/cart/view.html")&&(c="/gp/aw/c?app-action\x3dcart");p.location=c}function M(a,
c,b,f,e){f=f||{};f.pushNewFrame=f.pushNewFrame||"true";f.anchor=f.anchor||C;v();"true"===f.pushNewFrame&&m&&m.navigate&&S("#checkoutDisplayPage").data("useMashNavigateForTransitions")?m.navigate({url:null,transitionEffect:"slide",successCallback:function(){N(a,c,b,f,e)},failCallback:function(a){}}):N(a,c,b,f,e);f.keepCachedPagesData||d.clearCache()}function P(){var a=S("input#isPipelinedPage");return 0<a.length&&"1"===a.val()}function G(a){return l.isExecutionIdInQueryStringEnabled()?a?a.getResponseHeader("x-amz-checkout-executionid"):
e.getQueryStringParameter(p.location.href,"executionId"):S("input#executionId").val()}function N(d,e,n,h,u){function m(a){var c=n.getResponseHeader(a);null==c&&(f.increaseCount("Checkout:PageConductor:Ajax:Update:MissingHeader"),f.increaseCount("Checkout:PageConductor:Ajax:Update:MissingHeader:"+a),w("performUpdatePageFromResponse is missing required header "+a));return c}h=h||{};h.pushNewFrame=h.pushNewFrame||"true";h.anchor=h.anchor||C;var t=m("x-amz-checkout-page"),k=m("x-amz-checkout-requestid");
b.setCurrentPage(t);if(h.freshLoad)h.freshLoad=!1,q.when("first-load-dependencies").execute(function(a){N(d,e,n,h)});else if(t){S("head .aui-page-asset").removeAttr("disabled");S("head .old-pipeline-asset").removeAttr("disabled");f.setAsyncRequestId(k);var O=n.getResponseHeader("x-amz-checkout-redirect");if(O)H({conductoraction:{url:O,type:"redirect"}});else{if(l.isAJAXWeblabOn()&&c.isStreamingAjax(n))l.isAjaxStreamingEnabled()?r(t):(K(n),E(d,t));else if(a.trigger("checkout:unload"),0<S("#checkoutDisplayPage").length?
D(d,n):x(d,n),l.isAjaxStreamingEnabled()&&P()){var O=S("#pipelinedPageTitle").text(),A=m("x-amz-checkout-url"),ea=n.getResponseHeader("x-amz-checkout-additional-page-args");Q(t,O,A,G(n),ea,h.anchor,h.pushNewFrame)}!l.isAjaxStreamingEnabled()&&P()&&(O=S("#pipelinedPageTitle").text(),A=m("x-amz-checkout-url"),ea=n.getResponseHeader("x-amz-checkout-additional-page-args"),Q(t,O,A,G(n),ea,h.anchor,h.pushNewFrame));h.anchor&&(t=S(h.anchor),0===t.length&&(t=h.anchor.replace("#",""),t=S(document.getElementsByName(t))),
t.length&&S(document).scrollTop(t.offset().top));h.logUsedPrefetch&&q.when("action-logger").execute(function(a){a.logUsedPrefetch(m("x-amz-checkout-page-type"),m("x-amz-checkout-sub-page-type"),k,u)})}}else{if(p.getOldAjaxSuccessCallback)return p.getOldAjaxSuccessCallback("ajaxConductor","generalErrorHandling","generalErrorHandling")(d,e,n);d=g.jsonify(d);H(d)}}function Q(a,c,b,d,f,r,h){c&&b&&p.history&&p.history.pushState&&(l.isExecutionIdInQueryStringEnabled()?"true"!==h||history.state&&history.state.page===
a||(b=ha(b),r&&(b+=r),d&&(b=e.addQueryStringParameterOrDeleteIfEmpty(b,"executionId",d)),history.pushState({page:a,additionalURLArgs:f},c,b)):(b=ha(b),r&&(b+=r),d&&(b=e.addQueryStringParameter(b,"executionId",d)),"true"===h&&history.state&&history.state.page!==a&&history.pushState({page:a,additionalURLArgs:f},c,b)))}function E(a,c){a.executeActions();a=S("#pipelinedPageTitle").text();A(a);r(c)}function F(){p.location=pa?"/gp/buy/addtocart/handlers/display.html":"/gp/buy/payselect/handlers/error.html"}
function U(b,d,f,e,r,h){e=e||{};e.refTag=e.refTag||"";e.pushNewFrame=e.pushNewFrame||"true";e.anchor=e.anchor||C;e.refTag&&0!==e.refTag.indexOf("/ref\x3d")&&(e.refTag="/ref\x3d"+e.refTag);b="fromPage\x3d"+b+"\x26page\x3d"+d;(h=G(h))&&(b+="\x26executionId\x3d"+h);f&&(b+="\x26"+f);f=function(){};h=function(){};var g;"function"===typeof e.resultscallback?(d=function(a,c,b){e.resultscallback(a,c,b)},g=function(a,c,b){e.resultscallback(C,c,a)}):(f=function(c){a.trigger("checkout:beforeLoadPage");qa&&qa.abort();
qa=c},d=function(a,b,d){l.isAJAXWeblabOn()&&c.isStreamingAjax(d)||e.callbackBeforePageUpdate&&e.callbackBeforePageUpdate();M(a,b,d,e);e.callbackAfterPageUpdate&&e.callbackAfterPageUpdate()},g=function(a,c,b){"abort"!==c&&("error"===c&&a.readyState===n.READY_STATE.UNSET?q.when("a-tv","mash").execute(function(a,c){p.cordova.exec(null,null,"MASHDisplayErrorPlugin","execute",{})}):(Z(a,c),F()))},h=function(a){qa=null});r={type:"GET",url:(r?r:"/gp/buy/shared/handlers/pipeline-dispatch.html")+e.refTag,
data:b,dataType:"text",async:!0,beforeSend:f,success:d,error:g,complete:h,cache:!1};fa&&(r.headers=z({"x-amz-checkout-transition":"ajax"}));return l.isAJAXWeblabOn()?(r.useXMLHttp=!0,r=l.isAjaxStreamingEnabled()?X(r,e.callbackBeforePageUpdate,e.anchor,e.pushNewFrame):X(r,e.callbackBeforePageUpdate),n.aui(r)):S.ajax(r)}function X(d,f,e,r){d.timeout=5E4;d.data=aa(d.data,"acceptsStreaming\x3d1");var n;n=d.data.match(/.*isAsync=1.*/)?!0:!1;wa=h({$target:S("#checkoutDisplayPage"),updateTriggerEvent:"pageReady",
immediateExecution:!n,updateTarget:S("#checkoutDisplayPage"),onUpdate:function(c){"function"===typeof f&&f();a.trigger("checkout:unload");A(c.title);Q(c.page,c.title,c.url,c.executionId,c.additionalURLArgs,e,r||"true");b.setCurrentPage(c.page)}});d.chunk=wa.chunkHandler;if(!l.isAjaxStreamingEnabled()){var g=d.success;d.success=function(a,b,d){g&&c.isStreamingAjax(d)?g(wa,b,d):g&&g(a,b,d)}}return d}function aa(a,c){return a?a+"\x26"+c:c}function Z(a,c){f.increaseCount("Checkout:PageConductor:Ajax:Error");
l.isAJAXWeblabOn()?(a?(f.increaseCount("Checkout:AUI:Ajax:jqXHR:defined"),w("jqXHR defined throw CheckoutErrorAW under AJAX Weblab, textStatus:"+c+" stateCode:"+a.state+" readyState:"+a.readyState)):a===C?(f.increaseCount("Checkout:AUI:Ajax:jqXHR:undefined"),w("jqXHR undefined throw CheckoutErrorAW under AJAX Weblab")):null===a&&(f.increaseCount("Checkout:AUI:Ajax:jqXHR:null"),w("jqXHR null throw CheckoutErrorAW under AJAX Weblab")),f.increaseCount("Checkout:AUI:Ajax:Error:textStatus:"+c),f.increaseCount("Checkout:AUI:Ajax:Error:statusCode:"+
a.status),f.increaseCount("Checkout:AUI:Ajax:Error:readyState:"+a.readyState)):(a?(f.increaseCount("Checkout:jQuery:Ajax:jqXHR:defined"),w("jqXHR defined throw CheckoutErrorAW using jQuery, textStatus:"+c+" stateCode:"+a.state+" readyState:"+a.readyState)):a===C?(f.increaseCount("Checkout:jQuery:Ajax:jqXHR:undefined"),w("jqXHR undefined throw CheckoutErrorAW using jQuery")):null===a&&(f.increaseCount("Checkout:jQuery:Ajax:jqXHR:null"),w("jqXHR null throw CheckoutErrorAW using jQuery")),f.increaseCount("Checkout:jQuery:Ajax:Error:textStatus:"+
c),f.increaseCount("Checkout:jQuery:Ajax:Error:statusCode:"+a.status),f.increaseCount("Checkout:jQuery:Ajax:Error:readyState:"+a.readyState))}function ga(a,c,b,d){var r=a;c=aa(c,"isClientTimeBased\x3d1");if(l.refactorExtractURL()){var h=e.extractURLParts(a);a=h.normalizedUrl;if(!a)return f.increaseCount("Checkout:PageConductor:submitAjax:url:missingHtml:T1"),w("Unable to normalize url ["+r+"]. Ajax request aborted."),!1;var g=a.indexOf("/gp/buy/");0<g?(a=a.substring(g),f.increaseCount("Checkout:PageConductor:submitAjax:url:removedGpBuy:T1")):
f.increaseCount("Checkout:PageConductor:submitAjax:url:missingGpBuy:T1");h.query?(c+="\x26"+h.query,f.increaseCount("Checkout:PageConductor:submitAjax:url:hasQueryPart:T1")):f.increaseCount("Checkout:PageConductor:submitAjax:url:missingQueryPart:T1");r=h.refMarker;r||(f.increaseCount("Checkout:PageConductor:submitAjax:url:missingRefMarker:T1"),r="");r&&-1===r.indexOf("ref\x3d")&&(f.increaseCount("Checkout:PageConductor:submitAjax:url:refMarkerMalformed:T1"),r="")}else{h=a.indexOf("?");0<h?(c+="\x26"+
a.substring(h+1),a=a.substring(0,h),f.increaseCount("Checkout:PageConductor:submitAjax:url:hasQueryPart:C")):f.increaseCount("Checkout:PageConductor:submitAjax:url:missingQueryPart:C");g=a.indexOf("/gp/buy/");0<g?(a=a.substring(g),f.increaseCount("Checkout:PageConductor:submitAjax:url:removedGpBuy:C")):f.increaseCount("Checkout:PageConductor:submitAjax:url:missingGpBuy:C");if(-1===a.indexOf(".html"))return f.increaseCount("Checkout:PageConductor:submitAjax:url:missingHtml:C"),w("url ["+r+"] is missing html extension. Ajax request aborted."),
!1;h=a.indexOf(".html");r=a.substring(h+5);a=a.substring(0,h+5);r||f.increaseCount("Checkout:PageConductor:submitAjax:url:missingRefMarker:C");r&&-1===r.indexOf("ref\x3d")&&(f.increaseCount("Checkout:PageConductor:submitAjax:url:refMarkerMalformed:C"),r="")}c+="\x26handler\x3d"+a;a={type:"POST",url:"/gp/buy/shared/handlers/async-continue.html"+r,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",headers:z({"x-amz-checkout-transition":"ajax"}),data:c,dataType:"text",async:!0,success:b,
error:function(a,c,b){"abort"!==c&&("error"===c&&a.readyState===n.READY_STATE.UNSET?q.when("a-tv","mash").execute(function(a,c){p.cordova.exec(null,null,"MASHDisplayErrorPlugin","execute",{})}):"function"===typeof d&&(Z(a,c),d()))},cache:!1};return l.isAJAXWeblabOn()?(a.useXMLHttp=!0,X(a),n.aui(a)):S.ajax(a)}function Y(a,c,b,d,f){f=f&&f.action?f.action:a.attr("action");a=a.serialize();d&&(a+="\x26isAsync\x3d1");return ga(f,a,c,b)}function R(a,c,b,d){a=ha(a.attr("href"));d&&(a+="\x26isAsync\x3d1");
return ga(a,"",c,b)}function ba(a){a=a||{};a.logUsedPrefetch=1;M(ca.data,ca.status,ca.response,a,ca.refMarker)}function ha(a){-1===a.toLowerCase().indexOf("hasworkingjavascript")&&(a+=(0<=a.indexOf("?")?"\x26":"?")+"hasWorkingJavascript\x3d1");return a}function y(a){la=!1;ya&&clearTimeout(ya);if(a.is("form"))ea(a)?ba():Y(a,M,F);else if(a.is("a"))if(da(a)){var c;1===parseInt(a.data("keepCachedPagesData"),10)&&(c={keepCachedPagesData:1});ba(c)}else R(a,M,F);else q.error("function called without a trigger",
"page-conductor","handleContinueAction")}function ea(a){return a.is("form")&&null!==ca&&ca.serializedValue===a.serialize()}function da(a){return a.is("a")&&null!==ca&&ha(ca.serializedValue)===ha(a.attr("href"))}function na(a){return xa&&(a.is("form")&&xa!==a.serialize()||a.is("a")&&ha(xa)!==ha(a.attr("href")))}function O(a,b,d,r,h){function n(e,m,D){var x=!0;if("success"===m){if(!l.isAJAXWeblabOn()||!c.isStreamingAjax(D)){var A=g.jsonify(e);null!==A&&A&&A.result&&"noPrefetch"===A.result&&(ca=null,
x=!1)}x&&(ca={},ca.serializedValue=k,ca.data=e,ca.status=m,ca.response=D,ca.refMarker=t)}else ca=null;ka=!1;fa&&q.when("spp-button-blocker").execute(function(a){a.hideDefaultContinueBtnBlocker()});if(la)return y(J),!0;if(x){var w=function(){r?O(a,b,d,!0,h):ra(a)};if(null===ca||"form"===u&&ca.serializedValue!==a.serialize())return w(),!0;b&&(0===b?f.increaseCount("checkoutPrefetchTimeoutSetToZero",1):ya=setTimeout(function(){ca=null;w()},1E3*b))}return!0}if(!P()||0===a.length)return!1;var u=a.get(0).tagName.toLowerCase();
if("form"!==u&&"a"!==u||"function"===typeof h&&!h(u))return!1;b=b||0;d=d||0;r=r||!1;if(ka||va>=d)return!1;ka=!0;fa&&q.when("spp-button-blocker").execute(function(a){a.showDefaultContinueBtnBlocker()});va++;ya&&clearTimeout(ya);var t=e.extractURLParts("form"===u?a.attr("action"):a.attr("href")).refMarker,m,k=null;"form"===u?(k=a.serialize(),m=l.isAJAXWeblabOn()?Y(a,n,n,!0):Y(a,null,null,!0)):"a"===u&&(k=ha(a.attr("href")),m=l.isAJAXWeblabOn()?R(a,n,n,!0):R(a,null,null,!0));l.isAjaxStreamingEnabled()&&
k&&(xa=k);"object"!==typeof m||"function"!==typeof m.always||l.isAJAXWeblabOn()||m.always(n)}function ra(a){var c=parseInt(a.data("prefetchTimeout"),10),b=parseInt(a.data("maxPrefetches"),10);return O(a,c,b,!1,function(c){if(a.find("input:checked").hasClass("no-prefetch"))return!1;if(l.disablePrefetchForScheduledDeliveryWeblabOn()){var b=a.find("div.one-shipment:not(:hidden)").find("input:checked");if(b.parents('[data-a-input-name\x3d"'+b.attr("name")+'"]').hasClass("no-prefetch"))return!1}return"1"===
S("input#block-prefetch").val()||"1"===S("input#block-all-prefetch").val()||"form"===c&&!a.data("checkoutFormReady")?!1:!0})}function sa(){var a=b.getCurrentPage();return"payselect"===a||"spp-payment"===a||"pay"===a}function W(c,b){c&&c.preventDefault();t.isTemporaryPaymentPreferenceFeatureEnabled&&t.isTemporaryPaymentPreferenceFeatureEnabled()&&sa()&&t.hasActiveTemporaryPreference&&t.hasActiveTemporaryPreference()&&v();var d=c?S(c.currentTarget):b;c=function(){if(fa){k.blockAllActions();var a=d.data("shrink-panel"),
c=d.data("loading-text");(a=S("#"+a))&&a.length?a.hasClass("expanded")||k.shrinkPanel(S(".spp-panel.expanded"),!1):a=S(".spp-panel.expanded");k.shrinkPanel(a,!0,c)}else k.show()};f.resetMetrics();!ja||ea(d)||da(d)?c():a.delay(c,0);try{la=!0,J=d,l.isAjaxStreamingEnabled()&&wa&&!na(d)&&wa.enableExecution(),ka||y(d)}catch(e){c="An error occured while click on the continue button.",e.message&&(c+="  Error message: "+e.message),q.error(c,"page-conductor","continueClicked",e)}}function Ba(){S("#checkout-btf-spinner").addClass("aok-hidden")}
var S=a.$,ka,qa,ca,va,la,J,ya,Ea,V,xa,za=function(a){if(!Ea)throw Error("Member _updatePageContent not set in page-conductor. Make sure 'initFunc' is called.");return Ea(a)},fa=!1,pa=!1,ia=!1,ja=!1,ta=!1,wa;v();a.declarative("page-transit-no-update-action","click",function(c){if(!ia){c.$event.preventDefault();f.resetMetrics();var e=c.data.targetDeclarativeActionId;if(e&&(e=S("#"+e),e.length)){e.trigger("click");return}var h=c.data.toPage,e=c.data.fromPage||b.getCurrentPage(),n=c.data.refTag||"chk_"+
e+"_cancel_pri",g=c.data.args,u=c.$currentTarget.find("a.checkout-pipeline-pref-link");fa&&d.setCachedPageData(e,h);if(d.getCachedPageData(h,e)){f.increaseCount("checkout:"+e+":cancelpri",1);n=d.getCachedPageData(h,e);v();b.setCurrentPage(n.page);var m;m=l.isAJAXWeblabOn()?za(n.curPageData):za(JSON.stringify(n.curPageData));if(fa)if(f.isTransitionLoggingEnabled()){var t=(new Date).getTime();f.logPageTransition(e+"-cached",h,C,function(c){c=(new Date).getTime()-t;c<m?a.delay(function(){r(h)},m-c):
r(h)})}else a.delay(function(){r(h)},m);else r(h);n.title&&n.url&&p.history&&p.history.pushState&&history.state&&history.state.page!==n.page&&history.pushState(n.state,n.title,n.url)}else u.length?W(null,u):(f.increaseCount("checkoutSPPCancelNoCachedData",1),u=function(){if(fa)if(k.blockAllActions(),c.data.noShrink)k.show();else{var a=c.data.loadingText,b=S("#"+c.data.shrinkPanel);b.length||(b=c.$currentTarget.closest("div.spp-panel"));k.shrinkPanel(b,!0,a)}else k.show()},ja?a.delay(u,0):u(),U(e,
h,g,{refTag:n,keepCachedPagesData:1}))}});l.isAjaxStreamingEnabled()&&(a.on("checkout:page:atf",function(){k.hide();S("#checkout-btf-spinner").removeClass("aok-hidden")}),a.on("checkout:page:end",function(){Ba()}));a.on("ready",function(){ja=0<S("#executeNonBlockingAnimations").length;ta=0<S("#prefetchFromAddressEnabled").length});a.on("checkout:afterReload",function(){k.hide();l.isAjaxStreamingEnabled()&&Ba();a.delay(f.sendUEPageLoadStats);if(P()){var c=S("form.checkout-page-form:not(:disabled):first"),
b=S("a.checkout-continue-link:not(:disabled):first");S("#useFirstActivePrefetch").length&&(b=S("a.checkout-continue-link:not(:disabled)").filter(function(){return 0<(parseInt(S(this).data("maxPrefetches"),10)||0)}).first());var e=!1;c.length&&(e=ra(c));!e&&b.length&&(e=ra(b));!e&&fa&&(c=S("a.checkout-pipeline-pref-link:not(:disabled):first"),c.length&&(b=c.data("fromPage"),e=c.data("toPage"),d.getCachedPageData(e,b)||(e=ra(c))))}});return{ajaxUpdatePage:M,ajaxRedirect:H,ajaxSorryPage:F,isPageLoadRequestInProgress:function(){return qa?
1:0},submitFormAjax:Y,reloadPage:function(){var a=b.getCurrentPage();U(a,a)},loadPage:U,usePrefetch:ba,makePrefetch:ra,makePrefetchWithParams:O,isPrefetchValidFor:function(a){if(null!==ca){var c=ca.response.getResponseHeader("x-amz-checkout-page");return a===c}return!1},redirect:H,continueClicked:W,initFunc:function(a,c){Ea=a;V=c},overrideIsSPP:function(a){fa=a},isSPP:function(){return fa},overrideAddToCart:function(a){pa=a},isAnimating:function(){return ia},overrideIsAnimating:function(a){ia=a},
setAjaxTransitionHeader:z,isPipeliningOn:P,disablePageNoUpdateTransition:function(){ta&&q.when("a-button").execute(function(a){var c=S(".spp-panel.expanded").data("stepIndex");S(".expand-collapsed-panel-trigger").each(function(){var b=S(this),d=b.parents(".spp-panel").data("stepIndex");if(!c||!d||d>c)b.filter(".clickable-heading").removeClass("clickable-heading").addClass("off-clickable-heading"),a(b.filter(".expand-panel-button")).disable(),b.filter("a.expand-panel-button").addClass("disabled-link"),
b.parents(".a-declarative").addClass("off-declarative").removeClass("a-declarative")});S(".panel-cancel-row").hide()})},enablePageNoUpdateTransition:function(){ta&&q.when("a-button").execute(function(a){S(".off-clickable-heading").addClass("clickable-heading").removeClass("off-clickable-heading");a(".expand-collapsed-panel-trigger.expand-panel-button").enable();S(".off-declarative").addClass("a-declarative").removeClass("off-declarative")})},isNonBlockingAnimationEnabled:function(){return ja},isPrefetchFromAddressEnabled:function(){return ta},
getExecutionId:G,isPrefetchRequestInProgress:function(){return ka}}});q.when("jQuery","page-transition-controller","ajax-utility","page-detector-current-page","checkout-general-utils","page-conductor","cache-page-data-controller","client-side-metrics","weblab-helper","ready").execute(function(a,k,g,b,e,f,m,d,n){if(f.isPipeliningOn()){p.history&&a(p).bind("popstate",function(){var c=this.history.state,e=b.getCurrentPage();c&&c.page&&e&&(c.page!==e||f.isPageLoadRequestInProgress())&&(k.show(),e=a("#checkoutDisplayPage"),
e.data("wipeOnPipelineBackTransition")&&e.empty(),d.resetMetrics(),a("#useFastBackButton").length&&f.isPrefetchValidFor(c.page)?f.usePrefetch({pushNewFrame:!1}):(e="spc"===c.page?"":c.page,f.loadPage(b.getCurrentPage(),e,c.additionalURLArgs,{refTag:"pipelinedBackButton",pushNewFrame:"false"})))});a(document).delegate("form.checkout-page-form","change",function(c){a(c.target).parent().hasClass("no-prefetch-on-change")||(c=a(c.currentTarget),f.makePrefetch(c))});a(document).delegate("form.checkout-page-form",
"submit",function(a){f.continueClicked(a)});a(document).delegate("a.checkout-continue-link","click",function(a){f.continueClicked(a)});a(document).delegate("form.checkout-page-form .submit-button-with-name","click",function(c){c=a(c.currentTarget);a("\x3cinput\x3e").attr({type:"hidden",name:c.attr("name"),value:c.val()}).appendTo(c.closest("form.checkout-page-form"))});var h=!1;a(document).delegate("a.pipeline-link, div.pipeline-link, span.pipeline-link a","touchmove",function(a){h=!0});a(document).delegate("a.pipeline-link, div.pipeline-link, span.pipeline-link a",
"click keypress touchend",function(c){if(h)h=!1,c.preventDefault();else if(e.protectAgainstDoubleAction("pipeline-link"))c.preventDefault();else if("keypress"!==c.type||13===c.which){var b=a(c.currentTarget),n=b.data("pipelineLinkFromPage"),g=b.data("pipelineLinkToPage"),z=b.data("pipelineLinkAnchor"),v=b.data("pipelineLinkRef");v||((v=e.extractURLParts(b.attr("href")).refMarker)?d.increaseCount("Checkout:PageConductor:LoadPage:AddedRefMarker"):d.increaseCount("Checkout:PageConductor:LoadPage:NoRefMarkerInUrl"));
b=b.data("pipelineLinkArgs");g&&(d.resetMetrics(),c.preventDefault(),f.isSPP()&&m.setCachedPageData(n,g),k.show(),c={refTag:v,anchor:z},f.isSPP()&&(c.keepCachedPagesData=1),f.loadPage(n,g,b,c))}});a(document).delegate("a.spclite-dispatch-link","click keypress touchend",function(c){if("keypress"!==c.type||13===c.which){var b=a(c.currentTarget),d=b.data("spcliteLinkFromPage"),e=b.data("spcliteLinkToPage");b.data("spcliteLinkAnchor");var h=b.data("spcliteLinkRef"),b=b.data("spcliteLinkArgs"),n=a("input#executionId").val(),
b=b?b+("\x26executionId\x3d"+n):"executionId\x3d"+n;e&&(c.preventDefault(),k.show(),f.loadPage(d,e,b,{refTag:h},"/gp/buy/shared/handlers/spclite-dispatch.html"))}})}a(document).delegate("input.submit","click touchend",function(){d.resetMetrics()});a(document).delegate("form","submit",function(){d.resetMetrics()});a(document).delegate(".panel-cancel-row a, .clickable-heading","click",function(){d.isTransitionLoggingEnabled()&&d.resetMetrics()});n.isExecutionIdInQueryStringEnabled()&&(a.ajaxSetup({beforeSend:function(a,
b){b.url&&(a=e.getQueryStringParameter(p.location.href,"executionId"),b.url=e.addQueryStringParameterOrDeleteIfEmpty(b.url,"executionId",a));return!0}}),a(document).ajaxSuccess(function(a,b,h){if(h&&h.url&&h.url.match(/\/async-continue|\/set-|\/update-|\/new/i)&&(a=b.getResponseHeader("x-amz-checkout-sub-page-type")||"Unknown",!a.match(/^p-/))){h=f.getExecutionId(b);if(p.history&&p.history.replaceState){var n=e.addQueryStringParameterOrDeleteIfEmpty(p.location.href,"executionId",h,!0);p.history.replaceState(p.history.state,
"",n)}else d.increaseCount("Checkout:PageConductor:NoReplaceState");h||(b=b.getResponseHeader("x-amz-checkout-page-type")||"Unknown",d.increaseCount("Checkout:PageConductor:"+(null===h?"ExecutionIdIsNotSet":"ExecutionIdIsEmpty")+":"+b+":"+a,1))}}))});"use strict";q.when("A","a-popover-base","a-popover-util").register("checkout-modal-popover",function(a,k,g){function b(c){return c.disableHide?function(){}:function(){var b=this;b.animating=!0;a.fadeOut(this.$popover,250);c.secondaryPopover||n("#a-popover-modal").hide();
a.delay(function(){b.animating=!1},250)}}function e(a,c){var d=b(c);a=a.$event.triggerPositioningElement?a.$event.triggerPositioningElement:a.$declarativeParent;(h=k.show({$trigger:a,name:c.name,skin:l(c.header,c.closeButton,c.closeTextOverride),content:c.content,url:c.url,data:c.data,update:w,alone:c.alone?"true"===c.alone:!0,position:c.position||"triggerVertical",hide:d}))&&h.$trigger!==a&&(h.$trigger=a,h.updatePosition())}function f(a,d){d.disableHide=!0;var e=b(d);c=!1;(d=k.show({$trigger:a.$declarativeParent,
skin:t(d.header,d.footer,d.closeButton,d.contentClass),name:d.name,requestURL:d.url,position:"windowCenter",update:w,data:d.data,updatePosition:d.allowScrollOnPage?z:v,modal:!0,alone:d.alone?"true"===d.alone:!0,show:function(){this.animating=!0;this.$popover.show();n("#a-popover-modal").show();this.animating=!1},hide:e}))&&d.$trigger!==a.$declarativeParent&&(d.$trigger=a.$declarativeParent,d.updatePosition())}function m(c){var b=c.$declarativeParent;a.delay(function(){d(c,b)},250)}function d(c,b){h&&
(g.eventOccursWithin(c,b)||g.eventOccursWithin(c,h.$popover))?a.delay(function(){d(c,b)},250):k.hide(b)}var n=a.$,h,c=!1,l=function(a,c,b){return function(d){var e=b;b===C&&(e=n("input#closeButtonText").val()||"");var f="";e&&(f='\x3ca href\x3d"#" data-action\x3d"custom-popover-close" class\x3d"a-declarative popover-close-link"\x3e'+e+"\x3c/a\x3e\x26nbsp;");e="false"===c?"":['\x3cdiv class\x3d"popover-close-section"\x3e',f,'\x3c/div\x3e\x3cbutton data-action\x3d"custom-popover-close" class\x3d"a-button-close a-declarative" role\x3d"button"\x3e\x3ci class\x3d"a-icon a-icon-close"\x3e\x3c/i\x3e\x3c/button\x3e'].join("");
return['\x3cdiv class\x3d"a-popover"\x3e\x3cdiv class\x3d"a-popover-wrapper"\x3e',a||e?['\x3cdiv class\x3d"a-popover-header"\x3e\x3ch4\x3e',a,"\x3c/h4\x3e",e,"\x3c/div\x3e"].join(""):"",'\x3cdiv class\x3d"a-popover-inner"\x3e',d,'\x3c/div\x3e\x3cdiv class\x3d"a-arrow-border"\x3e\x3cdiv class\x3d"a-arrow"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'].join("")}},t=function(a,c,b,d){return function(e){var f=n("input#closeButtonText").val()||"",h="";f&&(h='\x3ca href\x3d"#" data-action\x3d"custom-popover-close" class\x3d"a-declarative popover-close-link"\x3e'+
f+"\x3c/a\x3e\x26nbsp;");f="false"===b?"":['\x3cdiv class\x3d"popover-close-section"\x3e',h,'\x3c/div\x3e\x3cbutton data-action\x3d"custom-popover-close" class\x3d"a-button-close a-declarative" role\x3d"button"\x3e\x3ci class\x3d"a-icon a-icon-close"\x3e\x3c/i\x3e\x3c/button\x3e'].join("");f=a||f?['\x3cdiv class\x3d"a-popover-header huawei-device-header-fix"\x3e\x3ch4\x3e',a,"\x3c/h4\x3e",f,"\x3c/div\x3e"].join(""):"";h="";if(c){var l=n("#a-popover-footer-"+c);0<l.length&&(h=['\x3cdiv class\x3d"a-popover-footer"\x3e',
l.html(),"\x3c/div\x3e"].join(""))}return['\x3cdiv class\x3d"a-popover a-popover-modal"\x3e\x3cdiv class\x3d"a-popover-wrapper"\x3e',f,'\x3cdiv class\x3d"a-popover-inner ',d,'"\x3e',e,"\x3c/div\x3e",h,'\x3cdiv class\x3d"a-arrow-border"\x3e\x3cdiv class\x3d"a-arrow"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'].join("")}};a.declarative("custom-popover-close",["click","touchend"],function(c){c.$event.preventDefault();var b=c.$target;n("html").hasClass("a-ie6")||n("html").hasClass("a-ie7")||
n("html").hasClass("a-ie8")?b.closest(".a-popover").hide():a.fadeOut(b.closest(".a-popover"),250);n("#a-popover-modal").hide();a.trigger("a:declarative:a-popover-close:click",{$target:b,$event:c.$event,$currentTarget:c.$currentTarget})});a.on("a:popover:positionUpdated",function(a){a=a.popover.$popover;0>a.offset().left&&a.offset({left:0});0>a.offset().top&&a.offset({top:0})});a.on("a:popover:show",function(a){if(a.popover&&a.popover.$trigger){var c=a.popover.$trigger.data("aCheckoutModalPopover");
c&&c.allowScrollOnPage&&a.popover.$popover.css("position","absolute")}});var w=function(a){n(".a-popover-inner",this.$popover).html(a)},z=function(a){if(!c||a)v.call(this,!0),c=!0},v=function(a){var c=n(p),b=c.height()/2,d=c.width()/2,e=this.$popover.height()/2,f=this.$popover.width()/2,b=b-e;if(a||"fixed"!==this.$popover.css("position"))b+=c.scrollTop();a=Math.max(0,d-f);b=Math.max(0,b);this.$popover.css({top:b,left:a})};a.declarative("a-checkout-popover",["click","mouseenter","mouseleave","keyup",
"touchend"],function(a){a.data.showOnHover&&"touchend"!==a.type?"mouseenter"===a.type||"click"===a.type?e(a,a.data):"mouseleave"===a.type&&m(a):("click"===a.type||"touchend"===a.type||"keyup"===a.type&&a.$event.manualTrigger)&&e(a,a.data)});a.declarative("a-checkout-modal-popover",["click","keyup","touchend"],function(a){("click"===a.type||"touchend"===a.type||"keyup"===a.type&&a.$event.manualTrigger)&&f(a,a.data)});a.on("checkout:reload",function(){a.defer(function(){0===n("#a-popover-modal").length&&
n("body").append('\x3cdiv id\x3d"a-popover-modal" /\x3e')})});return{hideById:function(a){k.hide(a)},createModal:f}});"use strict";(function(){var a=!1;q.when("A").register("page-detector",function(k){function g(){return b("checkout-as")}function b(a){d||(d={});d.hasOwnProperty(a)||(d[a]=0<m("div."+a).length);return d[a]}function e(){return b("checkout.pay")}function f(){return b("checkout.spc")}var m=k.$,d;k.on("checkout:reload",function(){d={};a||q.when("page-detector-current-initializer").execute(function(a){a.initializeDetectorWithCurrentPage(null)})});
return{isAddressSelect:g,isAddressTranslation:function(){return b("translate-address-form")},isDesktopPayment:function(){return e()&&b("pay-desktop")},isDesktopSpc:function(){return f()&&b("spc-desktop")},isMobileAddressSelect:function(){return g()&&b("checkout-as-mobile")},isMobilePayment:function(){return e()&&b("pay-mobile")},isMobileSpc:function(){return f()&&b("spc-mobile")},isTabletAddressSelect:function(){return g()&&b("checkout-as-tablet")},isTabletPayment:function(){return e()&&b("pay-tablet")},
isTabletSpc:function(){return f()&&b("spc-tablet")},isSpcLite:function(){return f()&&b("spclite")},isPayment:e,isSosp:function(){return b("checkout.sosp")},isSpc:f,isMobile:function(){return b("checkout.mobile")},isTablet:function(){return b("checkout.tablet")}}});q.register("page-detector-current-initializer",function(){return{initializeDetectorWithCurrentPage:function(k){if(!a){var g=k;q.register("page-detector-current-page",function(){return{getCurrentPage:function(){return g},setCurrentPage:function(a){var e=
g;g=a;q.when("A").execute(function(f){f.trigger("page-detector:page-changed",e,a)})}}});a=!0}}}})})();"use strict";q.when("jQuery","loading-spinner-controller").register("page-spinner-controller",function(a,k){function g(){"function"===typeof z.blockAllActions&&z.blockAllActions()}function b(){"function"===typeof z.unblockAllActions&&z.unblockAllActions()}function e(a){"function"===typeof z.showTransitionInContainer&&z.showTransitionInContainer(a)}function f(){var c=a(p).width(),b=a(p).height(),d=
a(p),e=0;null!==w&&(e=w.outerHeight()-a(p).scrollTop(),0>e&&(e=0));l.css("top",d.scrollTop()+e+"px").css("left",d.scrollLeft()+"px").width(c).height(b);"1"!==a("input[name\x3dfromAnywhere]").val()&&a("#loading-spinner-blocker-doc").css("top",d.scrollTop()+e+"px").css("left",d.scrollLeft()+"px").width(c).height(b)}function m(){var c;c=document.activeElement?a(document.activeElement):a(":focus:first");c.is("button, a, input:enabled")&&c.blur()}function d(){if(v){g();q.when("spp-button-blocker").execute(function(a){a.hideContinueBtnBlocker()});
var b=a(".spp-panel.expanded");if(0<b.length&&b.is(":visible")){e(b,1);return}}if(t)return l.length&&l.find(".loading-spinner-inner").show(),!1;t=!0;m();l=a("#spinner-anchor");l.find(".loading-spinner-inner").show();a("#unblockHeader").length&&(w=a("#header"));h=l.css("z-index");a(p).unbind("scroll.checkout-page-spinner").bind("scroll.checkout-page-spinner",function(a){c&&p.clearTimeout(c);c=setTimeout(function(){f();c=null},50)});a(p).unbind("resize.checkout-page-spinner").bind("resize.checkout-page-spinner",
function(){f();k.adjustSize(l)});a(p).unbind("orientationchange.checkout-page-spinner").bind("orientationchange.checkout-page-spinner",function(){f();k.adjustSize(l)});f();l.show();l.css("z-index",2E3);k.showSpinner(l,!0);return!0}function n(){if(v)b(),"function"===typeof z.hideSpinner&&z.hideSpinner();else{a("#first-pipeline-load-page-spinner").remove();if(!t)return!1;t=!1;l.length&&l.find(".loading-spinner-inner").show();l&&(a(p).unbind(".checkout-page-spinner"),l.hide(),l.css("z-index",h),k.hideSpinner(l));
return!0}}var h,c=null,l,t=!1,w=null,z={},v=!1;return{show:d,showPageTransition:function(){return"0"===a("#showPageTransition").attr("content")?!1:d()},hide:n,hidePageTransition:function(){"0"===a("#showPageTransition").attr("content")&&n();return!0},hideAnimatedSpinnerImage:function(){l.length&&l.find(".loading-spinner-inner").hide()},initFunc:function(a){null!==a&&(z=a,v=!0)},blockAllActions:g,unblockAllActions:b,showTransitionInContainer:e,shrinkPanel:function(a,c,b){"function"===typeof z.shrinkPanel&&
z.shrinkPanel(a,c,b)},clearFocus:m}});"use strict";q.when("A").execute(function(a){a=a.$;var k="",k="mash-transitions"===a("input[name\x3dpageTransitionType]").val()?"page-mash-transition-controller":"page-spinner-controller";q.when(k).register("page-transition-controller",function(a){q.when("A").execute(function(b){b.declarative("page-spinner-show",["click"],{allowLinkDefault:!0},function(b){b=b.$target;b.hasClass("a-button-disabled")||b.closest(".a-button-disabled").length||a.showPageTransition()})});
q.when("A").execute(function(b){b.declarative("page-spinner-show-on-submit",["submit"],{allowLinkDefault:!0},function(b){a.showPageTransition()})});return{show:a.show,hide:a.hide,showPageTransition:a.showPageTransition,hidePageTransition:a.hidePageTransition,blockAllActions:a.blockAllActions,unblockAllActions:a.unblockAllActions,showTransitionInContainer:a.showTransitionInContainer,shrinkPanel:a.shrinkPanel}})});"use strict";q.when("A","page-conductor","client-side-metrics","page-detector-current-page",
"a-popover","ready").execute(function(a,k,g,b){function e(a,b,e){k.isSPP()&&g.setmarker&&g.setmarker("af");g.sendUEPageLoadStats()}var f=a.$,m=!1;a.on("a:popover:afterHide",function(a){a.popover&&(m=!1)});a.on("a:popover:beforeShow",function(a){var b=a.popover;b&&(m=!0,b.$trigger.find(".modal-parameters").each(function(){f.each(f(this).data(),function(a,c){b.attrs(a,c)})}))});a.on("a:popover:dismiss",function(a){a=a.popover;if(g.isTransitionLoggingEnabled()&&a&&m){m=!1;var f,h;"prime-acquisition-spc-popover"===
a.name&&(f="prime-acquisition",h=b.getCurrentPage());f||h||!a.attrs||(f=a.attrs("returnfrom"),h=a.attrs("returnto"));f&&h&&(g.resetMetrics(),g.logPageTransition(f,h,e))}})});"use strict";q.when("A","page-detector-current-page","checkout-general-utils","client-side-metrics").register("first-load-dependencies-base",function(a,k,g,b){function e(){"function"===typeof p.uet&&"function"===typeof p.uex&&(p.uet("cf","first-load-dependencies-ready",{wb:1}),p.uex("ld","first-load-dependencies-ready",{wb:1}));
b.startWidgetTiming("first-load-dependencies:checkout:beforeReload");a.trigger("checkout:beforeReload");b.finishWidgetTiming("first-load-dependencies:checkout:beforeReload");b.startWidgetTiming("first-load-dependencies:checkout:reload");a.trigger("checkout:reload");b.finishWidgetTiming("first-load-dependencies:checkout:reload");var d;m&&(d="spp-revieworder"===m?"spc":m);d&&(b.finishWidgetTiming("first-load-dependencies:checkout:reload:"+d),a.trigger("checkout:reload:"+d),b.finishWidgetTiming("first-load-dependencies:checkout:reload:"+
d));b.startWidgetTiming("first-load-dependencies:checkout:afterReload");a.trigger("checkout:afterReload");b.finishWidgetTiming("first-load-dependencies:checkout:afterReload");setTimeout(function(){var a=f("#first-pipeline-load-page-spinner");a.is(":visible")&&(a.remove(),b.increaseCount("checkout:pageload:timeout"),g.logError("The page has taken more than 90 seconds to load, or there was a JS error preventing it from loading, hiding page spinner."))},9E4)}var f=a.$,m=k.getCurrentPage();"function"===
typeof p.uet&&p.uet("bb","first-load-dependencies-ready",{wb:1});return{allDependenciesCheck:function(a){if(a&&a.length){var n=!1,h={};f.each(a,function(a,c){b.startWidgetTiming("checkout:dependency:"+c+":ready");h[c]=1;q.when(c).execute(function(){b.finishWidgetTiming("checkout:dependency:"+c+":ready");delete h[c]})});var c=function(a){a="Page ("+m+") is missing dependencies ["+a.join(", ")+"] after 5 secs.";b.increaseCount("checkout:dependency:missed:regular-page:error");g.logErrorOnLevel(a,"ERROR")},
l=setTimeout(function(){if(!n){var a=[];f.each(h,function(c){b.increaseCount("checkout:dependency:"+c+":missed");a.push(c)});b.increaseCount("checkout:dependency:missed");0<f("#assets-prefetch").length?b.increaseCount("checkout:dependency:missed:assets-prefetch"):(b.increaseCount("checkout:dependency:missed:regular-page"),c(a));e()}},5E3);q.when.apply(q,a).execute(function(){n=!0;p.clearTimeout&&l&&p.clearTimeout(l);e()})}else e()}}});"use strict";q.when("A","page-detector","client-side-metrics").register("gift-utility",
function(a,k,g){var b=a.$,e=/[^\s\u0020-\u007E\u00A0-\u00FF]/g,f=p.P&&p.P.AUI_BUILD_DATE,m=/((?:file|https?|ftps?|sip):\/\/)/im,d=/((?:\b|[\s!@#$%^&*()_=+[\]{}\|;:'",.<>\?])www\.(?:(?:[^\s!@#$%^&*()_=+[\]{}\|;:'",.<>\?]+\.[^\s!@#$%^&*()_=+[\]{}\|;:'",.<>\?]+))+)(?:[\s!@#$%^&*()_=+[\]{}\|;:'",<>\?]|$|\b)/im,n=/([^\s!@#$%^&*()_=+[\]{}\|;:'",.<>\?\/]+\.(?:[a-z][a-z]|aero|arpa|asia|biz|cat|com|coop|edu|gov|info|int|jobs|mil|mobi|museum|name|net|org|om|pro|qa|tel|travel|xxx)(?:\b|$))/im,h=/^\S+\@\S+\.\S+$/im;
return{getInput:function(a){return a.is("input")?a:a.find("input")},getCharCount:function(a,b){return b?p.unescape(encodeURIComponent(a)).length:a.length},getLineCount:function(a,b){var d=a.split("\n").length;b=Math.floor(b);a=a.split("\n");for(var e=0;e<a.length;e++)a[e].length>b&&(d+=Math.floor(a[e].length/b),0===a[e].length%b&&d--);return d},getNameWithNoTitle:function(a){var b=!1;a=a.split(" ");/^(?:Dr|Mr|Mrs|Ms|Mme|Lt|Attn|Attn:|Prof|Pt|The)\.?$/i.test(a[0])&&(b=!0);b&&a.shift();return a.join(" ")},
getFirstName:function(a){var b=!1;a=a.split(" ");/^(?:Dr|Mr|Mrs|Ms|Mme|Lt|Attn|Attn:|Prof|Pt|The)\.?$/i.test(a[0])&&(b=!0);b&&a.shift();return a.shift()},toggleGiftMessageWarning:function(a,d){var h=d.find(".gift-message-warning");if(e.test(a.val())){var n=d.find(".gift-message-preview-trigger"),m=a.val().replace(e,"?");f?q.when("a-popover").execute(function(a){var c=a.get(n);c?c.update({content:m}):a.create(n,{inlineContent:m,position:"triggerVertical",closeButton:"false"})}):(g.increaseCount("removeauijs13"),
n.unbind("click.preview").bind("click.preview",function(a){q.when("a-popover-base").execute(function(c){var d=b(a.target);d.data("popoverid")&&(c=c.get(d.data("popoverid")))&&(c.update(m),c.updatePosition())})}));a.addClass("a-form-error");h.show()}else a.removeClass("a-form-error"),h.hide()},valueContainsUrl:function(a){return m.test(a)||d.test(a)||n.test(a)},isValidEmail:function(a){return h.test(""+a)}}});"use strict";q.when("A","page-detector","safe-mash","client-side-metrics").register("help-popup",
function(a,k,g,b){function e(){if(f("div#help-popover").length){f(p).unbind("resize.checkout-help-popover");var a=f("#help-popover-frame")[0];f(a.contentWindow?a.contentWindow:a.contentDocument.defaultView).undelegate("a","click");f("div#help-popover").remove()}}var f=a.$;k=k.isMobile();b=f("input#isPipelinedPage");b=0<b.length&&"1"===b.val();var m=k&&b&&g&&g.navigate;a.declarative("help-popup",["click"],function(a){if(!f(".a-touch").length||m){a.$event.preventDefault();a.data&&"1"===a.data.stopPropagation&&
a.$event.stopPropagation();var b=a.$target.closest("a").attr("href");a=a.data;m?g.navigate({url:b,transitionEffect:"slide"}):(a.width||(a.width="340"),a.height||(a.height="340"),p.open(b,"AmazonHelp","width\x3d"+a.width+",height\x3d"+a.height+",left\x3d10,top\x3d10,resizable\x3dyes,scrollbars\x3dyes,menubar\x3dno,toolbar\x3dyes,location\x3dno,directories\x3dno,status\x3dyes"))}else p.open(a.$target.closest("a").attr("href"),"AmazonHelp")});if(m)a.on("checkout:reload",e)});"use strict";q.when("jQuery",
"page-conductor").register("quantity-service",function(a,k){function g(b,e){e=e||{};var f;e.additionalData&&(f=e.additionalData);var g="/gp/buy/pipeline/handlers/update-quantity.html",d={returnFullHTML:1,cachebuster:(new Date).getTime(),isClientTimeBased:0,hasWorkingJavascript:1};f&&f.deletePrimeMembership&&f.primeMembershipASIN&&(d.deletePrimeMembershipItemIn=f.deletePrimeMembership,d.deletedPrimeMembershipASINIn=f.primeMembershipASIN);e.ref&&(g+="/ref\x3d"+e.ref,delete e.ref);f=e.success;delete e.success;
var n=k.ajaxRedirect;e.error&&(n=e.error,delete e.error);a.extend(d,e);e=[];for(var h in b)b[h]!==C&&(e.push(h),d[h]=b[h]);d.entityids=e;b=k.setAjaxTransitionHeader({"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"});a.ajax({type:"POST",url:g,data:a.param(d,!0),dataType:"text",async:!0,cache:!1,headers:b,success:f,error:n})}return{callBatch:function(a,e){g(a,e)},call:function(a,e,f){var m={};m[a]=e;g(m,f)}}});"use strict";q.when("jQuery").register("scroll-controller",function(a){return{scrollToTop:function(){a(p).scrollTop(0)},
toggleScrollOn:function(){a(document).unbind("touchmove")},toggleScrollOff:function(){a(document).bind("touchmove",function(a){a.preventDefault()})}}});"use strict";q.when("A","checkout-general-utils","ready").execute(function(a,k){a.$("#checkout-mash-will-load").length?q.when("mash").execute(function(a){var b;"object"===typeof a?b=a:p.amazon&&p.amazon.mash&&(b=p.amazon.mash);"object"!==typeof b?k.logError("MASH is expected but can't be found"):q.register("safe-mash",function(){return b})}):q.register("safe-mash",
function(){})});"use strict";q.when("A","scheduled-delivery-external-interface","shipping-speed-selection-controller","page-detector","ready").register("scheduled-delivery-controller",function(a,k,g,b){var e=a.$,f={};g=function(){f={};e("div.fake-label input[type\x3d'radio']:checked").each(function(){var a=e(this),b=a.closest("div.fake-label");(b=k.getSdWidgetRootId(b))&&(f[a.attr("name")]=b)})};a.on("checkout:reload:shipoptionselect",g);a.on("checkout:reload:spp-revieworder",g);b.isSosp()&&g();e(document).delegate("div.fake-label",
"click",function(){if(b.isSosp()){var g=e(this),d=g.find("input[type\x3d'radio']");d.attr("disabled")||(d=d.attr("name"),g=k.getSdWidgetRootId(g),a.trigger("scheduled-delivery:ship-option-changed",{current:g,previous:f[d]}),f[d]=g)}});e(document).delegate(".ship-option.is-scheduled-delivery","click",function(){if(b.isSpc()){var f=e(this);f.find("input[type\x3d'radio']").attr("disabled")||(f=k.getSdWidgetRootId(f))&&a.trigger("scheduled-delivery:ship-option-changed",{current:f,previous:null})}});a.on("scheduled-delivery:unblock-continue",
function(){q.when("button-blocker").execute(function(a){a.hide("scheduled-delivery")})});a.on("scheduled-delivery:block-continue",function(a){q.when("button-blocker").execute(function(b){b.show("scheduled-delivery",a)})});a.on("scheduled-delivery:disable-ship-option",function(a,d){var f;a=e("#"+a);if(0!==a.length){if(b.isSpc())a=a.closest(".shipping-speed");else if(b.isSosp())a=a.closest("div.fake-label.a-box");else return;f=a.find("input[type\x3d'radio']");f.attr("disabled",!0);f.is(":checked")&&
d&&(d=e("input[name\x3d"+f.attr("name")+"]:radio:not(:disabled):first"),d.prop("checked",!0),d.trigger("change"));a.addClass("sd-disabled")}});a.on("scheduled-delivery:enable-ship-option",function(a){var d;a=e("#"+a);if(0!==a.length){if(b.isSpc())a=a.closest(".shipping-speed");else if(b.isSosp())a=a.closest("div.fake-label.a-box");else return;d=a.find("input[type\x3d'radio']");d.removeAttr("disabled");a.removeClass("sd-disabled")}})});"use strict";q.when("A","ready").register("mobile-nav-bar-back-controller",
function(a){a.capabilities.history&&(a=a.$,a=a("#mobile-top-bar-navigation-back"),1<=a.length&&a.click(function(a){a.preventDefault();p.history.back()}))});"use strict";q.when("A","page-spinner-controller","page-detector","page-conductor","weblab-helper","ready").execute(function(a,k,g,b,e){function f(a,c){var b=[];a.addressId||b.push("addressId");a.slotKey||b.push("slotKey");a.shippingOfferingId||b.push("shippingOfferingId");a.conflictItems&&!l.isArray(a.conflictItems)&&b.push("conflictItems");if(0<
b.length){a="Error calling fresh widget callback on "+c+": Bad or Missing Input: "+b[0];for(c=1;c<b.length;c++)a+=", "+b[c];console.error(a);return 0}return 1}function m(){l("#freshSlotKey").val("");l("#freshAddressId").val("");l("#freshReservationToCancel").val("");l("#freshConflictingItems").val("");l("#freshShipOfferingId").val("")}function d(a){var c="",b=e.sospPartialAvailabilityWeblabOn();if(a&&l.isArray(a)&&0<a.length)for(var c=a[0].asin+":"+a[0].merchantId+(b?"|"+a[0].maxQtyAvailable:""),
d=1;d<a.length;d++)c+="-"+a[d].asin+":"+a[d].merchantId+(b?"|"+a[d].maxQtyAvailable:"");return c}function n(a){var c;c="page\x3dspc\x26returnFullHTML\x3d1\x26callSetters\x3d1\x26freshSlotKey\x3d"+a.addressId;c+="\x26freshAddressId\x3d"+a.slotKey;a.reservationToCancel&&(c+="\x26freshReservationToCancel\x3d"+a.reservationToCancel);(a=d(a.conflictItems))&&(c+="\x26freshConflictingItems\x3d"+a);a=b.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});k.show();l.ajax({type:"POST",url:"/gp/buy/shared/handlers/handle-fresh-widget-results.html/ref\x3dset-fresh-information",
data:c,dataType:"text",async:!0,cache:!1,headers:a,success:function(a,c,d){return d.getResponseHeader("x-amz-checkout-page")?b.ajaxUpdatePage(a,c,d):b.redirect(a)},error:function(a,c,d){b.ajaxRedirect(a,c,d)}})}function h(){l(".sosp-continue-button").removeClass("js-hide").removeClass("aok-hidden");l(".continue-button-blocker").addClass("aok-hidden")}function c(){l(".sosp-continue-button").addClass("aok-hidden");l(".continue-button-blocker").removeClass("aok-hidden")}var l=a.$;a.on("handle-fresh-results",
function(a){if(l("#isfresh").val())if(a)if(g.isSosp())if(f(a,"sosp")){l("#freshSlotKey").val(a.slotKey);l("#freshAddressId").val(a.addressId);l("#freshReservationToCancel").val(a.reservationToCancel);var e=d(a.conflictItems);l("#freshConflictingItems").val(e);l("#freshShipOfferingId").val(a.shippingOfferingId);e&&0<e.length?l("input#block-prefetch").val(1):l("input#block-prefetch").val(0);e=l("#shippingOptionFormId");a.conflictItems&&0<a.conflictItems.length||b.makePrefetch(e);h()}else m(),c();else g.isSpc()?
f(a,"spc")&&n(a):console.error("remote fresh widget JS callback called on unsupported page.");else console.error("remote fresh widget JS callback called with empty data.");else console.error("remote fresh widget JS callback called without isfresh flag on page")});a.on("block-continue",function(a){l("#isfresh").val()?a?"undefined"===typeof a.blockContinue?console.error("block continue callback - missing blockContinue"):g.isSosp()?1===a.blockContinue?(c(),m()):0===a.blockContinue?h():console.error("block continue callback - invalid value"):
console.error("block continue callback called on unsupported page."):console.error("block continue callback called with no argument"):console.error("block continue callback called without isfresh flag on page")});a.on("confirm-and-continue",function(){l("div.sosp-fresh #shippingOptionFormId").submit()});a.on("redirect-to-spc",function(){b.redirect({conductoraction:{url:'/gp/buy/spc/handlers/display.html/ref\x3d"cancel-fresh-address-select"',type:"redirect"}})})});"use strict";q.when("A","ready").execute(function(a){function k(){(0<
g(".change-preference-block").length||0<g(".mobile-change-preference-block").length)&&!1===b&&(q.register("loadVasRcxCheckoutAsset",function(){}),b=!0)}var g=a.$,b=!1;k();a.on("checkout:reload:spc",k);a.on("checkout:reload:shipoptionselect",k);a.on("checkout:reload:spp-revieworder",k)});"use strict";q.register("time-left-formatter",function(){function a(a,b,e,f,k){return 0>=b?a:a+b+" "+(1===b?k.HOUR:k.HOURS)+(!f&&0<e?" "+k.AND+" ":"")}function k(a,b,e,f,k){return 0>=b?a:a+b+" "+(1===b?k.MINUTE:k.MINUTES)+
(!f&&1>e?" "+k.AND+" ":"")+(1===f&&1>e?" ":"")}return{getTimeLeftFormatted:function(g,b,e){var f="",m=86400<g?(g-g%86400)/86400:0,d=3600<g?(g-g%3600)/3600:0;g-=3600*d;var n=60<g?(g-g%60)/60:0;g-=60*n;if(b&&0<m)return f+m+" "+(1===m?e.DAY:e.DAYS);if(b&&0<d)return a(f,d,n,b,e);if(b&&5<=n)return k(f,n,d,b,e);f=a(f,d,n,b,e);f=k(f,n,d,b,e);1<=d||(f=f+g+" "+(1===g?e.SECOND:e.SECONDS));return f}}});"use strict";q.register("email-validation",function(){function a(a){if(1!==a.length)throw Error("Invalid length for character");
return a}var k={isISOControl:function(g){"string"===typeof g&&(a(g),g=g.charCodeAt(0));return 31>=g||127===g},isWhitespace:function(g){g=a(g);return null!==g.match(/\s/g)},isLetterOrDigit:function(g){g=a(g);return null!==g.match(/[A-Za-z0-9]/g)}};return function(a){var b;if(!a||64<a.length)return!1;for(b=0;b<a.length;b++)if(127<a.charCodeAt(b))return!1;b=a.indexOf("@");if(b!==a.lastIndexOf("@")||1>b||b===a.length-1)return!1;var e=a.substring(0,b),f=a.substring(b+1);if("."===f.charAt(0)||"."===f.charAt(f.length-
1)||f.match(/[a-zA-Z\d\-.]+/)[0]!==f)return!1;for(b=0;b<f.length;b++)if(a=f.charAt(b),b<f.length-1&&"."===a&&"."===f.charAt(b+1))return!1;if(-1===f.indexOf("."))return!1;var m=f=!1;for(b=0;b<e.length;b++)if(a=e.charAt(b),f){switch(a){case "\\":m=!m;break;case '"':m||(f=!1);break;default:if(m&&!k.isLetterOrDigit(a))return!1;m=!1;if(k.isISOControl(a))return!1}if(!f&&('"'===e.charAt(b-1)||e.length-1!==b&&"."!==e.charAt(b+1)))return!1}else switch(a){case '"':if(0!==b&&"."!==e.charAt(b-1))return!1;f=!0;
break;case ".":if(0===b)return!1;break;case "(":case ")":case "\x3c":case "\x3e":case "[":case "]":case "\\":case ":":case ";":case ",":return!1;default:if(k.isISOControl(a)||k.isWhitespace(a))return!1}return!0}});"use strict";q.when("A","page-transition-controller","checkout-general-utils","page-detector","page-detector-current-page","safe-mash","loading-spinner-controller","weblab-helper").register("shipoptionselect-controller",function(a,k,g,b,e,f,m,d){function n(a){var c=v(".delivery-window-groups .more-window");
m.showSpinner(c,!1);a=a.$currentTarget.closest(".delivery-window-groups").data("orderid");c=v("input[name\x3dlineItemEntityIds_"+a+"]").attr("value");v.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/long-calendar-content.html",data:"lineitemids\x3d"+c+"\x26orderid\x3d"+a+"\x26isMobile\x3d1\x26fromPage\x3dsosp",dataType:"json",async:!0,cache:!1,headers:{"x-amz-checkout-page":"sosp"},success:function(a){m.hideSpinner();if(a&&a.deliveryWindowGroups){var c=v(".delivery-window-groups .a-box-group");
c.empty();v.each(a.deliveryWindowGroups,function(a,b){c.append(b)});a=v(".delivery-window-groups .selected-group");a.length&&a.trigger("click")}}})}function h(a,c){var b=v("div.one-shipment:visible");a=x?v("div.one-shipment").slice(parseInt(a,10),parseInt(c,10)+1):v("div.one-shipment#"+a);r&&0!==a.size()&&b.last().attr("id")!==a.last().attr("id")&&(b.hide(),a.show(),v(p).scrollTop(0))}function c(){if(r){var a=(location.hash?location.hash.replace("#",""):"0-"+K).split("-");2===a.length&&h(a[0],a[1])}}
function l(){function n(a,c){v.ajax({type:"POST",url:"/gp/buy/gift/handlers/remove-gift-option.html",data:c,dataType:"json",async:!0,cache:!1,headers:{"x-amz-checkout-page":"sosp"},success:a,error:function(a,c,b){k.hide()}})}function l(a){var c=a.closest("div."+m);a.is(":checked")?(c.siblings("div."+m+".selected").removeClass("selected").find(".a-icon-touch-radio-active").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive"),c.addClass("selected").find(".a-icon-touch-radio-inactive").removeClass("a-icon-touch-radio-inactive").addClass("a-icon-touch-radio-active")):
c.removeClass("selected").find(".a-icon-touch-radio-active").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive");w("triggerChangeEvent",[a])}0<v(".prime-calendar-container").length&&v(".prime-calendar-container").contents().each(function(a,c){8===c.nodeType&&v(c).replaceWith(c.nodeValue)});var g=v(".delivery-window-groups .selected-group");g.length&&g.trigger("click");A=v(".sosp-continue-button");r="1"===v("#isClientSidePagingEnabled").val()?1:0;K=d.isDigitalAsinIndexingFixedOnSOSPEnabled()?
(v("div.shipment-with-ship-options:visible").length-1).toString():(v("div.one-shipment:visible").length-1).toString();u="1"===v("#useMashNavigateForClientSidePaging").val()?1:0;x="1"===v("#collapseDigitalShipmentsEnabled").val()?1:0;var m=(g=p.P&&p.P.AUI_BUILD_DATE)?"selectable-box":"fake-label";r&&(v(".one-shipment:gt("+K+")").hide(),c());A.bind("click",function(c){function n(a,c){var b=e.getCurrentPage();if(p.history&&p.history.pushState){var d=location.href;0<d.indexOf("#")&&(d=d.substring(0,d.indexOf("#")));
d+="#"+a.attr("id")+"-"+c.attr("id");history.pushState({page:b,id:a.attr("id")},v("title"),d)}}var l=!1;v("div.one-shipment:visible input[type\x3d'radio'][checked]").each(function(){if(v(this).data("blockingOn"))return alert(v(this).data("blockingOn")),c.preventDefault(),l=!0,!1});if(l)return!1;if(d.removesGiftOptionOnRush()&&b.isMobile()&&null!=L){var r=v("div.one-shipment:visible"),g=r.find("input[type\x3d'radio']:checked").closest(".shipping-option");if("1"===r.find("input[type\x3dhidden][name\x3disGiftWrapped]").attr("value")&&
1===g.data("nosupportforgiftoption"))return L.show(),!1}t();r=v("div.one-shipment:visible");g=r.nextAll("div.one-shipment:hidden");if(0<g.length){c.preventDefault();var k=g.first(),m=k;x&&(m=g.filter(".shipment-with-ship-options"),m=1<m.length?m.eq(1).prev():g.last());u&&f&&f.navigate?f.navigate({url:null,transitionEffect:"slide",successCallback:function(){n(k,m)},failCallback:function(a){}}):n(k,m);h(k.attr("id"),m.attr("id"));a.trigger("active-shipment-changed")}z("logInlineCalMetrics",[r])});v(".gift-option-removal-cancel-button").bind("click",
function(a){L.hide()});v(".gift-option-removal-confirm-button").bind("click",function(a){k.show();L.hide();a="lineItemsToRemoveGiftOptionFrom\x3d"+v("div.one-shipment:visible").find("input[name^\x3dlineItemEntityIds_]").attr("value");var c=v("div.one-shipment:visible"),b=c.nextAll("div.one-shipment:hidden");n(function(a,d,e){c.find("input[type\x3dhidden][name\x3disGiftWrapped]").each(function(){v(this).remove()});0<b.length?(A.click(),k.hide()):v(".checkout-page-form").submit()},a)});v(p).bind("popstate",
function(a){b.isSosp()&&c()});v(document).delegate("div."+m,"click",function(a){a=v(this);a.find("input[type\x3d'radio']").trigger("change",["setActive"]);a.parent().hasClass("timeslot-picker")&&(a=a.find(".a-button-selected").length,A&&A.length&&(a?A.removeClass("a-button-disabled").addClass("a-button-primary").find("input").prop("disabled",!1):A.removeClass("a-button-primary").addClass("a-button-disabled").find("input").prop("disabled",!0)))});var q;a.declarative("faster-than-same-day-sosp-save",
["click","submit"],function(){var c="lineItemsToRemoveGiftOptionFrom\x3d"+q.closest(".one-shipment").find("input[name^\x3dlineItemEntityIds_]").attr("value");a.$("div.a-popover button.a-button-close").trigger("click");k.show();n(function(a,c,b){q.closest(".one-shipment").find(".isGiftWrapped").each(function(){v(this).remove()});q.attr("checked",!0);l(q);k.hide()},c)});v(document).delegate("div."+m+" input[type\x3d'radio']","change",function(a,c){a=v(this);if("setActive"===c&&!a.attr("disabled")&&
d.removesGiftOptionOnRush()&&0<a.closest(".one-shipment").find(".isGiftWrapped").length&&1==a.data("nosupportforgiftoption"))q=a,a.is(":checked")&&(c=a.closest("div."+m).siblings("div."+m+".selected").find('input[type\x3d"radio"]'),q.attr("checked",!1),c.attr("checked",!0)),setTimeout(function(){v("#faster-than-same-day-sosp-popover").trigger("click")},10);else{if("setActive"===c){if(a.attr("disabled"))return;a.attr("checked",!0)}if("disabling"===c)if(a.attr("disabled",!0),a.is(":checked"))a.removeAttr("checked");
else return;l(a)}});v("div."+m+" input[type\x3d'radio']:checked").change();v("h3").children().removeAttr("style");0===v("div."+m+".scheduled-delivery").length&&v("form.checkout-page-form").data("checkoutFormReady",!0).change();g&&v(document).delegate(".a-touch-radio a","click",function(a){if(!d.isSOSPExclusiveJSHandlerWeblabOn()||b.isSosp())if(d.isSOSPLinkPatchEnabled()){var c=v(a.target).attr("href");!c||c.startsWith("#")||c.toLowerCase().startsWith("javascript:")||(f&&f.navigate?f.navigate({url:c,
transition:"slide"}):a.preventDefault=!1)}else f&&f.navigate?f.navigate({url:v(a.target).attr("href"),transition:"slide"}):a.preventDefault=!1})}function t(){if(1===v("div.store-upsell-ship-options").length){var a="/gp/buy/shared/handlers/store-upsell-async.html",c="ox_store_upsell_continue_",b=v("div.ship-speed, div.store-upsell-ship-options").find("input.shipping-option, input.store-upsell-ship-option"),d=[],e;v.each(b,function(a,b){a=v(b);b=a.attr("value");d.push(b.toLowerCase());a.is(":checked")&&
(e=a.attr("value"),c=a.hasClass("store-upsell-ship-option")?c+"success":c+"failure")});a=g.addQueryStringParameter(a,"ref",c);v.ajax({url:a,type:"POST",async:!0,data:{shown:d.toString(),clicked:e}})}}function w(a,c){q.when("checkout-federation-wrapper","shipspeed-provider").execute(function(b,d){b.wrap(function(){d&&!v.isEmptyObject(d)&&"function"===typeof d[a]&&d[a].apply(this,c)},"VasCheckoutShipSpeedProvider")})}function z(a,c){q.when("checkout-federation-wrapper","sd-methods").execute(function(b,
d){b.wrap(function(){d&&!v.isEmptyObject(d)&&"function"===typeof d[a]&&d[a].apply(this,c)},"CricketInlineCalendarHeavyBulkyIN")})}var v=a.$,A,r,u,K,x=0,L;a.declarative("sosp-change-quantity-link",["click"],function(a){var c=a.$currentTarget,b=v("\x3cinput type\x3d'hidden' /\x3e").attr("name","change-quantities-or-delete").val("1");c.hasClass("pipeline-link")?(a.$event.preventDefault(),c.closest("form").removeClass("checkout-page-form").append(b).find(".sosp-continue-button:first").trigger("click")):
c.closest("form").removeClass("checkout-page-form").append(b).find(".sosp-continue-button:first").trigger("click").end().trigger("submit")});q.when("A","a-sheet").register("shipoptionselect-gift-removal-controller-mobile",function(a,c){L=c.create({name:"gift-removal-popover",height:220,preloadDomId:"gift-option-removal-message",closeType:"icon",sheetType:"web"})});a.declarative("sosp-extender-toggle",["click","touchend"],function(a){if(!g.protectAgainstDoubleAction("sosp-extender-toggle")){var c=
a.$target.closest("a"),b=v(".delivery-window-groups .a-box-group").find(".lazy-loaded");if(c.hasClass("aui-extender"))b.length?b.remove():n(a);else{var d=c.find("i"),c=c.closest("div.extender-section");d.hasClass("a-icon-extender-expand")?(c.find(".collapsed").hide(),c.find(".expanded").slideDown("fast"),d.removeClass("a-icon-extender-expand").addClass("a-icon-extender-collapse"),n(a)):(c.find(".collapsed").show(),c.find(".expanded").slideUp("fast"),d.removeClass("a-icon-extender-collapse").addClass("a-icon-extender-expand"),
b.length&&b.remove())}}});a.declarative("sosp-select-prime-slot",["click","touchend"],function(a){if(!g.protectAgainstDoubleAction("sosp-select-prime-slot")){a=a.$currentTarget;var c=a.closest(".valid-slot");if(c.closest(".prime-calendar").hasClass("long-calendar")){var b=c.closest(".prime-calendar").data("orderid"),d=v("#calendar-"+b),b=v("#calendar-delivery-message-"+b),e=a.closest(".long-calendar");e.find(".selected-slot").removeClass("selected-slot");0<c.length&&c.addClass("selected-slot");v(".a-button-close").trigger("click");
c=a.data("slotid");c=d.find(".slot-"+c);if(0<c.length)d.show(),b.parent().hide(),c.closest(".prime-calendar").find(".selected-slot").removeClass("selected-slot"),c.closest(".valid-slot").addClass("selected-slot");else{var f=a.parent()[0],h=a.parent().parent().find(".rhead")[0],c=h.innerText;c||(c=h.textContent);f=f.cellIndex;e=e.find("th")[f];f=e.innerText;f||(f=e.textContent);b.text(f+" "+c);d.hide();b.parent().show()}}else b=c.closest(".prime-calendar-container").data("orderid"),d=v("#calendar-"+
b).find(".selected-slot"),0<d.length&&(d.removeClass("selected-slot"),0<c.length&&c.addClass("selected-slot"));d=a.closest(".prime-calendar-container").data("orderid");a.data("key")&&v("#order_"+d+"_ShippingSpeed").val(a.data("key"));a.data("isscheduleddeliveryslot")&&v("#sdData"+d).val(a.data("sddatastring"))}});a.declarative("sosp-select-delivery-window",["click","touchend"],function(a){if(!g.protectAgainstDoubleAction("sosp-select-delivery-window")){a=a.$currentTarget;a.length&&!a.hasClass("dwg-button")&&
(a=a.find(".dwg-button"));v(".dwg-button").removeClass("selected-dwg-button");a.addClass("selected-dwg-button");var c=a.closest(".delivery-window-groups").data("orderid"),b=a.data("key");!b&&a.find("button").length&&(b=a.find("button").data("key"));b&&v("#order_"+c+"_ShippingSpeed").val(b);b=a.data("isscheduleddeliveryslot");!b&&a.find("button").length&&(b=a.find("button").data("isscheduleddeliveryslot"));b&&(b=a.data("sddatastring"),!b&&a.find("button").length&&(b=a.find("button").data("sddatastring")),
v("#sdData"+c).val(b))}});a.on("checkout:reload:shipoptionselect",l);a.on("checkout:reload:spp-shipoption",l)});q.when("jQuery","page-detector").register("deliv-prefs-sosp",function(a,k){function g(){a(".sosp .order-delivery-time-preference").each(function(){var b=a(this);b.bind("selectionChanged",function(){0===b.find(".delivery-time-preference-group").length?b.hide():(b.show(),0===b.find("input:checked").length&&b.find("input:first").trigger("change",["setActive"]))}).bind("empty",function(){b.find(".delivery-time-preference-group").detach()});
var e=b.closest(".one-shipment").find("input.shipping-option");b.find(".delivery-time-preference-group").each(function(){var e=a(this),g=e.data("shippingoptionid"),g=a("#"+g);e.is(".template")&&e.detach().removeClass("template");g.change(function(){b.trigger("empty");e.appendTo(b);b.trigger("selectionChanged")}).addClass("hasDeliveryTimePreference")});e.not(".hasDeliveryTimePreference").change(function(e,g){"disabling"===g||a(this).is(":disabled")||(b.trigger("empty"),b.trigger("selectionChanged"))});
b.trigger("selectionChanged")})}q.when("A").execute(function(a){a.on("checkout:reload:shipoptionselect",g)})});q.when("A","shipoptionselect-controller").execute(function(a){var k=a.$,g={},b={};a.on("checkout:reload:shipoptionselect",function(){var a=k("#shippingOptionFormId"),f=a.find("input[name\x3dtrialKey]");if(1===f.length){for(var m in g)g.hasOwnProperty(m)&&(g[m].abort(),delete g[m]);g={};b={};var d=function(a){return a.join("::").replace(/\s+/g,"_")},n=function(){return k.map(a.find("input[type\x3dradio]:checked"),
function(a){return a.name})},h=function(){return k.map(a.find("input[type\x3dradio]:checked"),function(a){return a.value})},c=function(a,c){if(g.hasOwnProperty(a)||b.hasOwnProperty(a))return!1;console.debug('initiating ajax call for trial key "'+a+'"');c=k.ajax({type:"POST",url:"/gp/buy/shipoptionselect/handlers/launch-delivery-trial.html",contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",headers:{"x-amz-checkout-transition":"ajax"},data:c,dataType:"json",async:!0,success:function(c){c?
console.debug('trial "'+a+'" success'):console.debug('trial "'+a+'" failed');b[a]=c;delete g[a]},error:function(c,b,d){delete g[a];"abort"!==d&&(console.debug("trial "+a+" error"),q.error("issue with set-delivery-options trial: "+b,d))},cache:!1});g[a]=c;return!0},l=function(){for(var a=h(),a=d(a),c=Object.keys(g),b=0;b<c.length;++b){var e=c[b];e!==a&&(console.debug('removing ajax call for trial key "'+e+'"'),g[e].abort(),delete g[e])}};k(document).delegate("#shippingOptionFormId","change",function(b){b=
h();if(d(b)!==f.val())a:{l(),b=n();var g=h(),m=d(g);f.val(m);var v=c(m,a.serialize()),m=0;v&&++m;for(var A=0;A<b.length;++A)for(var r=a.find('input[type\x3dradio][name\x3d"'+b[A]+'"][value!\x3d"'+g[A]+'"]'),u=0;u<r.length;++u){var K=r[u],v=g.slice(0);v[A]=K.value;for(var v=d(v),x=K.name,K=K.value,L=a.serializeArray(),D=0;D<L.length;++D)L[D].name===x&&(L[D].value=K),"trialKey"===L[D].name&&(L[D].value=v);x=k.param(L);if((v=c(v,x))&&5===++m)break a}}});k(document).delegate("#shippingOptionFormId","submit",
function(a){l()})}})});q.when("A","button-blocker","page-detector").register("scheduled-delivery-readiness-checker",function(a,k,g){function b(){g.isMobile()&&g.isSosp()&&m("div.scheduled-delivery").length&&(m(document).delegate("div."+n+":visible input[type\x3d'radio'].shipping-option","change",function(){f(m(this).closest("div."+n))}),a.on("active-shipment-changed",f))}function e(a){d||(a.hasClass("scheduled-delivery-loading")?d=a.find(".loading-tooltip").text():a.hasClass("scheduled-delivery-picking")&&
(d=a.find(".picking-tooltip").text()))}function f(a){d=null;a?e(a):m("div.one-shipment:visible div."+n+".scheduled-delivery").each(function(){var a=m(this);a.find("input").is(":checked")&&e(a)});d?k.show("scheduled-delivery",d):k.hide("scheduled-delivery")}var m=a.$,d,n=p.P&&p.P.AUI_BUILD_DATE?"selectable-box":"fake-label";if(g.isMobile())a.on("checkout:reload:shipoptionselect",b);return{check:f}});"use strict";q.when("A","quantity-service","page-conductor","page-detector","ajax-utility","page-transition-controller",
"gift-utility","client-side-metrics","weblab-helper").register("gift-form-base-controller",function(a,k,g,b,e,f,m,d,n){function h(a){a.is(":checked")||(ea?a.is(":checked")||a.closest("label").click():(d.increaseCount("removeauijs4"),a.attr("checked",!0).trigger("change")))}function c(a){a.attr("disabled","disabled");ea&&a.closest("div").bind("click.disable",function(a){a.stopPropagation()})}function l(a){a.removeAttr("disabled");ea&&a.closest("div").unbind("click.disable")}function t(){q.when("a-dropdown").execute(function(a){var c=
y(".select-recipient");c.empty();for(var b=0;b<R.length;b++){var d=y("\x3coption/\x3e").attr({value:R[b].value}).text(R[b].text);c.append(d)}c.each(function(){var c=y(this).closest(".gift-connection-section"),b=c.find(".include-gift-connection-checkbox").is(":checked"),d=c.find(".item-id").val(),e=c.find(".item-giftlist-type-id").val(),f;!e||"0"!==e&&"1"!==e&&"2"!==e?e&&"3"===e&&(f=c.find(".item-giftlist-id").val()):f=e;!f&&b&&(b=c.find(".item-registry-id").val())&&ha&&ha[b]&&(f=ha[b]);f&&(a.setValue(y(this).attr("id"),
f),(e&&"1"===e||"2"===e)&&c.find(".gift-connection-recipient-extra").removeClass("aok-hidden").show(),x(d))})})}function w(){y(".gift-connection-recipient-section").unbind("click").bind("click",function(){if(!ba)return y(this).find(".select-recipient-spinner").removeClass("aok-hidden").show(),!1});y(".select-recipient").each(function(){y(this).unbind("change").bind("change",function(){var a=y(this),c=a.next().find(".a-dropdown-prompt"),b=y("\x3cdiv/\x3e").html(a.find(":selected").text()).clone().html();
setTimeout(function(){c.html(b)},0)})});q.when("a-dropdown").execute(function(a){y(".gift-connection-section").each(function(){var c=y(this),b=c.find(".item-id").val(),d=c.find(".item-giftlist-type-id").val();c.find(".item-giftlist-id").val();var e=c.find(".item-occasion-id").val(),f=c.find(".item-occasion-month").val(),h=c.find(".item-occasion-day").val(),n=c.find(".item-age").val();c.find("#input-recipient-first-name-"+b).unbind("keyup").keyup(function(){x(b)});c.find("#input-recipient-last-name-"+
b).unbind("keyup").keyup(function(){x(b)});if("1"===d||"2"===d)a.setValue(c.find(".select-recipient").attr("id"),d),c.find(".gift-connection-recipient-extra").removeClass("aok-hidden").show();a.setValue(c.find(".select-occasion").attr("id"),e);a.setValue(c.find(".select-occasion-month").attr("id"),f);a.setValue(c.find(".select-occasion-day").attr("id"),h);a.setValue(c.find(".select-occasion-age").attr("id"),n);if("1"===e||"2"===e)c.find(".gift-connection-occasion-extra").removeClass("aok-hidden").show(),
"2"===d&&c.find(".select-occasion-age-row").removeClass("aok-hidden").show();"1"!==e&&"2"!==e&&"3"!==e&&x(b)})});var a="/gp/buy/pipeline/handlers/list-of-giftlists.html",c=y(".item-registry-id").map(function(){if(y(this).val())return y(this).val()}).get().join();c&&(a+="?fromRegistryIds\x3d"+c);R?(t(),y(".select-recipient-spinner").hide(),ba=!0):(ba=!1,y.ajax({type:"POST",url:a,dataType:"json",async:!0,cache:!1,timeout:5E3,success:function(a){!R&&a.options&&0<a.options.length&&(R=a.options);a.registryIdMapping&&
(ha=a.registryIdMapping);R&&t();y(".select-recipient-spinner").hide();ba=!0},error:function(a,c,b){y(".select-recipient-spinner").hide();ba=!0}}))}function z(){Y=[];a.state("giftNotificationEmailConstraints",[]);a.state("giftDeliveryDateConstraints",[]);y('[data-action\x3d"gift-form-element"]').each(function(){var a=y(this);a.is("span")?a.find("input, textarea, select:first").trigger({type:"change",isInit:!0}):a.trigger({type:"change",isInit:!0})});y("textarea").unbind("keyup.gift-textarea click.gift-textarea").bind("keyup.gift-textarea click.gift-textarea",
function(){y(this).trigger("change")});0<y(".enable-gift-connections").length&&w()}function v(a,c){var b=31;if("1"===c)b=0===a%4&&0!==a%100||0===a%400?29:28;else if("3"===c||"5"===c||"8"===c||"10"===c)b=30;return b}function A(a,c,b){a=e.jsonify(a);g.redirect(a)}function r(a){q.when("a-dropdown").execute(function(c){y(".gift-connection-recipient-extra-"+a).hide();c.setValue("select-recipient-"+a,"0");y("#input-recipient-first-name-"+a).val("");y("#input-recipient-last-name-"+a).val("")})}function u(a){q.when("a-dropdown").execute(function(c){y(".gift-connection-occasion-extra-"+
a).hide();c.setValue("select-occasion-"+a,"0");c.setValue("select-occasion-month-"+a,"0");c.setValue("select-occasion-day-"+a,"0");c.setValue("select-occasion-age-"+a,"-1");y("#occasion-has-reminder-checkbox-"+a).attr("checked",!0)})}function K(a,c){q.when("a-dropdown").execute(function(b){for(var d=0;d<R.length;d++)c&&c===R[d].value&&R[d].bMonth&&R[d].bDay&&(b.setValue("select-occasion-month-"+a,R[d].bMonth),b.setValue("select-occasion-day-"+a,R[d].bDay))})}function x(a){q.when("a-dropdown").execute(function(c){var b=
y("#select-recipient-"+a).find(":selected").val();"0"!==b&&("1"!==b&&"2"!==b||y("#input-recipient-first-name-"+a).val()||y("#input-recipient-last-name-"+a).val())?c.updateSelect("select-occasion-"+a,{status:"enabled"}):(u(a),c.updateSelect("select-occasion-"+a,{status:"disabled"}))})}function L(a,c,b){"1"===c&&"2"===b?y("#select-occasion-age-row-"+a).removeClass("aok-hidden").show():y("#select-occasion-age-row-"+a).hide()}function D(){var a=y("#hidePricesCheckbox"),c=y("#kindle-reg-radio-your-account");
ea?c.is(":checked")?y("#kindle-reg-radio-another-account").closest("label").click():a.is(":checked")||a.closest("label").click():(d.increaseCount("removeauijs6"),a.is(":checked")||a.attr("checked","checked").trigger("change"),c.is(":checked")&&(c.removeAttr("checked").trigger("change"),y("#kindle-reg-radio-another-account").attr("checked","checked").trigger("change")))}function H(){var a=y("#hidePricesCheckbox"),c=y("#kindle-reg-radio-another-account");ea?c.is(":checked")?y("#kindle-reg-radio-your-account").closest("label").click():
a.is(":checked")&&a.closest("label").click():(d.increaseCount("removeauijs7"),a.is(":checked")&&a.removeAttr("checked").trigger("change"),c.is(":checked")&&(c.removeAttr("checked").trigger("change"),y("#kindle-reg-radio-your-account").attr("checked","checked").trigger("change")))}function M(){y("#hidePricesCheckboxLabel").hide();var a=y("#hidePricesCheckbox");ea&&(a.is(":checked")||a.closest("label").click());a.attr("disabled",!0).hide().trigger("change");y("#kindle-reg-radio-another-account").attr("disabled",
!0).trigger("change");y("#kindle-reg-radio-your-account").attr("disabled",!0).trigger("change");y("#hidePricesDisabledMessage").show();y("#hidePricesDisabledMessage").removeClass("aok-hidden");ea&&(y("label.a-touch-checkbox.hide-prices-checkbox").addClass("a-touch-selector-disabled").bind("click.disable",function(a){a.stopPropagation()}),y("label.a-touch-radio.kindle-reg-option").addClass("a-touch-selector-disabled").bind("click.disable",function(a){a.stopPropagation()}))}function P(a){var c=!1;y(".afn-wrap-checkbox").each(function(){var a=
y(this),a=a.is("input")?a:a.find("input");if(a.is(":checked"))return c=!0,!1});y(".mfn-no-wrap-radio").each(function(){var a=y(this),a=a.is("input")?a:a.find("input");if(!a.is(":checked"))return c=!0,!1});if(c)D(),M();else if(y("#hidePricesCheckbox").is(":disabled"))y("#hidePricesCheckboxLabel").show(),y("#hidePricesCheckbox").removeAttr("disabled").show().trigger("change"),y("#kindle-reg-radio-another-account").removeAttr("disabled").trigger("change"),y("#kindle-reg-radio-your-account").removeAttr("disabled").trigger("change"),
y("#hidePricesDisabledMessage").hide(),ea&&(y("label.a-touch-checkbox.hide-prices-checkbox").removeClass("a-touch-selector-disabled").unbind("click.disable"),y("label.a-touch-radio.kindle-reg-option").removeClass("a-touch-selector-disabled").unbind("click.disable"));else if(a.is("input")||(a=a.find("input")),"hidePricesCheckbox"===a.attr("id"))a.is(":checked")?D():H();else if("kindle-reg-radio-another-account"===a.attr("id")||"kindle-reg-radio-your-account"===a.attr("id"))y("#kindle-reg-radio-your-account").is(":checked")?
H():D()}function G(a){var c=y("#giftwrap-carousel-wrap-pane-"+a+" ul li").size();c&&(y("#giftwrap-carousel-wrap-holder-"+a).css("width",90*c),y("#giftwrap-carousel-wrap-pane-"+a).css("width",360));N(a)}function N(a){y("#giftwrap-carousel-wrap-holder-"+a).find("ul li, ol li").each(function(c,b){c=y(b);c.find("input").is(":checked")&&Q(c,{itemId:a})})}function Q(a,c){a.parent().find(".selected-giftwrap-image").removeClass("selected-giftwrap-image");a.find(".giftwrap-carousel-item-image").addClass("selected-giftwrap-image");
a.parent().find(".wrap.a-button-selected").removeClass("a-button-selected");a.addClass("a-button-selected");var b=c.itemId;c=c.wrapNo;var d=g.isSPP();if(!n.isNoshiGiftMessageEnabled())if(a.hasClass("noshi-wrap")&&!a.hasClass("none-wrap")){g.isSPP();var e="#item-"+b;y("#gift-message-noshi-warning-"+b).removeClass("aok-hidden");y("#includeMessageCheckbox-"+b).attr("disabled","disabled");Z()?(y("#afn-message-span-"+b,y(e)).addClass("aok-hidden"),y("#gift-message-"+b).addClass("aok-hidden")):(y("#afn-message-span",
y(e)).removeClass("enable-message-area").addClass("disable-message-area"),y("#message-area-"+b).attr("disabled","disabled"))}else e="#item-"+b,Z()&&(y("#afn-message-span-"+b,y(e)).removeClass("aok-hidden"),y("#gift-message-"+b).removeClass("aok-hidden")),y("#gift-message-noshi-warning-"+b).addClass("aok-hidden"),y("#afn-message-span",y(e)).removeClass("disable-message-area").addClass("enable-message-area"),y("#includeMessageCheckbox-"+b).removeAttr("disabled"),y("#message-area-"+b).removeAttr("disabled");
e=a.find("input[type\x3dradio]");e.attr("checked",!0);d||(d=a.data("giftwrap-id"),e.val(d).change());var d=a.data("wrap-no"),e=y("#giftwrap-option-preview-imagearea-default-"+b),f=y("#giftwrap-option-preview-imagearea-image-"+b),h=y(".selectedWrapLargeLink","#item-"+b),b=y(".wrapNo-"+b+"-"+c);a.hasClass("none-wrap")?(e.removeClass("aok-hidden"),f.addClass("aok-hidden"),h.length&&(h.addClass("aok-hidden"),h.removeClass("selectedWrapLargeLink"))):(a=a.find("img").attr("src"),f.find("img").attr("src",
a),e.addClass("aok-hidden"),f.removeClass("aok-hidden"),h.length&&(h.addClass("aok-hidden"),h.removeClass("selectedWrapLargeLink")),b.length&&(b.addClass("selectedWrapLargeLink"),b.removeClass("aok-hidden")));a=y(".selectedWrapLargeLink");b=y(".larger-image-link-carousel-"+d);a.removeClass("selectedWrapLargeLink").addClass("aok-hidden");b.removeClass("aok-hidden").addClass("selectedWrapLargeLink")}function E(a,c){var b;b=c.itemId;c=y("#giftwrap-option-preview-imagearea-default-"+b);b=y("#giftwrap-option-preview-imagearea-image-"+
b);a.hasClass("none-wrap")?(c.removeClass("aok-hidden"),b.addClass("aok-hidden")):(a=a.find("img").attr("src"),b.find("img").attr("src",a),c.addClass("aok-hidden"),b.removeClass("aok-hidden"))}function F(a,c){var b=c.itemId;c=y("#giftwrap-option-preview-imagearea-default-"+b);b=y("#giftwrap-option-preview-imagearea-image-"+b);if(a.parent().find(".selected-giftwrap-image").parents("li").hasClass("none-wrap"))c.removeClass("aok-hidden"),b.addClass("aok-hidden");else{var d=".selected-giftwrap-image img";
g.isSPP()&&(d="img.selected-giftwrap-image");a=a.parent().find(d).attr("src");b.find("img").attr("src",a);c.addClass("aok-hidden");b.removeClass("aok-hidden")}}function C(a,c){var b=a.find(".empty-message-warning"),d=a.find(".no-receipt-warning"),e=a.find("textarea");a=a.find(".message-counter");c&&!d.is(":visible")?(a.hide(),b.show(),e.addClass("gift-warning")):(b.hide(),e.removeClass("gift-warning"),a.show())}function X(a){var c=y("#"+a.id),b=m.getCharCount(c.val(),a.useByteSize),c=m.getLineCount(c.val(),
a.maxChars/a.maxLines);return{length:b,charDelta:a.maxChars-b,lineDelta:a.maxLines-c}}function aa(a,c){c=y("#item-"+c.itemId);var b=a.is(":checked")&&!a.hasClass("mfn-no-wrap-radio");Z()&&(b=!a.hasClass("mfn-no-wrap-radio"));b?(c.find(".gift-message-pslip").hide(),c.find(".gift-message-card").show()):(c.find(".gift-message-card").hide(),c.find(".gift-message-pslip").show())}function Z(){return g.isSPP()&&y("#carouselGiftWrap").length}function ga(c,b){var d=b.itemId;b=g.isSPP()?b.currentTab:c.data("current-tab");
var e=y("#afn-gift-options-wrapper-"+d).data("active-tab");b!==e&&(c.parent().find(".selected-giftwrap-tab").removeClass("selected-giftwrap-tab"),c.addClass("selected-giftwrap-tab"),y("#afn-gift-options-wrapper-"+d).data("active-tab",b),c="#item-"+d,e=g.isSPP()?y("#giftwrap-carousel-wrap-holder-"+d,c):c,e.length&&a.trigger("checkout:gift:changeCarouselWrapOptions",e,b,d),b=y(".none-wrap",y(c)).find("input"),b.prop("checked",!0),b.val("").change(),g.isSPP()?(b=y("#afn-gift-options-wrapper-"+d),b.length&&
(b=b.data("active-tab"),a.trigger("checkout:gift:adaptCarouselGiftPanel",d,b))):a.trigger("checkout:gift:adaptCarousel",d),y("#giftwrap-carousel-wrap-holder-"+d).removeClass("a-button-selected").find(".selected-giftwrap-image").removeClass("selected-giftwrap-image"),y("#giftwrap-carousel-item-image-"+d).addClass("selected-giftwrap-image").parents(".wrap").addClass("a-button-selected"),y("#giftwrap-option-preview-imagearea-default-"+d).removeClass("aok-hidden"),y("#giftwrap-option-preview-imagearea-image-"+
d).addClass("aok-hidden"),b=y(".selectedWrapLargeLink"),b.length&&(b.addClass("aok-hidden"),b.removeClass("selectedWrapLargeLink")),b=g.isSPP(),c="#item-"+d,y("#gift-message-noshi-warning-"+d).addClass("aok-hidden"),y("#includeMessageCheckbox-"+d).removeAttr("disabled"),b?y("#afn-message-span-"+d,y(c)).removeClass("aok-hidden"):(y("#afn-message-span",y(c)).removeClass("disable-message-area").addClass("enable-message-area"),y("#gift-message-heading-"+d).removeClass("disable-message-area").addClass("enable-message-area"),
y("#message-area-"+d).removeAttr("disabled")))}var Y,R,ba=!1,ha,y=a.$,ea=p.P&&p.P.AUI_BUILD_DATE&&b.isMobile(),da=m.getInput;a.declarative("save-gift-for-later",["click"],function(a){f.show();a=a.$currentTarget.data("entityId")||a.data.entityId;k.call(a,0,{success:A})});var na={toggleGiftDataAndDeliveryOptions:function(a){a=a.closest(".gift-options-wrapper");var c=da(a.find(".includeMessageCheckbox"));c&&c.is(":checked")?(a.find(".gift-delivery-option").show(),a.find(".item-wrap-span").show(),a.find(".item-wrap-row").show(),
a.find(".item-gift-message-span").show()):(a.find(".gift-delivery-option").hide(),a.find(".item-wrap-span").hide(),a.find(".item-wrap-row").hide(),a.find(".item-gift-message-span").hide())},toggleGiftDeliveryOptions:function(a){var c=a.closest(".gift-options-wrapper");a.is("input[type\x3dcheckbox]")?a.is(":checked")?c.find(".gift-notification-email").removeClass("a-form-disabled"):c.find(".gift-notification-email").addClass("a-form-disabled"):(c.find(".gift-notification-email").removeClass("a-form-disabled"),
a=c.find(".includeMessageCheckbox"),h(a.find("input[type\x3dcheckbox]")),ea&&(a=a.find("i.a-icon"),a.length&&(a.removeClass("a-icon-checkbox-inactive"),a.removeClass("a-icon-touch-checkbox-inactive"),a.addClass("a-icon-checkbox-active"),a.addClass("a-icon-touch-checkbox-active"))))},initGiftNotificationEmail:function(c){var b=a.state("giftNotificationEmailConstraints");b.push({id:c.attr("id")});a.state("giftNotificationEmailConstraints",b)},initGiftDeliveryDate:function(c){var b=a.state("giftDeliveryDateConstraints");
c.hasClass("year-select")||(c=c.parents("div.del-opt-date-section").find("select.year-select:first"));b.push({id:c.attr("id")});a.state("giftDeliveryDateConstraints",b)},updateDateDropdown:function(a){var c=a.closest(".gift-options-wrapper");a=c.find(".month-select").val();var b=c.find(".day-select");b.val();var c=c.find(".year-select").val(),d=v(c,a);if(b.hasClass("a-native-dropdown"))q.when("a-dropdown").execute(function(a){a=a.getSelect(b);if(a.getOptions().size()>d)for(var c=a.getOptions().size()-
1;c>=d;c--)a.removeOption(c);else for(c=a.getOptions().size();c<d;c++)a.addOption({text:c+1,value:c+1},c)});else{if(b.find("option").length>d)b.find("option:gt("+(d-1)+")").remove();else for(a=b.find("option").length+1;a<=d;a++)b.append(y("\x3coption\x3e",{value:a}).text(a));b.trigger("change")}},initSelectedTabAndWrapHolderWidth:G,initGiftMessage:function(a,c){ea&&!a.is("textarea")&&(a=a.find("textarea"));Y.push({id:a.attr("id"),maxChars:parseInt(c.maxChars,10),maxLines:parseInt(c.maxLines,10),useByteSize:c.useByteSize});
da(a.closest(".gift-options-wrapper").find(".includeMessageCheckbox")).is(":checked")||a.addClass("a-form-disabled");"1"===y("#multipleAFNGiftWrapOption").val()&&(a=a.attr("id").substring(a.attr("id").lastIndexOf("-")+1,a.attr("id").size),G(a))},enforceSelectorParity:P,enforceGiftReceiptParity:function(a,b){a=y("#item-"+b.itemId);if(0!==a.length){b=a.find(".item-receipt-row label");var d=da(a.find(".includeReceiptCheckbox")),e=a.find(".mfn-hide-price-row label"),f=da(a.find(".mfnHidePriceCheckbox")),
n=a.find(".item-message-row label"),r=da(a.find(".includeMessageCheckbox")).is(":checked"),g=!1;0<a.find(".afn-wrap-checkbox").length?da(a.find(".afn-wrap-checkbox")).is(":checked")&&(g=!0):0<a.find(".mfn-no-wrap-radio").length&&(da(a.find(".mfn-no-wrap-radio")).is(":checked")||(g=!0));if(g||r)h(d),h(f);g||r&&n.is(":visible")?(c(d),b.addClass("checkout-gift-option-disabled"),c(f),e.addClass("checkout-gift-option-disabled")):(l(d),l(f),b.removeClass("checkout-gift-option-disabled"),e.removeClass("checkout-gift-option-disabled"))}},
enforceHidePriceParity:function(a){var c=!1;y(".includeReceiptCheckbox").each(function(){if(da(y(this)).is(":checked"))return c=!0,!1});var b=!1;y(".mfnHidePriceCheckbox").each(function(){if(da(y(this)).is(":checked"))return b=!0,!1});c||b?(D(),y(".kindle-reg-msg-your-account").hide(),y(".kindle-reg-msg-another-account").show()):(H(),y(".kindle-reg-msg-another-account").hide(),y(".kindle-reg-msg-your-account").show())},toggleNoReceiptWarning:function(a){var c=da(a).is(":checked"),b=a.closest(".gift-options-wrapper");
a=b.find(".no-receipt-warning");var e=b.find(".empty-message-warning"),b=b.find(".item-message-row").find(".includeMessageCheckbox"),f=da(b);c?(a.hide(),b.is(":visible")||h(f)):(e.hide(),a.show(),f.is(":checked")&&(ea?f.is(":checked")&&f.closest("label").click():(d.increaseCount("removeauijs5"),f.removeAttr("checked").trigger("change"))))},toggleMessageArea:function(a){var c=a.closest(".gift-options-wrapper");if(a.is("textarea"))c=da(c.find(".includeMessageCheckbox")),h(c);else{a=da(c.find(".includeMessageCheckbox")).is(":checked");
var b=c.find(".item-message-row label").is(":visible"),d=0<c.find(".empty-message-warning").length,e=c.find("textarea"),f=e.data("default-text"),n=0<e.val().length;a?(c.find(".gift-message-edit").show(),c.find(".gift-message-label").removeClass("a-color-secondary"),e.removeClass("a-form-disabled"),f&&e.val(f)):(b&&c.find(".gift-message-edit").hide(),c.find(".gift-message-label").addClass("a-color-secondary"),e.addClass("a-form-disabled"),f&&e.val(""));d&&(a&&n?C(c,!1):C(c,!0))}},toggleMessageLocationText:aa,
toggleMessageBoxDisplay:function(b,d){var e=y("#item-"+d.itemId);if(0!==e.length){var f=e.find(".item-message-row");d=e.find(".item-receipt-row");var n=e.find(".gift-message-on-card"),r=e.find(".gift-message-on-receipt"),g=f.find("label"),f=da(f.find(".includeMessageCheckbox")),u=a.trim(e.find(".gift-message-default-placeholder").text()),k=a.trim(e.find(".gift-message-with-wrap-placeholder").text()),e=e.find("textarea"),m=b.hasClass("mfn-no-wrap-radio")||b.closest("div").hasClass("mfn-no-wrap-radio");
da(b).is(":checked")&&!m?(r.hide(),n.show(),e.attr("placeholder",k),d.is(":visible")&&(h(f),g.is(":visible")&&(c(f),g.addClass("checkout-gift-option-disabled")))):(n.hide(),r.show(),e.attr("placeholder",u),l(f),g.removeClass("checkout-gift-option-disabled"))}},updateContinueButtons:function(){for(var c=!0,b,d=0;d<Y.length;d++)if(b=y("#"+Y[d].id),b.closest(".gift-options-wrapper").find(".includeMessageCheckbox").find('input[type\x3d"checkbox"]').is(":checked")&&(b=X(Y[d]),0>b.charDelta||0>b.lineDelta))c=
!1;c?(y(".save-gift-button-box span.a-button-primary:not(.a-button-disabled)").show(),y(".save-gift-button-box span.a-button-disabled").hide()):(y(".save-gift-button-box span.a-button-primary:not(.a-button-disabled)").hide(),c=y(".save-gift-button-box span.a-button-disabled"),c.removeClass("aok-hidden"),c.show());a.trigger("orderSummary:primaryActionButton:mirrorPanelBtnState")},updateMessageCounter:function(a){ea&&!a.is("textarea")&&(a=a.find("textarea"));for(var c,b=0;b<Y.length;b++)a.attr("id")===
Y[b].id&&(c=X(Y[b]));if(c){a=a.closest(".gift-options-wrapper");b=a.find(".message-counter");b.find(".remaining-count").hide();if(0<a.find(".empty-message-warning").length){if(0===c.length){C(a,!0);return}C(a,!1)}(-1>c.charDelta?b.find(".remaining-char-over-multiple").show():0>c.charDelta?b.find(".remaining-char-over-single").show():1===c.charDelta?b.find(".remaining-char-single").show():b.find(".remaining-char-multiple").show()).find(".chars-remaining").html(Math.abs(c.charDelta));(-1>c.lineDelta?
b.find(".remaining-line-over-multiple").show():0>c.lineDelta?b.find(".remaining-line-over-single").show():1===c.lineDelta?b.find(".remaining-line-single").show():b.find(".remaining-line-multiple").show()).find(".lines-remaining").html(Math.abs(c.lineDelta));b.show()}},updateSelectedGiftWrap:Q,clearGiftConnection:function(a,c){y("#include-gift-connection-checkbox-"+c.itemId).is(":checked")||(r(c.itemId),x(c.itemId))},toggleGiftConnectionAgeDropdown:L,toggleGiftConnectionRecipientArea:function(a,c){a=
y("#select-recipient-"+c.itemId).find(":selected").val();var b=y("#select-occasion-"+c.itemId).find(":selected").val();!a||"1"!==a&&"2"!==a?(y(".gift-connection-recipient-extra-"+c.itemId).hide(),"1"===b&&a&&K(c.itemId,a)):y(".gift-connection-recipient-extra-"+c.itemId).removeClass("aok-hidden").show();L(c.itemId,b,a);x(c.itemId)},toggleGiftConnectionOccasionArea:function(a,c){a=y("#select-occasion-"+c.itemId).find(":selected").val();var b=y("#select-recipient-"+c.itemId).find(":selected").val();
!a||"1"!==a&&"2"!==a?y(".gift-connection-occasion-extra-"+c.itemId).hide():("1"===a&&b&&"1"!==b&&"2"!==b&&K(c.itemId,b),y(".gift-connection-occasion-extra-"+c.itemId).removeClass("aok-hidden").show());L(c.itemId,a,b)},includeGiftConnection:function(a,c){(a=y("#select-recipient-"+c.itemId).find(":selected").val())&&"0"===a||y("#include-gift-connection-checkbox-"+c.itemId).attr("checked",!0)},updateGiftOptionsTabSelection:ga,updatePreviewImageOnMouseEnter:E,updatePreviewImageOnMouseLeave:F,toggleGiftMessageWarning:function(a){var c=
y("#"+a.attr("id"));m.toggleGiftMessageWarning(c,a.closest(".item-gift-message-span"))}};a.declarative("gift-form-element",["change"],function(a){var c;c=a.$event.isInit?a.data.onInit||[]:a.data.onChange||[];for(var b=0;b<c.length;b++)if(na[c[b]])na[c[b]](a.$target,a.data)});a.declarative("gift-form-element","click mouseenter mouseleave",function(a){var c;if(c=a.data[{click:"onClick",mouseenter:"mouseEnter",mouseleave:"mouseLeave"}[a.type]])for(var b=0;b<c.length;b++)if(na[c[b]])na[c[b]](a.$currentTarget,
a.data,a)});a.declarative("select-gift-wrap","click",function(a){Q(a.$target.parents("li"),{itemId:a.data.itemId,wrapNo:a.data.wrapNo});P(a.$target);var c=a.$target.parents("li").find(".gift-hidden-radio");aa(c,{itemId:a.data.itemId})});a.declarative("select-gift-wrap","mouseenter",function(a){E(a.$target.parents("li"),a.data)});a.declarative("select-gift-wrap","mouseleave",function(a){F(a.$target.parents("li"),a.data)});a.declarative("update-gift-options-tab-selection",["click"],function(a){var c=
a.$target.parents("li");c.attr("data",a.data);ga(c,a.data)});a.on("checkout:reload:giftselect",z);a.on("checkout:reload:spp-giftoptions",z);return{extendFunctions:function(a){y.extend(na,a)}}});"use strict";q.when("A","page-transition-controller","page-conductor").register("gift-form-del-opt-controller",function(a,k,g){function b(a){var b=a.closest(".expando-box");b&&(b=b.find(".a-expander-header"),a.closest(".expando-content").is(":hidden")&&b.click())}function e(a){var b=a.closest(".gift-options-wrapper"),
c=b.find(".includeMessageCheckbox").find('input[type\x3d"checkbox"]');if(c&&!c.is(":checked"))return!0;c=b.find(".email-error-selector");b.find(".gift-notification-email-error").hide();c.removeClass("a-form-error");if(64<p.unescape(encodeURIComponent(a.val())).length)return c.addClass("a-form-error"),b.find(".gift-notification-email-length-exceeded-error").removeClass("aok-hidden").show(),!1;if(/^\S+[@]\S+[.]\S+$/.test(a.val()))return!0;c.addClass("a-form-error");b.find(".gift-notification-invalid-email-error").removeClass("aok-hidden").show();
return!1}function f(){d("#giftForm").find(".save-gift-button-box span.a-button-primary:not(.a-button-disabled)").unbind("click").bind("click",function(a){a.preventDefault();m(a)});d(".checkout-gift-image-preview-trigger \x3e a").show();d("#gift-kindle-imb").show()}function m(f){f=d("#giftForm");var h=f.find('input[name\x3d"hidePrices"]'),c=h.is(":disabled");c&&h.removeAttr("disabled");for(var l=!0,m=a.state("giftNotificationEmailConstraints"),w=a.state("giftDeliveryDateConstraints"),z=0;z<m.length;z++){var v=
d("#"+m[z].id);e(v)||(l=!1,b(v))}for(m=0;m<w.length;m++){z=d("#"+w[m].id);var v=z.closest(".gift-options-wrapper"),A=v.find(".includeMessageCheckbox").find('input[type\x3d"checkbox"]');if(A&&!A.is(":checked"))v=!0;else{var r=v.find(".month-select").val(),u=v.find(".day-select").val(),A=v.find(".year-select"),K=A.val(),x=v.find("#current-date").val().split("-"),r=new Date(K,r,u),x=new Date(x[0],x[1]-1,x[2]),u=new Date(x.getTime());u.setMonth(u.getMonth()+12);v.find(".gift-delivery-date-error").hide();
K=v.find(".date-error-selector");A=A.hasClass("a-native-dropdown")?"error-border a-form-error":"a-form-error";K.removeClass(A);r>=u||r<x?(v.find(".gift-delivery-date-error").removeClass("aok-hidden").show(),K.addClass(A),v=!1):v=!0}v||(l=!1,b(z))}a.state("continueAction",{enable:l});if(a.state("continueAction").enable)g.isSPP()||k.showPageTransition(),f.submit();else return d("html, body").animate({scrollTop:d(".a-form-error").closest("div").offset().top},500),!1;c&&h.attr("disabled",!0)}var d=a.$;
a.declarative("submit-gift-options","click",function(a){m(a)});a.declarative("discard-gift-options","click",function(a){d('#giftForm input[type\x3d"checkbox"]').prop("checked",!1);d("#giftForm textarea").addClass("a-form-disabled");m(a)});a.on("checkout:reload:giftselect",f);a.on("checkout:reload:spp-giftoptions",f)});"use strict";q.when("A").register("teen-message-controller",function(a){var k=a.$;a.declarative("teen-message-form-element","click keyup",function(a){a=a.data.maxChars;var b=k("#teen-message-box").val(),
e=b.match(/(\r\n|\n|\r)/g),f=0;e&&(f=e.length);b=b.length+f;k(".remaining-char").text(Math.max(a-b,0))});k("#aui-teen-message-box").length&&k(".remaining-char").length&&q.when("A").execute(function(a){function b(a){a=a.val();var b=(a.match(/(\r\n|\n|\r|\n\r)/g)||{}).length||0;return a.length+b}a=a.$;var e,f,k;e=a("#aui-teen-message-box");e.bind("change keypress",function(a){return b(e)>=k?(a.preventDefault(),!1):!0});e.bind("paste",function(a){if(a&&a.originalEvent&&a.originalEvent.clipboardData&&
a.originalEvent.clipboardData.getData("Text")){var f=a.originalEvent.clipboardData.getData("Text"),h=b(e);if(h+f.length>=k)return f=f.substring(0,k-h),f=e.val()+f,e.attr("value",f),a.preventDefault(),!1}return!0});e.bind("click keyup",function(){var a=Math.max(k-b(e),0);f.text(a)});f=a(".remaining-char");k=e.parent().data("maxchars")})});"use strict";q.when("A","page-transition-controller","page-conductor","loading-spinner-controller","client-side-metrics").register("concealment-form-del-opt-controller",
function(a,k,g,b,e){function f(a){var b=d("#concealmentForm");b.find("input:checked").length?(a=a.data.saveConcealmentRefTag,e.increaseCount("CPEX.Checkout.Select.Concealment",1)):(a=a.data.cancelConcealmentRefTag,e.increaseCount("CPEX.Checkout.Cancel.Concealment",1));b.find("input[name\x3dref]").val(a);b.attr("action",b.attr("action")+"/ref\x3d"+a)}function m(a){a=d("#concealmentForm");g.isSPP()||k.showPageTransition();a.submit()}var d=a.$;a.declarative("submit-concealment-options","click",function(a){f(a);
m(a)});a.declarative("discard-concealment-options","click",function(a){d('#concealmentForm input[type\x3d"checkbox"]').prop("checked",!1);f(a);m(a)});a.declarative("submit-concealment-form","click",function(a){f(a);a.$target.closest(".a-button").addClass("a-button-disabled");b.showSpinner(a.$target.closest("form"))})});"use strict";q.when("A","page-transition-controller","page-conductor","address-popovers","checkout-general-utils","a-popover","client-side-metrics","weblab-helper").register("itemselect-address-controller",
function(a,k,g,b,e,f,m,d){function n(){t(".lineitem").each(function(a,c){a=t(c);a.find(".no-js-address-dropdown").remove();a.find(".no-js-address-select").remove();a.find(".js-address-dropdown").prop("disabled",!1);a.find(".address-dropdown").removeClass("a-button-disabled")});t("#suppressAddAddressPopover").val()&&t('select[name^\x3d"addressID."]').find("option").each(function(){var a=t(this);"New"===a.val()&&a.closest("optgroup").remove()})}function h(a){var b=(new Date).getTime(),d=g.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});
t.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-address\x26cachebuster\x3d"+b,data:a,dataType:"text",headers:d,error:g.ajaxRedirect,success:function(a,b,d){var f=d.getResponseHeader("x-amz-checkout-fatal-error");if(null!==f&&f!==C)p.location=f;else if(c(d)){l(a,d);var h;a=A.find('input[name^\x3d"previousAddress."]');if(null!==a||a!==C)h=z||a.val();var r=A.find('select[name^\x3d"addressID."]');null===r&&r===C||q.when("a-dropdown").execute(function(a){a.setValue(r.attr("id").replace(/\./g,
"\\."),h);r.find("option").removeAttr("selected");r.find('option[value\x3d"'+h+'"]').attr("selected","selected")});k.hide()}else g.ajaxUpdatePage(a,b,d),e.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")}})}function c(a){a=a.getResponseHeader("x-amz-checkout-show-addon-warning");return null!==a&&a!==C}function l(a,c){c=c.getResponseHeader("x-amz-checkout-show-addon-warning");t(".item-list").hide();a.trim().split(",").forEach(function(a){t('[data-asin\x3d"'+a+'"]').show()});a=t("#addon-warning-"+
c+"-launcher");a.length&&(t(".delete-title").hide(),t(".reduce-title").hide(),t(".select-address-title").show(),t("input[name\x3duseLiveAUI]").length?f.get(a).attrs({$trigger:v,position:"triggerHorizontal"}).show():(c=t.Event("keyup",{triggerPositioningElement:v,manualTrigger:!0}),a.trigger(c)))}var t=a.$,w,z,v,A;a.declarative("itemselect-get-address",["click","touchend"],function(a){e.protectAgainstDoubleAction("itemselect-get-address",200)||(z=a.$currentTarget.find(".js-address-dropdown").val())});
a.declarative("itemselect-update-address",["change"],function(a){if(!e.protectAgainstDoubleAction("itemselect-update-address",200)){m.resetMetrics();var c=a.$currentTarget.is("select")?a.$currentTarget:a.$currentTarget.find("select");w=c.val();if("New"===w)b.actionTriggerPopoverFromDropdown(a),q.when("a-dropdown").execute(function(a){a.setValue(c.attr("id").replace(/\./g,"\\."),z)});else{k.show();A=c.closest(".lineitem");var d,f;if(A){var l=A.find('input[name^\x3d"lineItemEntityID."]');l&&(d=l.val());
(l=A.find('input[name^\x3d"quantity."]'))&&(f=l.val());(l=A.find(".js-address-dropdown"))&&(w=l.val())}v=a.$currentTarget.is("select")?a.$currentTarget.closest(".address-dropdown"):a.$currentTarget;a=0;l=t("#addon-indicator");l.length&&"true"===l.attr("data-has-addon-items")&&(a=1);h({lineitems:d,addresses:w,quantities:f,isTrial:a})}}});a.declarative("itemselect-update-pantry-address",["change"],function(a){if(!e.protectAgainstDoubleAction("itemselect-update-pantry-address",200)){w=a.$currentTarget.val();
k.show();var c="";a=a.$currentTarget.closest(".pantry-row");t(a).find(".pantry-item").each(function(a,b){a=t(b);c+="lineitems\x3d"+a.find('input[name^\x3d"lineItemEntityID."]').val()+"\x26";c+="addresses\x3d"+w+"\x26";c+="quantities\x3d"+a.find('input[name^\x3d"quantity."]').val()+"\x26"});h(c)}});a.declarative("addon-delete-items",["click","touchend"],function(a){if(v!==C&&null!==v&&!e.protectAgainstDoubleAction("itemselect-delete-addons",200)){t(".a-button-close").trigger("click");k.show();a=(new Date).getTime();
var c=t("#useCase").val(),b=g.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"}),d=A.find('input[name^\x3d"lineItemEntityID."]').val(),f=A.find('input[name^\x3d"quantity."]').val();t.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-address\x26cachebuster\x3d"+a,data:{lineitems:d,addresses:w,quantities:f,isTrial:0,deleteAddons:1,returnHTML:1,useCase:c},headers:b,error:g.ajaxRedirect,success:function(a,c,b){var d=b.getResponseHeader("x-amz-checkout-redirect-to-cart");
null!==d&&d!==C?p.location=d:(d=b.getResponseHeader("x-amz-checkout-fatal-error"),null!==d&&d!==C?p.location=d:(g.ajaxUpdatePage(a,c,b),e.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")))}})}});a.on("checkout:reload:itemselect",n);a.on("checkout:reload:spp-itemselect",n)});"use strict";q.when("A","page-transition-controller","page-conductor","checkout-general-utils","a-popover","client-side-metrics","weblab-helper").register("itemselect-delete-controller",function(a,k,g,b,e,f,m){function d(a,
c){n(a,null===c||c===C?a.$currentTarget.closest(".lineitem"):c)}function n(a,d){a.$event.preventDefault();if(!b.protectAgainstDoubleAction("itemselect-delete-single-item",200)){f.resetMetrics();k.show();z=d;A=a.$currentTarget.is("select")?a.$currentTarget.closest(".quantity-dropdown"):a.$currentTarget;a=z.find('input[name^\x3d"lineItemEntityID."]').val();d=0;(new Date).getTime();var e=w("#addon-indicator");e.length&&"true"===e.attr("data-has-addon-items")&&(d=1);c({lineitems:a,isTrial:d})}}function h(a,
d){a.$event.preventDefault();if(!b.protectAgainstDoubleAction("itemselect-delete-multiple-items",200)){k.show();v=d;A=a.$currentTarget;var e="";a=0;d=w("#addon-indicator");d.length&&"true"===d.attr("data-has-addon-items")&&(a=1);d=v.hasClass("pantry-row")?!0:!1;v.find(d?".pantry-item":".lineitem").each(function(a,c){e+="lineitems\x3d"+w(c).find('input[name^\x3d"lineItemEntityID."]').val()+"\x26"});c(e+"isTrial\x3d"+a)}}function c(a){var c=(new Date).getTime(),b=w('input[name\x3d"useCase"]').val(),
d=g.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});w.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3ddelete\x26useCase\x3d"+b+"\x26cachebuster\x3d"+c,data:a,dataType:"text",headers:d,error:g.ajaxRedirect,success:l})}function l(a,c,d){var e;e=d.getResponseHeader("x-amz-checkout-redirect-to-cart");null!==e&&e!==C?(p.location=e,e=!0):e=!1;e||(e=d.getResponseHeader("x-amz-checkout-fatal-error"),null!==e&&e!==C?p.location=e:(e=d.getResponseHeader("x-amz-checkout-show-addon-warning"),
e=null!==e&&e!==C?!0:!1,e?(t(a,d),k.hide()):(g.ajaxUpdatePage(a,c,d),b.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"))))}function t(a,c){c=c.getResponseHeader("x-amz-checkout-show-addon-warning");w(".item-list").hide();a.trim().split(",").forEach(function(a){w('[data-asin\x3d"'+a+'"]').show()});a=w("#addon-warning-"+c+"-launcher");a.length&&(w(".delete-title").show(),w(".reduce-title").hide(),w(".select-address-title").hide(),w("input[name\x3duseLiveAUI]").length?e.get(a).attrs({$trigger:A,
position:"triggerHorizontal"}).show():(c=w.Event("keyup",{triggerPositioningElement:A,manualTrigger:!0}),a.trigger(c)))}var w=a.$,z,v,A;a.declarative("itemselect-delete-item",["click","touchend"],d);a.declarative("itemselect-delete-item-row",["click","touchend"],function(a){h(a,a.$currentTarget.closest(".item-row"))});a.declarative("addon-delete-items",["click","touchend"],function(a){if(A!==C&&!b.protectAgainstDoubleAction("itemselect-delete-addons",200)){w(".a-button-close").trigger("click");k.show();
var d="";null!==v&&v!==C?(a=v.hasClass("pantry-row")?v.find(".pantry-item"):v.find(".lineitem"),w(a).each(function(a,c){d+="lineitems\x3d"+w(c).find('input[name^\x3d"lineItemEntityID."]').val()+"\x26"})):null!==z&&z!==C&&(d+="lineitems\x3d"+z.find('input[name^\x3d"lineItemEntityID."]').val()+"\x26");c(d+"isTrial\x3d0\x26deleteAddons\x3d1")}});a.declarative("itemselect-delete-pantry-item",["click","touchend"],function(a){n(a,a.$currentTarget.closest(".pantry-item"))});a.declarative("itemselect-delete-pantry",
["click","touchend"],function(a){h(a,a.$currentTarget.closest(".pantry-row"))});a.declarative("itemselect-delete-popover-item",["click","touchend"],function(a){var c=a.$currentTarget.data("entityidtodelete");h(a,w('a[data-entityid\x3d"'+c+'"]').closest(".item-row"))});return{actionDeleteItem:d}});"use strict";q.when("A","page-transition-controller","page-conductor","itemselect-delete-controller","checkout-general-utils","a-popover","client-side-metrics","weblab-helper").register("itemselect-quantity-controller",
function(a,k,g,b,e,f,m,d){function n(){z(".lineitem, .pantry-item").each(function(a,c){a=z(c);a.find(".no-js-quantity").remove();c=a.find(".quantity-dropdown");c.is(":visible")?(a.find(".js-select").prop("disabled",!1),c.removeClass("a-button-disabled")):(a=a.find(".quantity-input"),a.prop("disabled",!1),a.removeClass("a-form-disabled"))})}function h(a){a.find(".quantity-input").val(a.find('input[name^\x3d"previousQuantity."]').val())}function c(a){var c=a.$currentTarget.closest(".quantity-text-field").find(".update-quantity-link"),
b=a.$currentTarget.is("input")?a.$currentTarget.val():a.$currentTarget.find("input").val(),d;d="itemselect-show-update-pantry-button"===a.action?".pantry-item":".lineitem";0===parseInt(b,10)||""===b?("change"===a.type&&h(a.$currentTarget.closest(d)),c.hide()):(a=a.$currentTarget.closest(d).find('input[name^\x3d"previousQuantity."]').val(),b!==a?c.show():c.hide())}function l(a){a.$event.preventDefault();if(!e.protectAgainstDoubleAction("itemselect-update-quantity",200)){m.resetMetrics();r=a.$currentTarget.closest("itemselect-update-pantry-quantity"===
a.action||"itemselect-update-pantry-quantity-text-field"===a.action?".pantry-item":".lineitem");var c=r.find(".js-address-dropdown").val(),d=a.$currentTarget.find("select"),f=d.length?d:a.$currentTarget;v=f.is("select")?f.val():r.find(".quantity-input").val();if(0===parseInt(v,10)||""===v)h(r);else if("Delete"===v)q.when("a-dropdown").execute(function(a){a.setValue(f.attr("id").replace(/\./g,"\\."),A)}),b.actionDeleteItem(a,r);else{k.show();a=r.find('input[name^\x3d"lineItemEntityID."]').val();var d=
0,l=(new Date).getTime(),n=z("#useCase").val(),P=z("#addon-indicator");u=f.is("select")?f.parent():r.find(".quantity-input");P.length&&"true"===P.attr("data-has-addon-items")&&(d=1);P=g.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});z.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-quantity\x26cachebuster\x3d"+l,data:{lineitems:a,quantities:v,address:c,isTrial:d,returnHTML:1,useCase:n},dataType:"text",headers:P,error:g.ajaxRedirect,success:function(a,
c,b){var d=b.getResponseHeader("x-amz-checkout-fatal-error");null!==d&&d!==C?p.location=d:(d=b.getResponseHeader("x-amz-checkout-show-addon-warning"),d=null!==d&&d!==C?!0:!1,d?(w(a,b),t(A===C?r.find('input[name^\x3d"previousQuantity."]').val():A,b),k.hide()):(g.ajaxUpdatePage(a,c,b),e.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")))}})}}}function t(a,c){10>a?(q.when("a-dropdown").execute(function(c){var b=r.find('select[name^\x3d"quantity."]');c.setValue(b.attr("id").replace(/\./g,
"\\."),a);b.find("option").removeAttr("selected");b.find('option[value\x3d"'+a+'"]').attr("selected","selected")}),r.find(".quantity-dropdown").show(),r.find(".quantity-text-field").hide(),r.find(".js-select").prop("disabled",!1),r.find(".quantity-input").prop("disabled",!0)):(r.find(".quantity-dropdown").hide(),r.find(".quantity-text-field").show(),r.find(".update-quantity-link").hide(),r.find(".js-select").prop("disabled",!0),r.find(".quantity-input").prop("disabled",!1));r.find(".quantity-input").val(a);
r.find('input[name^\x3d"previousQuantity."]').val(a)}function w(a,c){c=c.getResponseHeader("x-amz-checkout-show-addon-warning");z(".item-list").hide();a.trim().split(",").forEach(function(a){z('[data-asin\x3d"'+a+'"]').show()});a=z("#addon-warning-"+c+"-launcher");a.length&&0<a.length&&(z(".reduce-title").show(),z(".delete-title").hide(),z(".select-address-title").hide(),z("input[name\x3duseLiveAUI]").length?f.get(a).attrs({$trigger:u}).show():(c=z.Event("keyup",{triggerPositioningElement:u,manualTrigger:!0}),
a.trigger(c)))}var z=a.$,v,A,r,u;a.declarative("itemselect-get-quantity",["click","touchend"],function(a){e.protectAgainstDoubleAction("itemselect-get-quantity",200)||a.$currentTarget.find("select").length&&(A=a.$currentTarget.find("select").val())});a.declarative("itemselect-update-quantity",["change"],l);a.declarative("itemselect-update-pantry-quantity",["change"],l);a.declarative("addon-delete-items",["click","touchend"],function(a){if(u!==C&&!e.protectAgainstDoubleAction("itemselect-delete-addons",
200)){z(".a-button-close").trigger("click");k.show();a=r.find('input[name^\x3d"lineItemEntityID."]').val();var c=(new Date).getTime(),b=z("#useCase").val(),d=g.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});z.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-quantity\x26cachebuster\x3d"+c,data:{lineitems:a,quantities:v,isTrial:0,deleteAddons:1,returnHTML:1,useCase:b},headers:d,error:g.ajaxRedirect,success:function(a,c,b){var d=b.getResponseHeader("x-amz-checkout-redirect-to-cart");
null!==d&&d!==C?p.location=d:(d=b.getResponseHeader("x-amz-checkout-fatal-error"),null!==d&&d!==C?p.location=d:(g.ajaxUpdatePage(a,c,b),e.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")))}})}});a.declarative("itemselect-sanitize-input",["keydown"],function(a){e.limitInputToNumbers(a)});a.declarative("itemselect-update-quantity-text-field",["click","touchend"],l);a.declarative("itemselect-update-pantry-quantity-text-field",["click","touchend"],l);a.declarative("itemselect-show-update-button",
["change","keyup"],c);a.declarative("itemselect-show-update-pantry-button",["change","keyup"],c);a.on("checkout:reload:itemselect",n);a.on("checkout:reload:spp-itemselect",n)});"use strict";q.when("A","page-transition-controller","page-conductor","checkout-general-utils","client-side-metrics").register("itemselect-ship-to-multiple-controller",function(a,k,g,b,e){var f=a.$;a.declarative("itemselect-ship-to-multiple",["click","touchend"],function(a){a.$event.preventDefault();e.resetMetrics();if(!b.protectAgainstDoubleAction("itemselect-ship-to-multiple",
200)){k.show();var d=null,n=null,h=null;a.$currentTarget.closest(".item-row").find(".lineitem").each(function(a,c){a=f(c);c=a.find('select[name^\x3d"quantity."]');var b=a.find('input[type\x3d"number"]');if(a.find(".quantity-dropdown").is(":visible")&&1<c.val())return d=a.find('input[name^\x3d"lineItemEntityID."]').val(),n=c.val(),h=a.find(".js-address-dropdown").val(),!1;if(a.find(".quantity-text-field").is(":visible")&&1<b.val())return d=a.find('input[name^\x3d"lineItemEntityID."]').val(),n=b.val(),
h=a.find(".js-address-dropdown").val(),!1});if(null!==d){a=(new Date).getTime();var c=g.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});f.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dship-to-multiple\x26cachebuster\x3d"+a,data:{lineitem:d,quantity:n,address:h},headers:c,dataType:"text",error:g.ajaxRedirect,success:function(a,c,d){var e=d.getResponseHeader("x-amz-checkout-fatal-error");null!==e&&e!==C?p.location=e:(g.ajaxUpdatePage(a,c,d),b.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"))}})}}})});
"use strict";q.when("A").register("safe-apx-helper",function(a){var k={},g=a.$;return{get:function(a){return k[a]},set:function(){1===arguments.length?k=g.extend(k,arguments[0]):2===arguments.length?k[arguments[0]]=arguments[1]:p.console&&p.console.error&&p.console.error("Unexpected number of arguments: %d. Expected 1 or 2.",arguments.length)}}});"use strict";q.when("A","weblab-helper").register("mobile-carrier-billing-util",function(a,k){var g=!1;return{determineIsMCBEnabled:function(a){g=0<a.paymentRows.find('input[type\x3d"radio"][name\x3dpaymentMethod]').filter("[value^\x3dMCB]").size()},
toggleGCForMCB:function(a,e){if(!k.isMCBMultiTenderWeblabEnabled()&&g&&(a=a.find('input[type\x3d"radio"][name\x3dpaymentMethod]'),a.length)){var f=e.paymentRows.find('input[type\x3d"checkbox"][name\x3duseAvailableBalance]'),f=e.existingBalance||f,m=0<e.paymentRows.find('input[type\x3d"hidden"][name\x3d"gcBalance"]').length,d="paymentsForm"in e&&0<e.paymentsForm.find('input[type\x3d"hidden"][name\x3d"gcBalance"]').length,m=m||d;0<a.filter("[value^\x3dMCB]").size()&&m?(f.length&&(f.prop("checked",!1),
f.prop("disabled",!0)),e.mcbBalanceWarning&&e.mcbBalanceWarning.show()):(f.length&&f.prop("disabled",!1),e.mcbBalanceWarning&&e.mcbBalanceWarning.hide())}},showMCBWarningMessageForPoints:function(a){g&&a.mcbPointsWarning&&a.mcbPointsWarning.show()},hideMCBWarningMessageForPoints:function(a){g&&a.mcbPointsWarning&&a.mcbPointsWarning.hide()}}});"use strict";q.when("A").register("emi-utils",function(a){return{}});"use strict";q.when("A").register("emi-helper",function(a){return{}});"use strict";q.when().register("instant-bank-discount-helper",
function(){return{showInstantBankDiscountAmazonPayDeselected:function(){},showInstantBankDiscountAmazonPaySelected:function(){}}});"use strict";q.when("A","page-detector","checkout-general-utils").register("pay-common-lib",function(a,k,g){function b(a,c){c.attr("name")&&(a[c.attr("name")]=c.val());c.attr("id")&&(a[c.attr("id")]=c.val())}function e(a,c){if(!c)return a;for(var b in c)c.hasOwnProperty(b)&&(a[b]=c[b]);return a}function f(a,c,b){m.each(c,function(c,d){a[c]=b?b.find(d):m(d)})}var m=a.$,
d="checkbox hidden password radio text number tel month".split(" "),n={};a.declarative("move-to-next-field",["keypress"],function(a){13===a.$event.charCode&&(g.moveToNextInput(a.$declarativeParent),a.$event.preventDefault())});a.declarative("scroll-to-input",["keypress"],function(a){13===a.$event.charCode&&(m(p).scrollTop(a.$declarativeParent.offset().top),a.$event.preventDefault())});return{getAttributeData:function(a,c){if(a)return a.attr(c)||a.attr("data-"+c)||a.data(c)},getElements:function(a,
c){var b={};f(b,a,c);return b},getInputValues:function(a){var c=a.find(".data-row").data()||{};a.find("input").each(function(){var a=m(this),e=a.attr("type");("radio"!==e&&"checkbox"!==e||a.is(":checked"))&&-1<m.inArray(e,d)&&b(c,a)});a.find("select").each(function(){b(c,m(this))});return c},isDesktopCX:k.isDesktopPayment,isMobileCX:k.isMobilePayment,isPayPage:k.isPayment,isTouchCX:k.isTabletPayment,mergeFrom:function(a,c){c=e({},c);return e(c,a)},prop:function(a,c,b){if(a){if(1<arguments.length)return c===
C?delete n[a]:n[a]={isOneTime:b?1:0,value:c},c;var d=n[a];if(d)return d.isOneTime&&delete n[a],d.value}},refreshElements:f,scrollTopTo:function(a){a&&a.length&&m("html,body").animate({scrollTop:a.offset().top-20},"fast")},selectDefaultPaymentMethodIfNotSelected:function(){var a=m("#existing-payment-methods .payment-row").find('input[type\x3d"radio"][name\x3d"paymentMethod"]'),c=a.closest("div.payment-selected");c&&0<c.length||(a=a.closest("div.default-payment-marker"))&&a.length&&(a.addClass("payment-selected"),
a.find("[name\x3dpaymentMethod]").attr("checked",!0))},processSubmissionParameters:function(a){for(var c={},b=0;b<a.length;b++)c[a[b].name]=a[b].value;return c}}});"use strict";q.when("A","pay-common-lib","a-popover-base","ajax-utility","loading-spinner-controller","page-conductor","page-transition-controller").register("pay-desktop-util",function(a,k,g,b,e,f,m){function d(a){a.$event.preventDefault();a.$target.closest(".a-popover").hide();a.$target.siblings("span.error-message").hide()}function n(a){a.preventDefault();
var c=u(a.currentTarget),b=c.closest("div.expando-section");a=b.find("div.expando-content");var b=b.find("div.expando-reverse-content"),d=a.is(":visible"),e=function(){var a=c.find("i");a.hasClass("a-icon-collapse")||a.hasClass("a-icon-expand")?d?(a.removeClass("a-icon-collapse").addClass("a-icon-expand"),c.find("div.expando-toggle-text-show").show(),c.find("div.expando-toggle-text-hide").hide()):(a.removeClass("a-icon-expand").addClass("a-icon-collapse"),c.find("div.expando-toggle-text-show").hide(),
c.find("div.expando-toggle-text-hide").show()):d?(a.removeClass("a-icon-section-collapse").addClass("a-icon-section-expand"),c.find("div.expando-toggle-text-show").show(),c.find("div.expando-toggle-text-hide").hide()):(a.removeClass("a-icon-section-expand").addClass("a-icon-section-collapse"),c.find("div.expando-toggle-text-show").hide(),c.find("div.expando-toggle-text-hide").show())};d?(b.slideDown("fast"),a.slideUp("fast",e)):(b.slideUp("fast"),a.slideDown("fast",e))}function h(a){var c=a.$target.closest("a");
a=c.closest("div.extender-section");c=c.find("i");c.hasClass("a-icon-extender-expand")?(a.find(".collapsed").hide(),a.find(".expanded").slideDown("fast"),c.removeClass("a-icon-extender-expand").addClass("a-icon-extender-collapse")):(a.find(".collapsed").show(),a.find(".expanded").slideUp("fast"),c.removeClass("a-icon-extender-collapse").addClass("a-icon-extender-expand"))}function c(a){H.msgPopovers.filter(":visible").hide();a.$event.preventDefault();a.$event.stopPropagation();a=a.$target.parent().find(".a-popover");
a.is(":visible")||a.show()}function l(a,c,b){var d=a||{},e="string"===typeof a;b=b&&b.useSif?u('input[type\x3d"hidden"][name\x3d"isAmazonApp"]').val():0;e?(d+="\x26ajaxResponse\x3d1\x26returnjson\x3d1",b&&(d+="\x26isAmazonApp\x3d1")):(d.ajaxResponse=1,d.returnjson=1,b&&(d.isAmazonApp=1));for(b=0;b<D.length;b++){var f=D[b],h=u("input[name\x3d"+f+"]").val();e?-1===c.search(f)&&-1===a.search(f)&&(d=d+"\x26"+f+"\x3d"+h):d[f]=h}return d}function t(a,c){if(0>a)return 0;isNaN(c)||(a=Number(a).toFixed(c));
a=a.toString();c=0<=a.lastIndexOf(".")?a.lastIndexOf("."):a.length;return 3>=c?a:t(a.substring(0,c-3),0)+","+a.substring(c-3)}function w(a,c,b,d){a="timeout"===c?"pay-ajax-timeout":"abort"===c?"pay-ajax-abort":"abort-for-cleanup"===c?"pay-ajax-abort-for-cleanup":"parsererror"===c?"pay-ajax-parsererror":500===a.status?"pay-ajax-500":"pay-ajax-error";if(b){a=b=-1===b.lastIndexOf(".html?")?b+("?ref\x3d"+a):b+("\x26ref\x3d"+a);H.pageContainer.find("#tempForm").remove();b=u('\x3cform id\x3d"#tempForm" method\x3d"post"\x3e\x3c/form\x3e');
b.attr("action",a);if("string"===typeof d){a={};c=d.split("\x26");for(var e=0;e<c.length;e++){var f=c[e].split("\x3d");2===f.length&&(a[f[0]]=f[1])}}else a=d;for(var h in a)"ajaxResponse"!==h&&"returnjson"!==h&&(a=u('\x3cinput type\x3d"hidden"/\x3e').attr("name",h).val(d[h]),b.append(a));H.pageContainer.append(b);b.submit()}}function z(a,c,d,e){var h=f.setAjaxTransitionHeader({"x-amz-checkout-page":"payselect"}),h={contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",data:l(c,a,e),dataType:"text",
headers:h,timeout:x,type:"POST",url:a,beforeSend:function(a,c){d&&d.beforeHandler&&d.beforeHandler(a,c)},complete:function(a,c){d&&d.completeHandler&&d.completeHandler(a,c)},error:function(b,e){d&&d.errorHandler?d.errorHandler(b,e):w(b,e,a,c)},success:function(a,c,e){var h=e.getResponseHeader("x-amz-checkout-page");if("payselect"!==h&&"spp-payment"!==h)return a=b.jsonify(a),f.redirect(a);d&&d.successHandler?d.successHandler(a,c,e):f.ajaxUpdatePage(a,c,e)}};u.extend(h,e);p.push(u.ajax(h))}function v(a,
c,b,d){var e=f.setAjaxTransitionHeader({"x-amz-checkout-page":"payselect"}),e={contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",data:l(c,a,d),dataType:"text",headers:e,timeout:x,type:"POST",url:a,error:function(d,e){b&&b.errorHandler?b.errorHandler(d,e):w(d,e,a,c)},success:function(a,c,d){var e=d.getResponseHeader("x-amz-checkout-page");"payselect"!==e&&"spp-payment"!==e&&b&&b.pageUpdater?b.pageUpdater(a):f.ajaxUpdatePage(a,c,d)}};u.extend(e,d);p.push(u.ajax(e))}function A(){x=parseInt(u("input[type\x3d'hidden'][name\x3d'paypageTimeoutValue']").val(),
10);x=isNaN(x)?1E4:x;k.isMobileCX()?K&&(K=!1):(H=k.getElements(q),K&&(a.declarative("close-popover",["click"],d),a.declarative("toggle-msg-popover",["click"],c),a.declarative("a-extender-toggle",["click"],h),K=!1),H.pageContainer.undelegate(".expando-link","click").delegate(".expando-link","click",n),H.pageContainer.find("form select.a-touch-select-input").unbind("change",r).bind("change",r),u(".a-dropdown-container").each(function(){g.remove(u(this).find("select").attr("name"))}),u(document).bind("click",
function(a){a.isPropagationStopped()||0===u(a.target).closest(".pay-popover-msg").length&&H.msgPopovers.filter(":visible").hide()}))}function r(a){var c=u(a.currentTarget);a=c.siblings("a.a-placeholder");c=c.find(":selected").text();a.html(c);return!1}var u=a.$,K=!0,x,p=[],D=["forceResponsive","fromAnywhere","hasWorkingJavascript"],H={},q={msgPopovers:"div.pay-popover-msg",pageContainer:"div.a-container"};a.on("checkout:reload:payselect",A);a.on("checkout:reload:spp-payment",A);return k.mergeFrom({decodeJSONResponse:function(a){var c=
new RegExp(String.fromCharCode(65340),"g"),b=new RegExp(String.fromCharCode(92,92,92,92),"g");a=a.replace(c,String.fromCharCode(92),"g");a=a.replace(b,String.fromCharCode(92));a=a.replace(/\\1/g,String.fromCharCode(34));return a=a.replace(/\\2/g,String.fromCharCode(10))},elements:H,getNumberWithSeparators:t,handleForm:function(a,c,b){a.$event.preventDefault();var d=a.$declarativeParent;d.is("span")&&(d=d.find("form"));d=d.serializeArray();d=k.processSubmissionParameters(d);z(a.data.action,d,c,b)},
makeAjaxCall:z,handleAjaxError:w,handlePaymentsPortalForm:function(a,c,b,d){a=k.processSubmissionParameters(a.submissionParameters);z(c,a,b,d)},handlePaymentsPortalRedeemClaimCodeTransition:function(a,c,b,d){a=k.processSubmissionParameters(a.submissionParameters);a.embedOnlyData=1;v(c,a,b,d)}},k)});"use strict";q.when("A","pay-common-lib","page-transition-controller").register("pay-mobile-util",function(a,k,g){function b(a,c,b){a=a||{};var d=z.fromAnywhereField.val(),e=b&&b.useSif?l('input[type\x3d"hidden"][name\x3d"isAmazonApp"]').val():
0,f=m();"string"===typeof a?(a=a+"\x26ajaxResponse\x3d1\x26currentPage\x3d"+f,-1===c.search("fromAnywhere")&&-1===a.search("fromAnywhere")&&(a=a+"\x26fromAnywhere\x3d"+d),e&&(a+="\x26isAmazonApp\x3d1")):(a.ajaxResponse=1,a.currentPage=f,-1===c.search("fromAnywhere")&&(a.fromAnywhere=d),e&&(a.isAmazonApp=1),b&&b.isAddCardAndContinueEnabled&&(a.isHideSpinnerDisabled=!0));return a}function e(){t&&t.abort("abort-for-cleanup");t=null}function f(a,c,b,d){a=a&&a.status;c="timeout"===c?"pay-ajax-timeout":
"abort"===c?"pay-ajax-abort":"abort-for-cleanup"===c?"pay-ajax-abort-for-cleanup":"parsererror"===c?"pay-ajax-parsererror":500===a?"pay-ajax-500":"unknown"===a?"pay-unknown-page":"pay-ajax-error";b&&(b=-1===b.lastIndexOf(".html?")?b+("?ref\x3d"+c):b+("\x26ref\x3d"+c),h(b,d))}function m(){var a;l.each(w,function(c,b){if(b.pageId&&l(b.pageId).is(":visible"))return a=c,!1});return a}function d(a){(a=w[a]&&w[a].componentId)&&q.when(a).execute(function(a){a.init&&a.init()})}function n(a,c,e,h,n){n&&n.suppressSpinner||
g.show();n={contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",data:b(c,a,h),dataType:"text",timeout:r,type:"POST",url:a,beforeSend:function(a,c){e&&e.beforeHandler&&e.beforeHandler(a,c)},complete:function(a,b){e&&e.completeHandler&&e.completeHandler(a,b);c&&c.isHideSpinnerDisabled||g.hide()},error:function(b,d){e&&e.errorHandler?e.errorHandler(b,d):f(b,d,a,c)},success:function(b,h,l){var g=l.getResponseHeader("x-amz-checkout-pay-page-name");if(g){var n=l.getResponseHeader("x-amz-checkout-pay-page-title");
n&&z.pageTitle.text(decodeURIComponent(n));e&&e.successHandler?e.successHandler(b,h,l):z.pageContainer.html(b);d(g)}else f(null,"unknown",a,c)}};l.extend(n,h);t=l.ajax(n)}function h(a,c,b){var d=l("#tempForm",z.pageContainer);0<d.length&&d.remove();d=l('\x3cform method\x3d"post"\x3e\x3c/form\x3e');d.attr("action",a);b&&b.target&&d.attr("target",b.target);if("string"===typeof c)for(a=c.split("\x26"),c=0;c<a.length;c++)b=a[c].split("\x3d"),2===b.length&&"ajaxResponse"!==b[0]&&(b=l('\x3cinput type\x3d"hidden"/\x3e').attr("name",
b[0]).val(b[1]),d.append(b));else for(var e in c)"ajaxResponse"!==e&&d.append(l('\x3cinput type\x3d"hidden"/\x3e').attr("name",e).val(c[e]));z.pageContainer.append(d);d.submit()}function c(a,c,e,h,n){n&&n.suppressSpinner||g.show();n={contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",data:b(c,a,h),dataType:"text",timeout:r,type:"POST",url:a,complete:function(a,c){e&&e.completeHandler&&e.completeHandler(a,c);g.hide()},error:function(b,d){e&&e.errorHandler?e.errorHandler(b,d):f(b,d,
a,c)},success:function(a,c,b){var f=b.getResponseHeader("x-amz-checkout-pay-page-name");if(!f&&e&&e.pageUpdater)e.pageUpdater(a);else{var h=b.getResponseHeader("x-amz-checkout-pay-page-title");h&&z.pageTitle.text(decodeURIComponent(h));e&&e.successHandler?e.successHandler(a,c,b):z.pageContainer.html(a);d(f)}}};l.extend(n,h);t=l.ajax(n)}var l=a.$,t=null,w={main:{componentId:"page-main",pageId:"#select-payments-view"},"credit-card-rewards":{componentId:"page-rewards",pageId:"#select-payment-rewards-view"},
"financial-offer":{componentId:"page-financial-offer",pageId:"#select-payment-financial-offer-view"},"new-payment-methods":{pageId:"#new-payments-view"},"gil-estimates":{pageId:"#gil-estimates-subpage"}},z={},v={cvvHelper:"div#cvv-help-popover",fromAnywhereField:"input[name\x3dfromAnywhere]",jppoints:"div#jppoints",pageContainer:"div#page-container",pageTitle:"head title"},A=!0,r;return k.mergeFrom({decodeJSonResponse:function(a){var c=new RegExp(String.fromCharCode(65340),"g"),b=new RegExp(String.fromCharCode(92,
92,92,92),"g");a=a.replace(c,String.fromCharCode(92),"g");a=a.replace(b,String.fromCharCode(92));a=a.replace(/\\1/g,String.fromCharCode(34));return a=a.replace(/\\2/g,String.fromCharCode(10))},elements:z,getCurrentPage:function(){return z.pageContainer.children("div.page").filter(":visible")},getCurrentPageName:m,getPageId:function(a){a=a.getResponseHeader("x-amz-checkout-pay-page-name");return w[a]&&w[a].pageId},handleForm:function(a,c,b){a.$event.preventDefault();n(a.data.action,a.$target.serialize(),
{successHandler:function(a,b,d){c(a,b,d)}},b)},submitFormRequest:h,init:function(){k.isMobileCX()&&(p.onbeforeunload=e,k.refreshElements(z,v),r=parseInt(l("input[type\x3d'hidden'][name\x3d'paypageTimeoutValue']").val(),10),r=isNaN(r)?1E4:r,A&&(A=!1,l("div.pay-mobile").bind("keypress",function(a){k.prop("activeGoElement",13===a.keyCode?document.activeElement:null,!0)})))},makeAjaxCall:n,handleAjaxError:f,pages:w,handlePaymentsPortalForm:function(a,c,b,d){a=k.processSubmissionParameters(a.submissionParameters);
n(c,a,b,d)},handlePaymentsPortalRedeemClaimCodeTransition:function(a,b,d,e){a=k.processSubmissionParameters(a.submissionParameters);a.embedOnlyData=1;c(b,a,d,e)}},k)});"use strict";q.when("page-detector","pay-desktop-util","pay-mobile-util").register("pay-common-util",function(a,k,g){return a.isMobile()?g:k});"use strict";q.when("A","pay-common-util","pay-rewards-currency","checkout-federation-wrapper","safe-apx-helper","weblab-helper").register("pay-validator",function(a,k,g,b,e,f){function m(){function a(c,
b,d,e){R.push({identifier:c,priority:d||100,target:b,isPincodeError:e})}function l(a){if(!a)return null;var c=new RegExp(String.fromCharCode(32),"g"),b=new RegExp(String.fromCharCode(45),"g");return a.replace(c,"").replace(b,"")}function m(){return 0<R.length}function w(a){if(!a||0===a.length)return!1;for(var c=0,b=!1,d=a.length-1;0<=d;--d){var e=a.charAt(d);b&&(e*=2,9<e&&(e-=9));c+=parseInt(e,10);b=!b}return 0===c%10}function z(a,c){return a&&a.match(/^[0-9]+$/)&&a.length===c}function v(a,c,b){return a&&
a.match(/^[0-9A-Za-z]+$/)&&a.length>=c&&a.length<=b}function A(a,c){if(!a||!c)return!1;a=parseInt(a,10);c=parseInt(c,10);return r(a,c)}function r(a,c){var b=new Date,d=b.getFullYear();return c>d||c===d&&a>=b.getMonth()+1}function u(a){a=a.val();return!a||0===a.length}function p(){var b=d("#pm_pay_by_check").is(":checked"),e=d("#existing-balance [paymentmethodid\x3d'availablebalance'] input").is(":checked");b&&e&&a("continue_BadCombinationCheckExistingBalance")}function x(b){if(d("#jppoints").length){var e,
f=!1;1===b.length&&"jppoints"===b.attr("id")?(e=b,f=!0):e=b.filter("#jppoints");if(e&&e.find("#redeemPoints").is(":checked")){b=e.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val();b=parseInt(b,10);d('input[type\x3d"checkbox"][name\x3d"useAvailableBalance"]').is(":checked")&&(b-=parseInt(e.find('input[type\x3d"hidden"][name\x3d"jpPointsCustomerGCValue"]').val(),10));var h=parseInt(e.find("#redeemableAmount").text(),10),l=e.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]');
e.find("#jpPointsMax").is(":checked")?e=h:(e=parseInt(l.val(),10))||(e=0);e>h?a("continue_jpPointsExceedsRedeemableAmount",l):f&&e<b?a("continue_notEnoughJPPoints"):e>b&&a("continue_jpPointsExceedsTotalPurchase")}}}function L(b){b&&(b=b.find(".pci-blocking-cvv"),b.length&&b.is(":visible")&&a("PCI_Block_CVV"))}function D(b){var d=b.find(".currency-list");d.length&&d.is(":visible")&&(b=d.find("[type\x3dradio]:checked").val(),d=d.find("#cardCurrencyDropDown option:selected").val(),b&&("Other"!==b||"-1"!==
d&&"-2"!==d)||a("continue_SelectCardCurrency"))}function H(b){var d=b.find("#existingCvvNum");if(0!==d.length){var e=d.val();b=n?b.data("validcvvlength"):b.attr("validcvvlength");z(e,parseInt(b,10))||a("continue_BadSecurityCode",d)}}function M(b){var d=b.find('input[name\x3d"paymentMethod"]').val();/^creditCard/.test(d)&&b.find("#savedCardSuppressed").length&&a("continue_BankTemporarilyNotAvailable")}function P(b){b=b.find("#existingPincodeNum");if(0!==b.length){var d=b.val();d?v(d,4,8)||a("existingCreditCard_PincodeInvalid",
b,null,!k.isMobileCX()):a("continue_EmptyPincode",b)}}function G(b){if(b&&b.length)for(var e=0;e<b.length;e++){var f=d(b[e]);L(f.parent());H(f);P(f);"netBanking"===f.find('input[name\x3d"paymentMethod"]').val()&&(d("#netBanking_select").val(),d("#net-banking-list").find("option:selected").data("isdisabled")&&a("continue_BankTemporarilyNotAvailable"));M(f);var h=f;h.find('input[name\x3d"paymentMethod"]').val();h.find("#vdcBanksSelect").val();d("#vdcBanksSelect").find("option:selected").data("isdisabled")&&
a("continue_BankTemporarilyNotAvailable");Y(f);f=f.siblings("#upi-acceptance-input").find("#vpaCollect");if(!f||f.length)(h=f.val())&&h.match(/.+@.+/)||a("continue_BadVpaForUpi",f)}}function N(b){var d=b.find("#newMonth"),e=b.find("#newYear");b=b.find("#newExpDate");!(d=d.length&&!A(d.val(),e.val()))&&(d=b.length)&&((b=b.val())?(d=b.split("-"),b=parseInt(d[0],10),d=parseInt(d[1],10),b=r(d,b)):b=!1,d=!b);d&&a("continue_BadExpiration")}function Q(b){"domesticCards"===b.find('input[name\x3d"paymentMethod"]').val()&&
((b=b.find("select").val())&&b.match(/^[0-9]*$/)||a("continue_BlankSlate"))}function E(b){var e=d("#existing-balance input[name\x3duseFlexiblePayments]").is(":checked");b=k.getAttributeData(b,"paymentmethodtype");e&&"creditCard"!==b&&a("continue_FlexiblePaymentsNeedsCreditCard")}function F(b){"thirdPartyAccounts"===b.find('input[name\x3d"paymentMethod"]').val()&&((b=b.find("select").val())&&0!==b.length||a("continue_BlankSlate"))}function U(b){var d=b.find(".rewards-list");if(d.length&&d.find('input[type\x3d"radio"][value\x3d"rewardscustom"]').is(":checked")){b=
d.find("input.custom-rewards-input");var e=b.val();if(d.hasClass("show-currency-input-widget-new")){var d=b.data("country-code"),f=g.getCurrencyFormatByCountryCode(d),d=b.data("min"),e=g.getAmount(e,f.decimalPlace);e<d&&a("continue_BadRewardsMin")}else/^\s*$/.test(e)||isNaN(e)?a("continue_BadRewardsValue"):(e=parseFloat(b.val()),d=b.data("min"),0>=e||e<d?a("continue_BadRewardsMin"):e>b.data().max&&a("continue_BadRewardsMax"))}}function X(b){var e=b.find('input[name\x3d"paymentMethod"]').val();"verifiedCreditCard"===
e?a("continue_BlankSlate"):"verifiedDebitCard"===e&&(e=b.find("#vdcBanksSelect").val(),(""===e||"OtherBanks"===e||"1"===d("#save_citi_card").val()&&"CIT"===e)&&a("continue_BlankSlate"),b.find("option:selected").prop("disabled")&&a("continue_BankTemporarilyNotAvailable"))}function aa(b){"cashOnDeliveryCash"===b.find('input[name\x3d"paymentMethod"]').val()&&b.find(".phonenumberNotVerified").length&&a("continue_OTPforCOD")}function Z(b){if("netBanking"===b.find('input[name\x3d"paymentMethod"]').val()){var d=
b.find("#net-banking-select-list").val();b=b.find("option:selected").prop("disabled");""===d&&a("continue_BlankSlate");b&&a("continue_BankTemporarilyNotAvailable")}}function ga(b){"morePaymentMethod"===b.find('input[name\x3d"paymentMethod"]').val()&&""===b.find("#more-payment-methods-select-list").val()&&a("continue_BlankSlate")}function Y(b){var e=b.find('input[name\x3d"paymentMethod"]').val();if("StandaloneInstallment"===e||"StandaloneCreditCardInstallment"===e||"StandaloneReusableCreditLineInstallment"===
e)b.find('input[name\x3d"gilShowContinueBlocker"]').val()&&("StandaloneCreditCardInstallment"===e?a("continue_GilCCContinueError"):"StandaloneReusableCreditLineInstallment"===e?a("continue_GilRCLContinueError"):a("continue_GilContinueError")),b.find('input[name\x3d"showIneligibleItemSubpage"]').val()&&("StandaloneCreditCardInstallment"===e?a("continue_GilCCContinueErrorIneligibleItems"):"StandaloneReusableCreditLineInstallment"===e?a("continue_GilRCLContinueErrorIneligibleItems"):a("continue_GilContinueErrorIneligibleItems")),
b.find('input[name\x3d"gilShowContinueBlockerIfPromotions"]').val()&&0<d("#existing-balance input[name\x3duseAvailableBalance]:checked").length&&("StandaloneCreditCardInstallment"===e?a("continue_GilCCContinueErrorPromotions"):"StandaloneReusableCreditLineInstallment"===e?a("continue_GilRCLContinueErrorPromotions"):a("continue_GilContinueErrorPromotions"))}var R=[],ba=null,ha=null,y=function(a){h=a};h||(k.isMobileCX()?q.when("rewards-section-mobile").execute(y):q.when("rewards-section-desktop").execute(y));
return{displayErrors:function(a,c){(ba=a)&&ba.hide().find(".error-message").hide().addClass("hidden");(ha=c)&&ha.find(".a-form-error").removeClass("a-form-error");if(m()){for(a=0;a<R.length;a++){c=R[a];if(c.target){var b=c.target.parent();b.hasClass("a-input-text-wrapper")&&!b.hasClass("a-form-error")?b.addClass("a-form-error"):c.target.hasClass("a-form-error")||c.target.addClass("a-form-error")}c=c.identifier;(ba&&ba.length?ba.find("#"+c):d("#"+c)).show().removeClass("hidden")}ba&&ba.length&&ba.show()}},
getHighestErrorId:function(){for(var a={priority:100},c=0;c<R.length;c++){var b=R[c],e;(e=b.identifier)?(e=ba&&ba.length?ba.find("#"+e):d("#"+e),e=parseInt(k.getAttributeData(e,"priority"),10),e=isNaN(e)?100:e):e=100;e<=a.priority&&(a={identifier:b.identifier,priority:e,isPincodeError:b.isPincodeError,target:b.target})}return a},hasErrors:m,isValidCardCVV:z,isValidCardPincode:v,validateBankAccountNum:function(b,d){u(b)&&a("addBankAccount_NoAccountNumber",d)},validateBankAccountNumConfirm:function(b,
d,e){b.val()!==d.val()&&a("addBankAccount_AccountNumberMismatch",e)},validateBankDriverLicense:function(b,d){u(b)&&a("addBankAccount_NoDLNumber",d)},validateBankDriverLicenseState:function(b,d){b.val()!==C&&""!==b.val()&&"0"!==b.val()||a("addBankAccount_NoDLState",d)},validateBankHolderName:function(b,d){u(b)&&a("addBankAccount_NoName",d)},validateBankRoutingNum:function(b,d){9!==b.val().length&&a("addBankAccount_ShortRoutingNumber",d)},validateCreditCardCVV2:function(b,d,e){e="true"===b.attr("isaddresschallenge")?
b.attr("issuer"):e&&e.charAt(0);"R"!==e&&(b=b.val(),z(b,"A"===e?4:3)||a("addCreditCard_BadSecurityCode",d))},validateCreditCardDate:function(b,d,e,f){A(b.val(),e.val())||(a("addCreditCard_BadExpiration",d),a("addCreditCard_BadExpiration",f))},validateCreditCardMobile:function(b,d){b=b.val();f.isUpdateMobileNumberEnabled()?b&&b.replace(/[^0-9]/g,"").match(/^1[0-9]{10}$/)||a("addCreditCard_BadMobileNumber",d):b&&b.replace(/[^0-9]/g,"").match(/^1[34578]{1}[0-9]{9}$/)||a("addCreditCard_BadMobileNumber",
d)},validateCreditCardPincode:function(b,d){(b=b.val())&&b.match(/^[a-zA-Z0-9]{4,8}$/)||a("addCreditCard_BadPincode",d)},validateCreditCardName:function(b,d){u(b)&&a("addCreditCard_NoName",d)},validateCreditCardNumber:function(b,e){var f=l(b.val());f&&10<f.length&&w(f)||a("addCreditCard_BadNumber",e);f=d("#creditCardIssuersBlocked").val();b=b.data("issuer");f&&""!==f&&b&&""!==b&&-1<d.inArray(b,f.split(","))&&a("addCreditCard_IssuerUnsupported",e)},validateSBIMaestroCardNumberLength:function(b,d){19!==
l(b.val()).length&&a("addCreditCard_SBIMaestro_BadNumberLength",d)},isAMEXCreditCard:function(a){a=l(a.val());return null!==a?0===a.indexOf("37")||0===a.indexOf("34"):!1},validateCreditCardTail:function(b,d){var e=l(b.val());e&&10<e.length&&w(e)?(b=(k.isMobileCX()&&n?b.parent().data():b.data()).tail+"",e.substr(e.length-b.length)!==b&&a("addCreditCard_NotMatch",d)):a("addCreditCard_NotMatch",d)},validateCreditCardType:function(b,d){b.is(":visible")&&((b=b.val())&&b.match(/^[A-Z][0-9]*$/)||a("addCreditCard_NoType",
d))},validateRegistrationResult:function(b){b.cardStatus?1===b.checkStatusCount&&a("addCreditCard_RegisterFailed"):0<b.errors.length&&a("addCreditCard_RegisterFailed")},validateDirectDebitAccountName:function(b,d){u(b)&&a("addDirectDebit_NoAccountOwnerName",d)},validateDirectDebitAccountNum:function(b,d){u(b)&&a("addDirectDebit_NoAccountNumber",d)},validateDirectDebitRoutingNum:function(b,d){u(b)&&a("addDirectDebit_NoRoutingNumber",d)},validateInvoiceFirstName:function(b,d){u(b)&&a("addInvoiceAccount_NoFirstName",
d)},validateInvoiceLastName:function(b,d){u(b)&&a("addInvoiceAccount_NoLastName",d)},validateLocName:function(b,d){u(b)&&a("addLoc_NoName",d)},validateLocNumber:function(b,d){u(b)&&a("addLoc_BadNumber",d)},validateNewGiftPromotion:function(b,d){u(b)&&a("addGiftCardOrPromo_NoCode",d)},validatePayment:function(e){if(k.isMobileCX())G(e),h&&b.wrap(function(){h.validatePaymentRewardsInRewardsSection(a)},"shopwithpointsmobile");else if(p(),e&&e.length){for(var f=0;f<e.length;f++){var l=d(e[f]);"true"===
k.getAttributeData(l,"isaddresschallenge")&&a("continue_AddressChallenge");"true"===k.getAttributeData(l,"isverifiedfail")&&a("continue_VerifiedFail");"true"===k.getAttributeData(l,"iscupcardexpired")&&a("continue_CUPExpired");L(l);D(l);H(l);P(l);N(l);Q(l);E(l);F(l);U(l);X(l);Z(l);ga(l);Y(l);aa(l);M(l)}h&&b.wrap(function(){h.validatePaymentRewardsInRewardsSection(a)},"shopwithpoints");x(e)}else a("continue_BlankSlate")},validateGetCreditCardTypeResult:function(b){if(b.errors&&0<b.errors.length)for(var d=
0;d<b.errors.length;d++)a(b.errors[d])},validateEMIMenuForContinueButton:function(b){var d=b.find("#emiPaymentMethodsSelectList").find("option:selected").val();if("CreditCard"===d||"SelectOption"===d)a("continue_BlankSlate");else if(d=d.split("."),1<d.length){var e=d[0];if("emiCreditCard"===e||"netbankingEMI"===e)b=b.find("."+d[1]),b=b.find(".emiMenuTenuresDropDown"),b.length&&!b.find("option:selected").val()&&a("continue_BlankSlate")}},apxValidatePayment:function(a,b){var c=e.get("payselect");c&&
c.validatePayments(this,b,a)},addError:a,errors:R,validatePCICVVBlock:L}}var d=a.$,n=p.P&&p.P.AUI_BUILD_DATE,h=C;return{create:function(){return new m}}});"use strict";q.when("A","ajax-utility","pay-common-util","pay-validator").register("pay-credit-card",function(a,k,g,b){function e(a,b,c,d){a&&a.length&&(b=c+"-"+b,(c=g.prop(b))&&(a=a.find(d).val(c))&&a.length&&(g.isMobileCX()?a.closest(".card-cvv-field").hide().data("isHidden",1):a.closest(".a-column").hide(),g.prop(b,C)))}var f=a.$,m={cc:!1,vcc:!1,
vdc:!1},d=p.P&&p.P.AUI_BUILD_DATE;return{confirmCreditCard:function(a,b,c){a.currentPaymentInstrumentID=a.paymentmethodid;a.recommendedPaymentMethodId=a.paymentmethodid;if(a.newMonth&&a.newYear)a.month=a.newMonth,a.year=a.newYear;else if(a.newExpDate){var d=a.newExpDate.split("-");a.year=parseInt(d[0],10);a.month=parseInt(d[1],10)}else a.expmonth&&a.expyear&&(a.month=a.expmonth,a.year=a.expyear);(d="existingCvvNum"in a?a.addCreditCardVerificationNumber=a.existingCvvNum:a.addCreditCardVerificationNumber)&&
g.prop("cvv-"+a.paymentmethodid,d);(d="existingPincodeNum"in a?a.addCreditCardPincode=a.existingPincodeNum:a.addCreditCardPincode)&&g.prop("pincode-"+a.paymentmethodid,d);g.makeAjaxCall(c,a,{successHandler:b,errorHandler:function(b,c){a.handler="confirm-credit-card";g.handleAjaxError(b,c,"/gp/buy/payselect/handlers/submit.html",a)}},{useSif:!0})},handleCreditCardType:function(a,d){var c=a.$target,e=a.data.type,f=b.create();a.$currentTarget.data("issuer","");f.validateCreditCardNumber(c,c);f.hasErrors()||
(m[e]=!0,g.makeAjaxCall(a.data.url,{addCreditCardNumber:c.val(),returnjson:1},{completeHandler:function(){m[e]=!1},successHandler:function(b){b=k.jsonify(b);d(b,e);a.$currentTarget.data("issuer",b.issuer)}},{useSif:!0},{suppressSpinner:!0}))},isWaitingForType:function(a){return m[a]},runConfirmCardValidator:function(a,d){var c=a.find("#existingCvvNum"),c=c.length?c:a.find("#addCreditCardVerificationNumber"),e=a.find("#addCreditCardNumber"),f=a.find("#newMonth"),g=a.find("#newYear"),k=b.create();k.validateCreditCardTail(e,
e);f.length&&g.length&&k.validateCreditCardDate(f,f.closest(".card-date").find(".a-button"),g,g.closest(".card-date").find(".a-button"));c.length&&(e=(e=a.find("#issuer"))&&e.val(),k.validateCreditCardCVV2(c,c,e));k.displayErrors(d,a);return k.hasErrors()},setDateSelectorStatus:function(a,b){var c=b.find(".card-date").find("select");c&&c.length&&q.when("a-dropdown").execute(function(b){c.each(function(){var c=f(this).attr("id");b.updateSelect(c,{status:"21"===a.brand&&"G"===a.issuer?"disabled":"enabled"})})})},
setNewCardCVVInputStatus:function(a){(g.prop("cvv-newcard")||g.prop("pincode-newcard"))&&a.each(function(){var a=f(this);if("1"===(d?a.data("isnewcard")+"":a.attr("isnewcard")))return e(a,"newcard","cvv","#existingCvvNum"),e(a,"newcard","pincode","#existingPincodeNum"),!1})},setCardPasswordInputStatus:e}});"use strict";q.when("A","ajax-utility","pay-common-util","pay-validator","page-transition-controller","page-conductor","pay-credit-card").register("pay-credit-card-reregistration",function(a,k,
g,b,e,f,m){function d(a,d){var e=b.create(),f=h("#cupMobileNumber-"+a),g=h("#cupSecurityCode-"+a),k=h("#reRegisterCCErrors-"+a);a=h("#reRegisterCCInputs-"+a);e.validateCreditCardCVV2(g,g,d);e.validateCreditCardMobile(f,f);e.displayErrors(k,a);return e.hasErrors()}function n(a,b,d){f.ajaxUpdatePage(a,b,d)}var h=a.$;return{actionReregisterCardInBox:function(a){a.$event.preventDefault();e.show();var b=a.data.type,f=h("#cupMobileNumber-"+a.data.paymentMethodID).val(),w=h("#cupSecurityCode-"+a.data.paymentMethodID).val();
d(a.data.paymentMethodID,b)?e.hide():(b={isReregistering:a.data.isReregistering,currentPaymentInstrumentID:a.data.paymentMethodID,name:a.data.holderName,year:a.data.expiredYear,month:a.data.expiredMonth,addCreditCardMobileNumber:f,addCreditCardVerificationNumber:w},f={useSif:g.isMobileCX()?!0:!1,success:function(a,b,c){a=k.jsonify(a);b=h("#reRegisterCCErrors-"+a.paymentInstrumentId);m.waitForCreditCardStatus(a,n,b)}},a.$event.preventDefault(),g.makeAjaxCall(a.data.url,b,null,f))}}});"use strict";
q.when("A","client-side-metrics","ajax-utility","pay-common-util","pay-validator","existing-payments","page-conductor","checkout-modal-popover","page-transition-controller","pay-credit-card","pay-gil","new-verified-debit-card","emi-helper").register("new-payments",function(a,k,g,b,e,f,m,d,n,h,c,l,t){function w(a){a.$event.preventDefault();var c=a.data.type;if(h.isWaitingForType(c))n.show(),setTimeout(function(){w(a)},50);else{var d;d="vdc"===c?W.newVDC:"emi"===c?W.newEMI:W.newVCC;if(da(d,c))n.hide();
else{n.show();var e=b.getInputValues(d),f="vdc"===c?"_VDC":"_VCC";d=e["addCreditCardVerificationNumber"+f];var g=e["addCreditCardPincode"+f],c={addCreditCardNumber:e["addCreditCardNumber"+f],addCreditCardVerificationNumber:d,addCreditCardPincode:g,handler:e["handler"+f],month:e["month"+f],name:e["name"+f],newPaymentType:c,year:e["year"+f],cctype:e["cctype"+f],isSBIInternationalMaestroSelected:e["isSBIInternationalMaestroSelected"+f],isCardSavedFromEMIMenu:e["isCardSavedFromEMIMenu"+f]};b.prop("cvv-newcard",
d);g&&b.prop("pincode-newcard",g);b.makeAjaxCall(a.data.url,c,{successHandler:function(a,b,c){H(a,b,c);h.setNewCardCVVInputStatus(W.paymentRows)}},{useSif:!0})}}}function z(a){a.$event.preventDefault();var c=a.data.type;if(h.isWaitingForType(c))n.show(),setTimeout(function(){z(a)},50);else{var d=W.newCCFormContent;if(da(d,c))n.hide();else{n.show();c=b.getInputValues(d);c.handler=c.handler_addCCInBox;var d=a.data.url,e={};O("#cupSecurityCode").is(":visible")&&O("#cupMobileNumber").is(":visible")?(d=
"/gp/buy/payselect/handlers/add-credit-card.html",e={successHandler:function(a){a=g.jsonify(a);P(a)}}):e={successHandler:H};b.makeAjaxCall(d,c,e,{useSif:!0})}}}function v(a){a.$event.preventDefault();var c=O("#new-giftcard-promotion"),c=b.getInputValues(c);O("input[name\x3disUnifiedActionsDesignEnabled]").length&&A(a)||(c.handler=c.handler_addGCInBox,a=a.data.url,n.show(),b.makeAjaxCall(a,c,{successHandler:function(a,c,d){m.ajaxUpdatePage(a,c,d);sa||b.scrollTopTo(O("#existing-balance"))}},{useSif:!0}))}
function A(a){a=a.$declarativeParent;var b=O("#gcpromoinput"),c=e.create();c.validateNewGiftPromotion(b,b);c.displayErrors(W.newGCErrors,a);return c.hasErrors()}function r(a){var b=O(a.currentTarget).parents("div.new-payment-line").find(".card-date select");if(b&&b.length){var c=O(a.currentTarget).val();q.when("a-dropdown").execute(function(a){b.each(function(){var b=O(this).attr("id");a.updateSelect(b,{status:"G21"===c?"disabled":"enabled"})})})}}function u(a){var b=W.newVDC.find(".vdc-form-fields"),
c=W.newVDC.find("#vdc-logo-prompt"),d=W.newVDC.find(".top-cell");a?b.show():b.hide();a?c.show():c.hide();a?d.addClass():d.removeClass()}function p(a){var b=O(a.currentTarget).val(),c=W.newVDC.find("#suppressedVerifiedDebitCard").hide(),d=W.newVDC.find(".vdc-selected-bank-prompt").hide();u(!1);var e="1"===W.newVDC.find("#isRupayAsSavedCardEnabled").val()&&"URP"===b;"OtherBanks"===b||"1"===O("#save_citi_card").val()&&"CIT"===b||e?(u(!0),O.isEmptyObject(l)||l.showExpiryDateAndCvv()):"SMP"!==b||O.isEmptyObject(l)?
""!==b&&(b=O(a.currentTarget).find("option:selected").prop("disabled"),a=O(a.currentTarget).find("option:selected").text(),b?c.show().find(".suppressed-card-text").html(a):d.show().find(".bank-name-text").html(a)):(u(!0),l.hideExpiryDateAndCvv())}function x(a,b){if(!O.isEmptyObject(t)&&a)return a(b)}function L(a){x(t.removeEMIMenuSelectionAttributes);W.newEMI.find(".emi-group").hide();a=O(a.currentTarget).find("option:selected").val();W.newEMI.find("#emiMenuErrors_VCC").length&&W.newEMI.find("#emiMenuErrors_VCC").hide();
if(a=x(t.showPaymentOptionBlock,a))x(t.addEMIMenuSelectionAttributes),a.show()}function D(a){h.handleCreditCardType(a,na)}function H(a,c,d){m.ajaxUpdatePage(a,c,d);sa||b.scrollTopTo(f.getSelectedPayment())}function M(a){a.$event.preventDefault();var c=a.data.type;h.isWaitingForType(c)?(n.show(),setTimeout(function(){M(a)},50)):da(a.$declarativeParent,c)?n.hide():(la&&la.hide(),S&&S.hide(),n.show(),O("#cupSecurityCode").is(":visible")&&O("#cupMobileNumber").is(":visible")?(c=a.$declarativeParent.serializeArray(),
c=b.processSubmissionParameters(c),b.makeAjaxCall("/gp/buy/payselect/handlers/add-credit-card.html",c,{successHandler:function(a){a=g.jsonify(a);P(a)}},{useSif:!0})):b.handleForm(a,{successHandler:H},{useSif:!0}))}function P(a){var c={};c.paymentInstrumentId=a.paymentInstrumentId;a.checkStatusCount&&(c.checkStatusCount=a.checkStatusCount);var d={successHandler:function(a){a=g.jsonify(a);var c=e.create();"VERIFIED"===a.cardStatus?b.makeAjaxCall("/gp/buy/payselect/handlers/submit.html",{newPaymentMethodId:a.paymentInstrumentId},
{successHandler:H}):"PENDING"===a.cardStatus?(a.checkStatusCount?(a.checkStatusCount=parseInt(a.checkStatusCount,10),isNaN(a.checkStatusCount)&&(a.checkStatusCount=1)):a.checkStatusCount=3,c.validateRegistrationResult(a),1===a.checkStatusCount?(n.hide(),c.displayErrors(W.newCCErrors)):(--a.checkStatusCount,P(a))):(c.validateRegistrationResult(a),n.hide(),c.displayErrors(W.newCCErrors))}};setTimeout(function(){b.makeAjaxCall("/gp/buy/payselect/handlers/check-credit-card-status.html",c,d)},2500)}function G(a){a.$event.preventDefault();
var c=a.$declarativeParent,d=c.find("#loc-name"),f=c.find("#loc-number"),h=e.create();h.validateLocName(d,d);h.validateLocNumber(f,f);h.displayErrors(c.find("#error-box-new-loc"),c);h.hasErrors()||(qa&&qa.hide(),n.show(),b.handleForm(a,{successHandler:H}))}function C(a){a.$event.preventDefault();var c=a.$declarativeParent,d=c.find("#gcpromoinput");c.find("#gcpromosuccessblock").hide();var f=e.create();f.validateNewGiftPromotion(d,d);f.displayErrors(W.newGCErrors,c);f.hasErrors()||(n.show(),b.handleForm(a,
{successHandler:function(a,c,d){m.ajaxUpdatePage(a,c,d);sa?W.newGCErrors.is(":visible")&&O("#gc-link-expander").trigger("click"):b.scrollTopTo(O("#existing-balance"))}}))}function Q(a){a.$event.preventDefault();O("#ccAddCard").trigger("submit")}function E(a){a.$event.preventDefault();O("#bank-address-popover-submit").trigger("submit")}function F(a){a.$event.preventDefault();O("#direct-debit-popover-submit").trigger("submit")}function U(a){a.$event.preventDefault();O("#new-loc-popover-submit").trigger("submit")}
function X(a){a.$event.preventDefault();O("#new-invoice-popover-submit").trigger("submit")}function aa(a){a.$event.preventDefault();O("#brdcAddCard").trigger("submit")}function Z(a){a.$event.preventDefault();var c=a.$declarativeParent,d=e.create(),f=c.find("#bank-name"),h=c.find("#bank-routing-number"),g=c.find("#bank-account-number"),l=c.find("#bank-account-number-confirm"),k=c.find("#bank-dl"),r=c.find("#bank-dl-state");d.validateBankHolderName(f,f);d.validateBankRoutingNum(h,h);d.validateBankAccountNum(g,
g);d.validateBankAccountNumConfirm(g,l,l);d.validateBankDriverLicense(k,k);d.validateBankDriverLicenseState(r,r.parents("div.a-button-dropdown"));d.displayErrors(c.find("#new-bank-error-box"),c);d.hasErrors()||(ka&&ka.hide(),n.show(),b.handleForm(a,{successHandler:H}))}function ga(a){a.$event.preventDefault();var c=a.$declarativeParent,d=e.create(),f=c.find("#debit-bank-routing-number"),h=c.find("#debit-account-number"),g=c.find("#debit-account-name");d.validateDirectDebitRoutingNum(f,f);d.validateDirectDebitAccountNum(h,
h);d.validateDirectDebitAccountName(g,g);d.displayErrors(c.find("#new-direct-debit-error"),c);d.hasErrors()||(ca&&ca.hide(),n.show(),b.handleForm(a,{successHandler:H}))}function Y(a){a.$event.preventDefault();var c=a.$declarativeParent,d=e.create(),f=c.find("#invoice-first-name"),h=c.find("#invoice-last-name");d.validateInvoiceFirstName(f,f);d.validateInvoiceLastName(h,h);d.displayErrors(c.find("#new-invoice-error-box"),c);d.hasErrors()||(va&&va.hide(),n.show(),b.handleForm(a,{successHandler:H}))}
function R(a){a=O("#order-summary-total");var c=O("#order-summary-container");a.prev().addClass("a-first");c.addClass("a-box-group");a.show();b.isTouchCX()&&c.parent().find(".bottom-order-summary").show();W.newCCFormContent.is(":visible")||O("#wrapper-new-cc").find("a.a-link-expander").trigger("click");O("#ecard-help-link").show()}function ba(a){var c="Unknown";b.isDesktopCX()?c="Desktop":b.isMobileCX()?c="Mobile":b.isTouchCX()&&(c="Tablet");k.increaseCount("PayPage-ClientSide-AddCupClick-"+c,1);
c=O("#cupForm");if(0<c.length)c.submit();else{var d=O("\x3cform\x3e\x3c/form\x3e");d.attr({target:"_blank",method:"POST",action:a.data.url});O("#cup-dc").find("input").each(function(){var a=O(this);"hidden"===a.attr("type")&&a.clone().appendTo(d)});O("body").append(d);d.submit();d.remove()}}function ha(c){var e=c.$target.closest(".a-popover"),f=e.data("a-popover-id");d.hideById(f);e.hide();O("#a-popover-modal").hide();n.show();b.makeAjaxCall(c.data.url,void 0,{successHandler:function(b){O("#existing-payment-methods").replaceWith(O(b).find("#existing-payment-methods"));
a.trigger("checkout:reload:payselect");n.hide()}})}function y(a){a.$event.preventDefault();a=a.data;n.show();c.submitNewGilPayment(a.subtype)}function ea(){if(!b.isMobileCX()){0===O("#form-add-credit-card").length&&(O("#ccAddCard").parents("div.cc-submit").hide(),O("#ccAddCardWithButton").parents("div.cc-submit").show());O("html").hasClass("a-ie6")&&(O("#cup-mbdc").show(),O(".mbdc-link").attr("data-action","redirect-cup"));W=b.getElements(Ba);W.bankNumberConfirm.show();W.newVDC.find(".payment-row").data("hasstatus")||
W.newVDC.find(".vdc-form-fields").hide();W.newVDC.find("#suppressedVerifiedDebitCard").hide();W.newCCFormContent.find(".cup-card-field").hide();W.newPayments.find("#cupInfoMessage").hide();W.newPayments.find("#use-ecard-link").show();W.newPayments.find(".mbdc-link").show();W.newPayments.find(".mbdc-button").hide();sa=!1;W.newPayments.each(function(){var a=O(this),c=a.data();c&&0===c.hasstatus?(a.find("a.a-link-expander i.js-hide").remove(),a.find("a.a-link-section-expander i.js-hide").remove()):c&&
1===c.hasstatus&&!sa&&(b.scrollTopTo(a),sa=!0)});var c=W.newVCC.find("#requireCVVOrPincode");c&&c.length&&c.val("1");ra&&(a.declarative("new-cc",["submit"],M),a.declarative("new-brdc",["submit"],M),a.declarative("new-loc",["submit"],G),a.declarative("show-card-image",["change"],D),a.declarative("new-giftcard-promotion",["submit"],C),a.declarative("new-verified-card",["click"],w),a.declarative("new-cc-in-dashboard",["click"],z),a.declarative("new-gc-in-dashboard",["click"],v),a.declarative("add-bank-account",
["submit"],Z),a.declarative("add-direct-debit",["submit"],ga),a.declarative("add-invoice",["submit"],Y),a.declarative("show-order-summary",["click"],R),a.declarative("redirect-cup",["click"],ba),a.declarative("cup-popover-close",["click"],ha),a.declarative("add-new-debit-and-cc-popover-submit",["click"],Q),a.declarative("add-bank-account-popover-submit",["click"],E),a.declarative("add-loc-account-popover-submit",["click"],U),a.declarative("new-gil-payment",["click"],y),a.declarative("add-direct-debit-popover-submit",
["click"],F),a.declarative("add-invoice-account-popover-submit",["click"],X),a.declarative("add-new-br-debit-card-popover-submit",["click"],aa),ra=!1);W.cardTypeDropdown.unbind("change",r).bind("change",r);W.vdcBankDropdown.unbind("change",p).bind("change",p);W.emiCardsDropdown.unbind("change",L).bind("change",L);O("div.pay-desktop a.a-link-expander").unbind("keypress");O("div.pay-desktop .a-declarative, div.pay-desktop .a-button").filter("[data-action\x3da-checkout-modal-popover]").unbind("keypress");
a.on("a:popover:show:add-new-debit-cc-modal",function(a){S=a.popover});a.on("a:popover:show:add-new-bank-account-modal",function(a){ka=a.popover});a.on("a:popover:show:add-new-direct-debit-modal",function(a){ca=a.popover});a.on("a:popover:show:add-new-loc-account-modal",function(a){qa=a.popover});a.on("a:popover:show:add-invoice-account-modal",function(a){va=a.popover});a.on("a:popover:show:add-br-debit-card-modal",function(a){la=a.popover})}}function da(a,b){var c,d,f,h,g,l,k,n,r,m,u;"vcc"===b?(c=
"#vccCVVNum",b="#newVCCErrors",d="#vccMonth",f="#vccName",h="#newVerifiedCreditCardNumber",g="#vccType",l="#vccYear",k="#vccPincode",u=m=r=n=void 0):"vdc"===b?(c="#vdcCVVNum",b="#newVDCErrors",d="#vdcMonth",f="#vdcName",h="#newVerifiedDebitCardNumber",g="#vdcType",l="#vdcYear",n="#isSBIMaestroAsSavedCardEnabled",r="#isSBIInternationalMaestroSelected",u=m=k=void 0):"emi"===b?(c="#vccCVVNum",b="#newEMIErrors",d="#vccMonth",f="#vccName",h="#newVerifiedCreditCardNumber",g="#vccType",l="#vccYear",k="#vccPincode",
u=m=r=n=void 0):"brdc"===b?(b="#newBRDCErrors",d="#brdcMonth",f="#brdcName",h="#addCreditCardNumber_BRDC",l="#brdcYear",u=m=r=n=k=g=c=void 0):(m="#cupSecurityCode",u="#cupMobileNumber",c="#ccCVVNum",b="#newCCErrors",d="#ccMonth",f="#ccName",h="#addCreditCardNumber",g="#ccType",l="#ccYear",r=n=k=void 0);c=a.find(c);m&&0===c.length&&a.find(m).is(":visible")&&(c=a.find(m));n="1"===a.find(n).val()&&"1"===a.find(r).val();f=a.find(f);h=a.find(h);u=u?a.find(u):null;d=a.find(d);g=a.find(g);l=a.find(l);var t;
k&&a.find(k).is(":visible")&&(t=a.find(k));k=g.val();r=e.create();r.validateCreditCardName(f,f);r.validateCreditCardNumber(h,h);n&&r.validateSBIMaestroCardNumberLength(h,h);n=d.parent();n=n.hasClass("a-button")?n:n.find(".a-button");f=l.parent();f=f.hasClass("a-button")?f:f.find(".a-button");"G21"!==k&&r.validateCreditCardDate(d,n,l,f);r.validateCreditCardType(g,g.closest(".card-type-field").find(".a-button"));l=k?k.substr(0,1):"";c.length&&"R"!==l&&c.is(":visible")&&r.validateCreditCardCVV2(c,c,
k);u&&u.length&&u.is(":visible")&&r.validateCreditCardMobile(u,u);t&&t.length&&r.validateCreditCardPincode(t,t);r.displayErrors(O(b),a);return r.hasErrors()}function na(a,c){if(a){"1"===a.isDebitCard?W.newCCWarnings.show().removeClass("hidden"):W.newCCWarnings.hide().addClass("hidden");if("1"===a.hasErrors){var d=e.create();d.validateGetCreditCardTypeResult(a);if(d.hasErrors()){d.displayErrors(W.newCCErrors);return}}c="vcc"===c?W.newVCC:"vdc"===c?W.newVDC:"emi"===c?W.newEMI:"brdc"===c?W.newBRDCFormContent:
W.newCCFormContent;var d=a.specificFields,f=c.find(".cup-card-field");0!==f.length&&(d&&1===d.securityCode&&1===d.mobileNumber?(b.isTouchCX()&&c.find("#addCreditCardNumber").closest(".a-input-text-wrapper").removeClass("last-child"),f.show()):f.hide());d=a.specificFields;f=c.find(".amex-field");if(0!==f.length){var g=c.find(".cvv-field");0!==g.length&&(d&&1===d.pincode?(g.hide(),f.show()):d&&0===d.pincode&&0===d.securityCode?(f.hide(),g.hide()):(f.hide(),g.show()))}d=c.find(".card-images");d.find("img").hide();
g=a.installmentProgram;f=!1;g&&(g=d.find('img[data-installmentprogram\x3d"'+g+'"]'),0!==g.length&&(g.show(),f=!0));f||(a.issuerdisplayimage?d.find("img[data-issuer\x3dATM]").attr("src",a.issuerdisplayimage).show():(f=a.issuer+a.brand,d.find("img[data-issuer\x3d"+f+"]").show(),c.find(Ba.cardTypeDropdown).val(f).trigger("change")));h.setDateSelectorStatus(a,c)}}var O=a.$,ra=!0,sa=!1,W={},Ba={bankNumberConfirm:"#wrapper-bank-account-number-confirm",btnAddCard:"#ccAddCard",btnAddLoc:"#button-new-loc",
btnAddGC:"#button-add-gcpromo",btnAddBank:"#button-add-bank-account",btnAddDirectDebit:"#button-add-direct-debit",btnAddInvoice:"#button-add-invoice",cardImages:"#newCreditCardImages",cardTypeDropdown:".card-type-dropdown select",newCCFormContent:"#new-cc",newBRDCFormContent:"#new-brdc",newGCErrors:"#gcpromoerrorblock",newGCFormContent:"#gc_entry",newPayments:"div.new-payment-line",newVCC:"#new-verified-credit-cards-table",newVDC:"#new-verified-debit-cards-table",newEMI:"#newEmiCard",paymentRows:"#existing-payment-methods .payment-row",
vdcBankDropdown:"#vdcBanksSelect",emiCardsDropdown:"#emiPaymentMethodsSelectList",cardList:"#existing-credit-cards-box",newCCErrors:"#newCCErrors",newCCWarnings:"#newCCWarnings"},S,ka,qa,ca,va,la;a.on("checkout:reload:payselect",ea);a.on("checkout:reload:spp-payment",ea);return{actionShowOrderSummary:R,handleFormHandlerScrollToSelected:H}});q.when("A","page-detector","client-side-metrics","ready").execute(function(a,k,g){function b(a,b,d,n){a=e(b).is(":checked");p.P&&p.P.AUI_BUILD_DATE?a?e(d).val(e(d).parent().data("account-name")):
e(d).val(""):(g.increaseCount("removeauijs8"),a?(e(n).removeClass("a-icon-touch-checkbox-inactive").addClass("a-icon-touch-checkbox-active"),e(d).val(e(d).data("account-name"))):(e(n).removeClass("a-icon-touch-checkbox-active").addClass("a-icon-touch-checkbox-inactive"),e(d).val("")));d="undefined"!==typeof p.ue&&"undefined"!==typeof p.ue.count;n=k.isMobilePayment()?"mobile":"tablet";a=e("#showNameOnCardCheckbox").is(":checked");d&&p.ue.count(n+"NameOnCardCheckBox"+(a?"Checked":"Unchecked"),1)}var e=
a.$;a.declarative("show-card-name",["click"],function(a){b(a,"#showNameOnCardCheckbox","#ccName","#showNameOnCardIcon")});a.declarative("show-br-debit-card-name",["click"],function(a){b(a,"#showNameOnCardCheckbox_BRDC","#brdcName","#showNameOnCardIcon_BRDC")})});"use strict";q.when("A").register("pay-rewards-currency",function(a){var k=function(a,b){b=Math.pow(10,b);a=a.replace(/[^0-9]/g,"");return parseFloat(a)/b},g={CA:{groupingSeparator:",",decimalSeparator:".",decimalPlace:2},DE:{groupingSeparator:".",
decimalSeparator:",",decimalPlace:2},GB:{groupingSeparator:",",decimalSeparator:".",decimalPlace:2},JP:{groupingSeparator:",",decimalSeparator:".",decimalPlace:0},US:{groupingSeparator:",",decimalSeparator:".",decimalPlace:2}},b=function(a,b,d,e,h){this.groupingSeparator=a;this.decimalSeparator=b;this.currencyDecimalPlace=d;this.pointsDecimalPlace=e;this.ratio=h;this.getCurrencyAmount=function(a){return k(a,this.currencyDecimalPlace)};this.getPointsAmount=function(a){return this.getCurrencyAmount(a)/
this.ratio};this.format=function(a,b){var d=parseInt(a,10);a=parseFloat(a-d).toFixed(b);a=this.decimalSeparator+a.slice(2);d=d.toString();b=3<d.length?d.length%3:0;d=(0<b?d.substr(0,b)+this.groupingSeparator:"")+d.substr(b).replace(/(\d{3})(?=\d)/g,"$1"+this.groupingSeparator);return a===C||a===this.decimalSeparator?d:d+a};this.formatCurrency=function(a){return this.format(a,d)};this.formatPoints=function(a){return this.format(a,e)}},e=function(b,e,d,g){this.maxAmount=g;this.rewardsFormatter=d;this.currencyElement=
b;this.pointElement=e;var h=this;this.isControlKey=function(a){switch(a.which){case 8:case 46:return!0;case 86:case 88:return a.ctrlKey;default:return!1}};this.isNavigationKey=function(a){switch(a.which){case 9:case 16:case 17:case 35:case 36:case 37:case 39:return!0;case 65:case 67:return a.ctrlKey;default:return!1}};this.isValidKey=function(a){var b=a.which;return 48<=b&&57>=b||96<=b&&105>=b||8===a.which||46===a.which};this.getCaret=function(){var a=h.currencyElement,b=a.get(0),d=0,e=0;if("number"===
typeof b.selectionStart&&"number"===typeof b.selectionEnd)d=b.selectionStart,e=b.selectionEnd;else{var f=document.selection.createRange();if(f!==C&&f.parentElement()===b){var a=a.val(),e=a.length,g=b.createTextRange();g.moveToBookmark(f.getBookmark());b=b.createTextRange();b.collapse(!1);-1<g.compareEndPoints("StartToEnd",b)?d=e:(d=-g.moveStart("character",-e),d+=a.slice(0,d).length-1,-1<g.compareEndPoints("EndToEnd",b)||(e=-g.moveEnd("character",-e),e+=a.slice(0,e).length-1))}}return{start:d,end:e}};
this.setCaret=function(a){var b=h.currencyElement.get(0);b.setSelectionRange?b.setSelectionRange(a,a):b.createTextRange&&(b=b.createTextRange(),b.collapse(!0),b.moveStart("character",a),b.moveEnd("character",a),b.select())};this.bind=function(){h.currencyElement.unbind();h.currencyElement.bind("keydown",function(a){h.isNavigationKey(a)||h.isControlKey(a)||h.isValidKey(a)||a.preventDefault()});h.currencyElement.bind("keyup",function(b){if(!h.isNavigationKey(b)){b=h.getCaret();var d=h.currencyElement.val().length;
h.format();var e=h.currencyElement.val().length;b.start===b.end&&h.setCaret(Math.min(b.start+(e-d),e));a.trigger("inlineFormatter:formattingCompleted",h)}})};this.unbind=function(){h.currencyElement.unbind("keydown keyup")};this.format=function(a){a=h.currencyElement.val();a=h.rewardsFormatter.getCurrencyAmount(a);isNaN(a)&&(a=0);a>h.maxAmount&&(a=h.maxAmount);a=h.rewardsFormatter.formatCurrency(a);h.currencyElement.val(a)}};a.on("inlineFormatter:formattingCompleted",function(a){var b=a.pointElement,
d=a.currencyElement.val(),d=a.rewardsFormatter.getPointsAmount(d);a=a.rewardsFormatter.formatPoints(Math.round(d));b.html(a)});return{getCurrencyFormatByCountryCode:function(a){(a=g[a])||(a=g["default"]);return a},getAmount:k,initializeInlineFormatting:function(f,g,d){var k=f.maxAmount;d=new b(d.groupingSeparator,d.decimalSeparator,d.decimalPlace,g.decimalPlace,g.ratio);f=new e(f.$element,g.$element,d,k);f.bind();f.format(0);a.trigger("inlineFormatter:formattingCompleted",f)}}});"use strict";q.when("A",
"pay-common-util","pay-validator","page-conductor","mobile-carrier-billing-util","weblab-helper").register("jppoints",function(a,k,g,b,e,f){function m(){!k.isMobileCX()&&p("#jppoints").length&&(x=k.getElements(L),l())}function d(){var a=x.paymentRows.find('input[type\x3d"radio"][name\x3d"paymentMethod"]');a.closest("div.payment-selected").removeClass("payment-selected");a.attr("checked",!1);k.isTouchCX()&&n(a,"radio")}function n(a,b){a.siblings("i").removeClass("a-icon-touch-"+b+"-active").addClass("a-icon-touch-"+
b+"-inactive")}function h(a,b){a.is(":disabled")||a.siblings("i").removeClass("a-icon-touch-"+b+"-inactive").addClass("a-icon-touch-"+b+"-active")}function c(){return p('input[type\x3d"radio"][name\x3d"paymentMethod"][value\x3d"availablebalance"]').is(":checked")}function l(){if(x.jppoints&&x.jppoints.length){c()&&t();x.jppoints.show();var a=x.jppoints.find("#redeemPoints");k.isTouchCX()?a.parents("label").bind("click",v):a.bind("click",v);x.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').bind("click",
function(){var a=x.jppoints.find("#jpPointsCustom");a.attr("checked",!0);var b=x.jppoints.find("#redeemPoints");b.attr("checked",!0);k.isTouchCX()&&(h(a,"radio"),n(x.jppoints.find("#jpPointsMax"),"radio"),h(b,"checkbox"))});x.jppoints.find('input[name\x3d"jpPointsUseMaxPoints"]').bind("click",w);x.jppoints.find("#jpPointsCustom").bind("click",function(){x.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').focus()});x.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').bind("keyup",
u)}}function t(){var a=x.jppoints.find("#redeemPoints"),c=x.jppoints.find('input[type\x3d"radio"][name\x3d"jpPointsUseMaxPoints"]'),d=x.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]'),e=x.jppoints.find("#redeemableAmount"),f=x.jppoints.find("#redeemableValue");a.attr("checked",!1);a.attr("disabled",!0);c.attr("checked",!1);c.attr("disabled",!0);x.jppoints.find("#jpPointsError").hide();d.val("");d.removeClass("a-form-error");d.attr("disabled",!0);f.text(x.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableValueWithGC"]').val());
e.text(x.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithGC"]').val());b.isSPP()&&(x.jppoints.find("label").addClass("disabled-color"),x.jppoints.removeClass("payment-selected"));k.isTouchCX()&&(n(a,"checkbox"),n(c,"radio"),a.siblings("i").addClass("a-button-disabled"),c.siblings("i").addClass("a-button-disabled"))}function w(b){var c=b.currentTarget,e=x.jppoints.find("#redeemPoints");e.attr("checked",!0);if(k.isTouchCX()){h(p("#"+c.id),"radio");var f;f="jpPointsMax"===c.id?x.jppoints.find("#jpPointsCustom"):
x.jppoints.find("#jpPointsMax");n(f,"radio");h(e,"checkbox")}"true"===c.value&&(x.jppoints.find("#jpPointsError").hide(),c=x.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]'),c.removeClass("a-form-error"),c.val(""),e=x.jppoints.find("#redeemableAmount"),f=parseInt(x.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsConversionRate"]').val(),10),c=parseInt(x.jppoints.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val(),10),e=parseInt(e.text(),10)*f,p('input[name\x3d"useAvailableBalance"]').is(":checked")&&
(f=x.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsCustomerGCValue"]'),c-=parseInt(f.val(),10)),e>=c&&d());q.when("installments-payselect").execute(function(c){a.trigger("installments-payselect:toggleJPPointsInstallmentEligibility",p(b.currentTarget))})}function z(a){var b=x.jppoints.find("#redeemableAmount"),c=x.jppoints.find("#redeemableValue"),e=parseInt(x.jppoints.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val(),10),f;a.is(":checked")?(a=x.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithGC"]').val(),
f=x.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableValueWithGC"]').val(),e-=parseInt(x.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsCustomerGCValue"]').val(),10)):(a=x.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithoutGC"]').val(),f=x.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableValueWithoutGC"]').val());var h=parseInt(x.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsConversionRate"]').val(),10)*a;b.text(a);c.text(f);0>=parseInt(a,10)?
(b=x.jppoints.find("#redeemPoints"),b.attr("checked",!1),c=x.jppoints.find('input[type\x3d"radio"][name\x3d"jpPointsUseMaxPoints"]'),c.attr("checked",!1),k.isTouchCX()&&(n(b,"checkbox"),n(c,"radio"))):x.jppoints.find('input[type\x3d"radio"][name\x3d"jpPointsUseMaxPoints"][value\x3d"true"]').is(":checked")?h>=e&&d():u()}function v(){var d=x.jppoints.find("#redeemPoints");if(!d.is(":disabled")){d=d.is(":checked");if(k.isTouchCX())d?(n(x.jppoints.find('input[name\x3d"jpPointsUseMaxPoints"]'),"radio"),
r()):(h(x.jppoints.find("#jpPointsMax"),"radio"),n(x.jppoints.find("#jpPointsCustom"),"radio"),A());else if(d)A(),b.isSPP()&&x.jppoints.addClass("payment-selected");else if(r(),b.isSPP()){x.jppoints.removeClass("payment-selected");if(c())return;k.selectDefaultPaymentMethodIfNotSelected()}q.when("installments-payselect").execute(function(b){a.trigger("installments-payselect:toggleJPPointsInstallmentEligibility",x.jppoints)})}}function A(){var a=x.jppoints.find("#jpPointsMax");a.attr("checked",!0);
var c=parseInt(x.jppoints.find("#redeemableAmount").text(),10),e=x.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithoutGC"]').val(),f=parseInt(x.jppoints.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val(),10);k.isTouchCX()&&(n(x.jppoints.find('input[name\x3d"jpPointsUseMaxPoints"]'),"radio"),h(a,"radio"));x.jppoints.find("#jpPointsMax").is(":checked")&&(c>=f?d():b.isSPP()&&x.paymentRows.find("#gcPromo, input[name\x3d'useAvailableBalance']").is(":checked")&&(a=x.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsCustomerGCValue"]'),
f-=parseInt(a.val(),10),e>=f&&d()))}function r(){var a=x.jppoints.find('input[name\x3d"jpPointsUseMaxPoints"]');a.attr("checked",!1);var b=x.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]');b.val("");b.removeClass("a-form-error");x.jppoints.find("#jpPointsError").hide();k.isTouchCX()&&n(a,"radio")}function u(){var b=x.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]'),c=parseInt(b.val(),10);!c||0>c?(b.val(""),x.jppoints.find("#jpPointsError").hide(),x.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').removeClass("a-form-error")):
(b.val(c),parseInt(x.jppoints.find("#redeemableAmount").text(),10)<c?(x.jppoints.find("#jpPointsError").show(),x.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').addClass("a-form-error")):(x.jppoints.find("#jpPointsError").hide(),x.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').removeClass("a-form-error"),b=parseInt(x.jppoints.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val(),10),parseInt(x.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsConversionRate"]').val(),
10),c>=b&&d(),q.when("installments-payselect").execute(function(b){a.trigger("installments-payselect:actionToggleJPPointsSection",c)})))}var p=a.$,x={},L={paymentRows:"#existing-payment-methods .payment-row",jppoints:"#jppoints",mcbPointsWarning:"#mcbPointsWarning"};a.on("checkout:reload:payselect",m);a.on("checkout:reload:spp-payment",m);return{handleJPPointsOnPaymentRows:function(a){a=p(a.currentTarget);if("jppoints"!==a.attr("id"))if("useAvailableBalance"===a.attr("name"))z(a);else{f.isMCBMultiTenderWeblabEnabled()||
e.hideMCBWarningMessageForPoints(x);var c=a.find('input[type\x3d"radio"][name\x3dpaymentMethod]');if(!f.isMCBMultiTenderWeblabEnabled()&&c.length&&0<c.filter("[value^\x3dMCB]").size())e.showMCBWarningMessageForPoints(x),t();else if("availablebalance"===a.attr("value")||a.find("#pm_300")&&"availablebalance"===a.find("#pm_300").attr("value"))t();else{a=x.jppoints.find("#redeemPoints");var c=x.jppoints.find('input[type\x3d"radio"][name\x3d"jpPointsUseMaxPoints"]'),d=x.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]'),
h=x.jppoints.find("#redeemableAmount"),g=x.jppoints.find("#redeemableValue");b.isSPP()&&x.jppoints.find("label").removeClass("disabled-color");a.attr("disabled",!1);c.attr("disabled",!1);d.attr("disabled",!1);p('#existing-balance input[type\x3d"radio"][value\x3d"availablebalance"]').length&&(h.text(x.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithoutGC"]').val()),g.text(x.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableValueWithoutGC"]').val()));k.isTouchCX()&&(a.siblings("i").removeClass("a-button-disabled"),
c.siblings("i").removeClass("a-button-disabled"))}}},handleJPPointsWithGC:z}});"use strict";q.when("A","ajax-utility","client-side-metrics","pay-common-util","pay-validator","page-transition-controller","page-conductor","a-popover-position","inline-points-register-controller","jppoints","pay-credit-card","checkout-general-utils","a-popover-base","a-dropdown","pay-rewards-currency","cache-page-data-controller","pay-credit-card-reregistration","mobile-carrier-billing-util","emi-helper","instant-bank-discount-helper",
"recommendation-helper","safe-apx-helper","apb-limit-messaging-helper").register("existing-payments",function(a,k,g,b,e,f,m,d,n,h,c,l,t,w,z,v,A,r,u,K,x,L,D){function H(){return B.paymentRows.filter(function(){return I(this).hasClass("payment-selected")||I(this).find("#redeemPoints").is(":checked")})}function M(a){f.show();a.$event.preventDefault();var c=H().find(".card-unreg-rewards").data();c.recommendedPaymentMethodId=c.paymentinstrumentid;b.makeAjaxCall(a.$target.attr("href"),c)}function P(c){c=
I(c.currentTarget);var d=c.data();if(!(0>=d.ratio)){var e=c.val()/d.ratio;if(!isNaN(e)){var f=c.val();f<d.min&&(e=0);c=b.getNumberWithSeparators(e,d.decimalplaces);H().find(".custom-reward-points").html(c);q.when("installments-payselect").execute(function(b){a.trigger("installments-payselect:actionToggleRewardsSection",f)})}}}function G(a){1===a.data.refresh&&(f.show(),b.makeAjaxCall(a.data.url))}function C(a){Da(a)?(a=B.continueBtns,a.find(".a-button-primary:not(.a-button-disabled)").addClass("aok-hidden"),
a.find(".a-button-disabled").removeClass("aok-hidden")):I("#payPageContinueBtnStateFixEnabled").length&&aa(a)}function Q(a){b.isTouchCX()&&(Da()?a.$event.preventDefault():(B.continueErrPopover.hide().find(".error-message").hide(),f.show()))}function E(a){b.isTouchCX()&&(Da()||B.continueErrPopover.hide().find(".error-message").hide())}function F(a){a=I(a.currentTarget);a.click();a=a.closest(".payment-container");a.find("#cc-errors").is(":visible")?a.find(".tv-update .a-button-primary").focus():a.click()}
function U(a){a.$event.preventDefault();var d=H();if(!c.runConfirmCardValidator(d,d.find("#cc-errors"))){f.show();var e=(d=b.getInputValues(d))||{},h=b.getInputValues(B.hiddenFormFields),g;for(g in h)h.hasOwnProperty(g)&&(e[g]=h[g]);c.confirmCreditCard(d,va,a.data.url)}}function X(){B.continueErrPopover.filter(":visible").length&&B.continueErrPopover.hide()}function aa(){B.continueErrPopover.filter(":visible").length&&B.continueErrPopover.hide().find(".error-message").hide();var a=H();B.disableSubmitButtons.length?
a.find(".no-address").length||(a.find(".continue-center").removeClass("aok-hidden"),a.find(".a-button-disabled").addClass("aok-hidden")):(B.continueBtns.find(".a-button-primary:not(.a-button-disabled)").removeClass("aok-hidden"),B.continueBtns.find(".a-button-disabled").addClass("aok-hidden"));if(a){var b=a.find(".a-form-error");b&&b.length&&(b.removeClass("a-form-error"),(a=a.find(".pincode-err-block").filter(":visible"))&&a.length&&(B.continueErrPopover.hide().find(".error-message").hide(),B.continueBtns.find(".a-button-primary").removeClass("aok-hidden"),
B.continueBtns.find(".a-button-disabled").addClass("aok-hidden"),a.hide()))}}function Z(){B.continueErrPopover.filter(":visible").length||B.continueBtnTop.trigger("click")}function ga(a){if(13===a.which){var c=I(document.activeElement),d=c.closest("div.payment-row"),e=c.closest(".a-button"),c=c.get(0).tagName;if(d.length&&!e.length&&"A"!==c&&"a"!==c)return d=d.find('input[type\x3d"submit"]'),d.length?d.trigger("click"):(B.continueErrPopover.filter(":visible").length&&B.continueErrPopover.hide(),Da(a)?
(b.isTouchCX()||(B.continueBtns.find(".a-button-primary").addClass("aok-hidden"),B.continueBtns.find(".a-button-disabled").removeClass("aok-hidden")),a.preventDefault()):B.continueBtnTop.trigger("click")),!1}}function Y(a){f.show();var c=H(),d=c.find("input[type\x3dradio][name\x3dpaymentMethod]").val(),e=c.find(".card-unreg-rewards").data(),c=b.isTouchCX()?c.find(".flag-register-rewards"):B.rewardsRegister,c=b.getInputValues(c);c.programid=e.programid;c.paymentinstrumentid=e.paymentinstrumentid;c.CARD_EXPIRATION_DATE=
e.expiredate;c.CARD_HOLDER_NAME=e.holdername;c.returnRefreshedPage=a.data.returnRefreshedPage;c.rewardsdateofbirthmonth&&c.rewardsdateofbirthday&&(c.DATE_OF_BIRTH=c.rewardsdateofbirthmonth+c.rewardsdateofbirthday);-1===a.data.url.toLowerCase().indexOf("cachebuster")&&(a.data.url=l.addQueryStringParameter(a.data.url,"cacheBuster",(new Date).getTime()));b.makeAjaxCall(a.data.url,c,{successHandler:function(a,c,e){f.hide();if(a){a=k.jsonify(a);B.rewardsRegister.find(".register-content").hide();var h=
b.isTouchCX()?H().find(".register-error"):B.rewardsRegister.find(".register-error");h.hide();a.error?h.show().find(".error-message").hide().filter("#"+a.error).show():(m.ajaxUpdatePage(a.refreshedPage,c,e),c=B.paymentRows.find('input[type\x3dradio][name\x3dpaymentMethod][value\x3d"'+d+'"]').closest(".payment-row"),c.trigger("click"),b.scrollTopTo(c))}}})}function R(a){a=I(a.currentTarget).parents("div.currency-list");var b=a.find("label.a-touch-radio");b.length?b.trigger("click"):a.find("input[type\x3dradio][value\x3dOther]").trigger("click")}
function ba(a){a=a.$target.closest("div.payment-row");var c=a.find(".currency-list");if(m.isSPP()){var d=w.getSelect(c.find("select"));null!==d&&d.setValue("")}a.find(".change-currency").hide();c.show();b.isTouchCX()&&(a.find(".top-cell").removeClass("bottom-line").addClass("bottom-line"),a.find(".bottom-cell").show());la();Aa()}function ha(a){a=a.$target.closest("div.payment-row");a.find(".expire-info, .expire-date").hide();a.find(".enter-date, .expire-date-fields").show();la();J()}function y(a){var c=
a.$target.closest("div.payment-row"),d="true"===b.getAttributeData(c,"isaddresschallenge")?1:0;c.find(".expire-date-fields").length?(ha(a),c.find("#newExpDate").focus()):d&&c.find("#addCreditCardNumber").focus()}function ea(a){setTimeout(function(a){var b=I(a.target);a=document.createEvent("UIEvents");a.initUIEvent("DOMActivate",!0,!0,p,1);b.get(0).dispatchEvent(a)},0,a)}function da(a){var c=I(a.target).closest("div.payment-row");""!==I(a.target).val()&&("true"===b.getAttributeData(c,"isaddresschallenge")?
c.find("#addCreditCardNumber").focus():Z())}function na(){var a=H();a.find("div.flag-register-rewards").is(":visible")?(a.find(".bottom-cell").hide(),a.find(".top-cell").removeClass("bottom-line"),a.find(".card-unreg-rewards").show()):(a.find(".card-unreg-rewards").hide(),a.find(".bottom-cell").show(),a.find(".top-cell").removeClass("bottom-line").addClass("bottom-line"))}function O(){na()}function ra(a){a.$event.preventDefault();if("1"===H().find("div.flag-register-rewards").attr("cached"))na();
else{var c=a.$target.attr("href");-1===c.toLowerCase().indexOf("cachebuster")&&(c=l.addQueryStringParameter(c,"cacheBuster",(new Date).getTime()));f.show();b.makeAjaxCall(c,a.data,{successHandler:function(a){f.hide();var c=k.jsonify(a);a=b.decodeJSONResponse(c.widgetHTML);var d=H();d.find("div.flag-register-rewards").html(a);d.find("div.flag-register-rewards").attr("cached",1);d.find("div.flag-register-rewards .error-message").each(function(){var a=I(this),b=a.data("errorid");a.html(c.displaydata[b])});
na()}})}}function sa(c){var d=I(c.target);if(!d.is(":visible"))return c.preventDefault(),c.stopPropagation(),!1;m.isSPP()&&(m.isPrefetchFromAddressEnabled()?m.disablePageNoUpdateTransition():I("#payment").find(".panel-cancel-row").hide(),v.clearCache());var e=I(c.currentTarget);B.jppoints.length&&h.handleJPPointsOnPaymentRows(c);var f=e.find("[name\x3duseAvailableBalance]");if("useAvailableBalance"!==c.target.name&&!f.length)if(Ba(e),r.toggleGCForMCB(e,B),W(e),e.hasClass("payment-selected")||e.hasClass("payment-label"))B.disableSubmitButtons.length&&
(ka(e,e,!1),!d.hasClass("continue-center")&&e.find(".continue-center").length||Z());else if(c=e.find('input[type\x3d"radio"][name\x3d"paymentMethod"]'),c.length&&"disabled"!==c.attr("disabled")){bb();c=H();m.isSPP()?c.filter(function(){var a=I(this).attr("id");return"gcPromo"===a?(a=I(this).find('input[type\x3d"radio"][name\x3d"paymentMethod"][value\x3d"availablebalance"]'))&&a.length:"jppoints"!==a}).removeClass("payment-selected"):c.removeClass("payment-selected");c.find("[name\x3dpaymentMethod]").attr("checked",
!1);c.find("i[data-a-input-name\x3dpaymentMethod]").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive");c.find(".top-cell").removeClass("bottom-line");ya(c);b.isTouchCX()&&(c.find(".bottom-cell").hide(),c.find(".card-unreg-rewards").show());e.addClass("payment-selected");e.find("[name\x3dpaymentMethod]").attr("checked",!0);e.find("i[data-a-input-name\x3dpaymentMethod]").removeClass("a-icon-touch-radio-inactive").addClass("a-icon-touch-radio-active");var d="true"===b.getAttributeData(e,
"isaddresschallenge")?1:0,f=e.find('.rewards-list input[type\x3d"radio"]').length,g="1"===b.getAttributeData(e,"hasDerivedCurrency")?1:0,l=e.find(".vcc-form-fields").length,k=e.find(".card-ref-num").length;b.isTouchCX()&&(d||f||l||k||g)&&(e.find(".top-cell").removeClass("align-top bottom-line").addClass("bottom-line"),e.find(".bottom-cell").show());q.when("rewards-section-desktop").execute(function(b){a.trigger("rewards-section-desktop:select-payment-row",e,Aa)});Na(e);Oa(e);Pa(e);Qa(e);cb(e);"1"===
I("#suppressionMessageFixEnabledStatus").val()&&db(e);eb(e);Ra(e);Sa(e);Ta(e);fb(e);gb(e);Ua(e);Ga(u,u.toggleEMIMenu,e);Va(e);hb();qa(e);Za();la();J();E();pa();ca(e,c);Wa();I.isEmptyObject(x)||x.toggleCustomerNudgingMessage(e);B.hideInputBoxes.length&&(Xa(e,c),Ma(e));B.disableSubmitButtons.length&&ka(e,c,!0);Ja();Aa();B.disableSubmitButtons.length&&!e.find(".continue-center").length&&Z()}}function W(a){a=a.find('input[type\x3d"radio"][value\x3d"cashOnDeliveryCash"]');var b=I("input[type\x3d'hidden'][name\x3d'paySelectLocale']");
b.length&&"IN"===b.val()&&a.length&&q.when("client-side-metrics").execute(function(a){a.increaseCount("PayPage-COD-NonMobile",1)})}function Ba(a){var b=I("#isGlobalCODEligible").val();if(b&&"0"!==b){a=a.find('input[type\x3d"radio"][value\x3d"cashOnDeliveryCash"]');var b=I("#button-add-gcpromo"),c=I("#button-add-gcpromo").parent().parent();a.length?(c.addClass("a-button-disabled"),b.attr("disabled","disabled")):(c.removeClass("a-button-disabled"),b.removeAttr("disabled"))}}function S(a){q.when("A",
"a-tv").execute(function(b,c){b=b.$;var d=b(a);d.length&&(b(".tv-lastSelected").removeClass("tv-lastSelected"),d.addClass("tv-lastSelected"),c.select(d))})}function ka(a,b,c){c&&b.find(".billing-address, .cc-continue-button").hide();if(a.find(".tv-update").length)Xa(a,b),Ma(a);else{var d=a.find(".billing-address, .cc-continue-button");if(d.length&&!d.is(":visible")){var e=!1;a.find(".no-address").length&&(e=!0,a.find(".a-button-primary").addClass("aok-hidden"),a.find(".a-button-disabled").removeClass("aok-hidden"));
q.when("a-tv").execute(function(f){c&&(b.find(".payment-container").hasClass(".a-tv-navigate")||f.add(b.find(".payment-container")));f.remove(a.find(".payment-container"));f=e?a.find(".billing-address-link"):d.find(".continue-center");S(f)});d.show()}}}function qa(a){var b=I("#one-click-final-review-message");b.length&&(a.find("#canTryTFX").length?b.removeClass("aok-hidden"):b.addClass("aok-hidden"))}function ca(a,c){if(b.isTouchCX()&&(c&&c.find(".top-cell .data-row").children(".a-column").height("auto"),
a)){a=a.find(".top-cell .data-row");var d=a.find(".addr-challenge-card-scan .a-box");if(d.length){c=a.height();var d=d.height(),e=a.children(".a-column:first");a.children(".a-column").height(d);e.height(c);e.children(".vertical-center-grid:first").height(d)}else a.children(".a-column").height(a.height())}}function va(d){f.hide();var e=k.jsonify(d);e.imbWidgetHTML&&I("#imb-wrapper").html(b.decodeJSONResponse(e.imbWidgetHTML));if(e.cardWidgetHTML&&(d=H(),d.replaceWith(b.decodeJSONResponse(e.cardWidgetHTML)),
null!=e.rewardsAccountsWidgetHTML&&q.when("rewards-section-desktop").execute(function(c){a.trigger("rewards-section-desktop:refresh-rewards-section",b.decodeJSONResponse(e.rewardsAccountsWidgetHTML))}),a.trigger("checkout:reload"),a.trigger("checkout:reload:payselect"),d=H(),"true"!==b.getAttributeData(d,"isaddresschallenge"))){c.setCardPasswordInputStatus(d,e.newpaymentmethodid,"cvv","#existingCvvNum");c.setCardPasswordInputStatus(d,e.newpaymentmethodid,"pincode","#existingPincodeNum");if(B.cvvColumnLabel.length){var h=
!1;B.paymentRows.each(function(){if("true"===b.getAttributeData(I(this),"isaddresschallenge"))return h=!0,!1});h||B.cvvColumnLabel.hide()}B.disableSubmitButtons.length&&Z()}}function la(){B.paymentRows.each(function(){var a=I(this),c=a.find('.currency-list input[type\x3d"radio"]').length,d=a.find('.rewards-list input[type\x3d"radio"]').length,e=a.find(".card-reg-info").is(":visible"),f=a.find(".expire-date-fields").is(":visible"),h=a.find("a[data-action\x3dshow-expire-date-fields]").is(":visible"),
g=a.find(".bottom-cell .inner-grid-left"),l=a.find(".bottom-cell .inner-grid-right");f?c||d||e?(g.removeClass("hidden a-span10 a-span12").addClass("a-span8"),l.removeClass("a-span12 a-span2 hidden").addClass("a-span4")):(g.removeClass("a-span8 a-span10 a-span12").addClass("hidden"),l.removeClass("a-span4 a-span2 hidden").addClass("a-span12")):h?(g.removeClass("a-span12 a-span8 hidden").addClass("a-span10"),l.removeClass("hidden a-span4 a-span12").addClass("a-span2")):(g.removeClass("a-span10 a-span8 hidden").addClass("a-span12"),
l.removeClass("a-span2 a-span4 a-span12").addClass("hidden"));!b.isTouchCX()&&h&&(c||d||e)&&a.find(".bottom-cell").removeClass("align-top").addClass("align-top")});var a=H(),c=a.find("a[data-action\x3dshow-expire-date-fields]").filter(":visible").length,d=a.find(".top-cell.bottom-line").length;c&&!d||a.find(".bottom-cell").removeClass("align-top")}function J(){b.isTouchCX()&&B.paymentRows.each(function(){var a=I(this),c="true"===b.getAttributeData(a,"isaddresschallenge")?1:0,d=a.find("a[data-action\x3dshow-expire-date-fields]").is(":visible"),
e=a.find(".expire-date-fields").is(":visible"),f=a.find(".card-reg-info").is(":visible"),h=a.find(".rewards-info").is(":visible"),g=a.find(".change-currency").is(":visible");d?a.find(".top-cell .second-row").addClass("align-top"):a.find(".top-cell .second-row").removeClass("align-top");c=c||g||f||h;f=e||d;h=a.find(".top-cell .inner-grid-left");a=a.find(".top-cell .inner-grid-right");c||(h.removeClass("a-span6 a-span8 a-span12").addClass("hidden"),a.removeClass("a-span4 a-span6 hidden").addClass("a-span12"));
f||(h.removeClass("a-span6 a-span8 hidden").addClass("a-span12"),a.removeClass("a-span4 a-span6 a-span12").addClass("hidden"));c&&d&&(h.removeClass("a-span6 a-span12 hidden").addClass("a-span8"),a.removeClass("a-span6 a-span12 hidden").addClass("a-span4"));c&&e&&(h.removeClass("a-span6 a-span8 hidden").addClass("a-span6"),a.removeClass("a-span4 a-span12 hidden").addClass("a-span6"))})}function ya(a){var b=a.find(".currency-list");if(b.length){var c=b.find("[type\x3dradio]:checked").val(),b=b.find("#cardCurrencyDropDown option:selected").val();
"Other"!==c||"-1"!==b&&"-2"!==b||a.find(".currency-list input[type\x3dradio][value!\x3dOther]").attr("checked",!0)}}function Ea(a){var b=I(a.currentTarget);a=b.find("option:selected");if(""===a.val())b.parents("div.selected-section").find(".selected-note-content").hide();else{var c=a.prop("disabled"),b=b.parents("div.selected-section"),d=b.find("#active-bank-content"),e=b.find("#disable-bank-content");c?(e.show(),d.hide()):(d.show(),e.hide());b.find("span.selected-note-bank").text(a.text()).show()}}
function V(a){var b=I(a.currentTarget);a=b.find("option:selected");""===a.val()?b.parents("div.selected-section-more-payment-method").find(".selected-more-payment-content").hide():(b=b.parents("div.selected-section-more-payment-method"),b.find("span.selected-payment-option").text(a.text()).show(),b.find("span.selected-more-payment-content").show())}function xa(a){(B.continueErrPopover.filter(":visible").length||Da())&&a.$event.preventDefault()}function za(b){b=I(b.currentTarget);var c=b.find("input[type\x3dcheckbox]");
c.attr("checked")?(c.attr("checked",!1),b.find(".checked-checkbox").addClass("aok-hidden"),b.find(".empty-checkbox").removeClass("aok-hidden"),b.find(".gc-balance-insufficient-msg").addClass("aok-hidden")):(c.attr("checked",!0),b.find(".checked-checkbox").removeClass("aok-hidden"),b.find(".empty-checkbox").addClass("aok-hidden"),b.find(".gc-balance-insufficient-msg").removeClass("aok-hidden"));q.when("a-tv").execute(function(b){setTimeout(function(){b.select(".tv-lastSelected")},500);a.trigger("a:tv:resize")})}
function fa(a){a=I(a.currentTarget);"1"===a.attr("isclicked")?a.attr("isclicked",0):a.attr("isclicked",1);pa()}function pa(a){var c=I("#pm_promo");a=I("#pm_gc_radio");var d=I("#pm_gc_checkbox"),e;I("input[name\x3ddoesPurchaseContainOnlyRecurringPrimeMembership]").length&&(e=I("input[name\x3ddoesPurchaseContainOnlyRecurringPrimeMembership]").val());if(a&&a.length||d&&d.length){var f=I("input[name\x3dgcBalanceRaw]").val();I("input[name\x3damBalanceRaw]").length&&(f=I("input[name\x3damBalanceRaw]").val());
var h=I("input[name\x3disAPBLimitMessagingLaunchWeblabEnabled]").val(),g=I("input[name\x3dhasAPBRedeemableLimitExhausted]").val(),l=I("input[name\x3damAvailableBalanceRaw]").val(),k=I("input[name\x3dremainingBalanceRaw]").val(),r=I("input[name\x3dpurchaseTotalRaw]").val(),n,m,ma=I(".purchase-total").length;ma?(m=I(".purchase-total").html(),n=I(".remaining-balance").html()):(m=I("input[name\x3dpurchaseTotal]").val(),n=I("input[name\x3dremainingBalance]").val());var u=I(".balance-applied");ma?u.html(m):
u.text(m);(b.isTouchCX()&&"checkbox"===c.attr("type")?"1"===c.closest(".a-control-row").attr("isclicked"):c.is(":checked"))?(c=k,0<c&&(ma?u.html(n):u.text(n))):c=r;h&&D.renderAPBMessagingRemainingBalance({purchaseTotal:m,remainingBalance:n,balanceApplied:u,isPurchaseTotalInSpan:ma},f,r,l);n=a.closest(".radio-col");m=d.closest(".radio-col");k=I(".amazon-money-limit-breached");ma=I(".long");u=I(".short");"1"===h&&"1"===g?D.displayAPBRedeemableLimitExhaustedMessaging({gcRadioContainer:n,gcCheckboxContainer:m,
gcCheckbox:d,gcRadio:a,shortMsg:u,longMsg:ma,amazonMoneyLimitBreachedMsg:k}):0<=f-r?("disabled"===a.attr("disabled")&&a.removeAttr("disabled"),n.removeClass("hidden"),a.is(":checked")&&n.trigger("click"),m.addClass("hidden"),d.attr("disabled","disabled"),0==f-r?(ma.hide(),u.show()):(ma.show(),u.hide())):0<f-c?0>=c?(m.removeClass("hidden"),d.attr("disabled","disabled"),b.isTouchCX()&&m.find("i").addClass("a-button-disabled checkbox-disabled"),n.addClass("hidden"),a.attr("disabled","disabled"),u.show(),
ma.hide()):("disabled"===a.attr("disabled")&&a.removeAttr("disabled"),n.removeClass("hidden"),a.is(":checked")?n.trigger("click"):b.isTouchCX()&&n.find("i").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive"),m.addClass("hidden"),d.attr("disabled","disabled"),ma.show(),u.hide()):("disabled"===d.attr("disabled")&&(d.removeAttr("disabled"),b.isTouchCX()&&m.find("i").removeClass("a-button-disabled checkbox-disabled")),m.removeClass("hidden"),(g=m.closest(".payment-row"))&&
g.hasClass("payment-selected")&&g.removeClass("payment-selected"),n.addClass("hidden"),a.attr("disabled","disabled"),"1"===h?D.renderAPBInsufficientMessaging({shortMsg:u,longMsg:ma},f,l):(u.show(),ma.hide()));"1"===e&&(a.attr("disabled","disabled"),d.attr("disabled","disabled"),(g=m.closest(".payment-row"))&&g.hasClass("payment-selected")&&g.removeClass("payment-selected"))}}function ia(b){var c=H().find(".enter-custom-rewards");if("rewardscustom"===I(b.currentTarget).children('input[type\x3d"radio"]').val()){c.show();
var d=c.find("input.custom-rewards-input");d.focus();B.paymentRows.find(".rewards-list").hasClass("show-currency-input-widget-new")&&(c=d.val().length,d=d.get(0),d.setSelectionRange?d.setSelectionRange(c,c):d.createTextRange&&(d=d.createTextRange(),d.collapse(!0),d.moveStart("character",c),d.moveEnd("character",c),d.select()))}else c.hide();q.when("installments-payselect").execute(function(c){a.trigger("installments-payselect:toggleRewardsInstallmentEligibility",I(b.currentTarget))});Aa()}function ja(a){a=
a.$target||I(a.currentTarget);ta(a)}function ta(b){if(b.length){var c=B.paymentRows.find('input[type\x3d"radio"][value\x3d"cashOnDeliveryCash"]'),d=B.paymentRows.find(".installments-select.a-row"),e=d.siblings(".installments-message"),f=d.siblings(".card-offers"),h=B.paymentRows.find('input[type\x3d"radio"][value\x3d"morePaymentMethod"]'),g=B.installmentsOnlyCards,l=B.paymentRows.find('input[type\x3d"radio"][id\x3d"pmEmiPaymentOptions"]'),k=B.paymentRows.find('input[type\x3d"radio"][value\x3d"amazonBusinessCredit"]');
if(c.length){var n=c.closest(".payment-row"),r=h.closest(".payment-row"),m=l.closest(".payment-row"),ma=k.closest(".payment-row");b.is(":checked")?(c.prop("disabled",!0),c.is(":checked")&&(c.prop("checked",!1),n.removeClass("payment-selected")),c.parent().siblings().addClass("a-color-secondary"),Ga(u,u.disableEMIPaymentMethods,l),q.when("abc-helper").execute(function(b){a.trigger("abc-helper:disable-payment",k)}),K.showInstantBankDiscountAmazonPaySelected(),ua(h,r),(b=d.find("select"))&&b.each(function(){var a=
this.id.replace(/\./g,"\\.");w.setValue(a,"")}),d.find(".installments-enabled-text").hide(),e.find(".installments-enabled-text").hide(),f.find(".installments-enabled-text").hide(),d.find(".installments-disabled-text").show(),e.find(".installments-disabled-text").show(),f.find(".installments-disabled-text").show(),g.find("input[name\x3dpaymentMethod]").attr("disabled","disabled").removeAttr("checked"),g.removeClass("payment-selected")):(n.find(".payment-invalid").length||(c.prop("disabled",!1),c.parent().siblings().removeClass("a-color-secondary")),
r.find(".payment-invalid").length||wa(h,r),m.find(".payment-invalid").length||Ga(u,u.enableEMIPaymentMethods,l),ma.find(".payment-invalid").length||q.when("abc-helper").execute(function(b){a.trigger("abc-helper:enable-payment",k)}),K.showInstantBankDiscountAmazonPayDeselected(),d.find(".installments-disabled-text").hide(),e.find(".installments-disabled-text").hide(),f.find(".installments-disabled-text").hide(),d.find(".installments-enabled-text").show(),e.find(".installments-enabled-text").show(),
f.find(".installments-enabled-text").show(),g.find("input[name\x3dpaymentMethod]").removeAttr("disabled"))}}}function wa(a,b){a.prop("disabled",!1);a.parent().siblings().removeClass("a-color-secondary");b.find(".selected-section-more-payment-method").show();b.find(".more-payment-gc-disabled-text").hide()}function ua(a,b){a.prop("disabled",!0);a.is(":checked")&&(a.prop("checked",!1),b.removeClass("payment-selected"));a.parent().siblings().addClass("a-color-secondary");b.find(".selected-section-more-payment-method").hide();
b.find(".more-payment-gc-disabled-text").show()}function oa(a){var c=a.$target||I(a.currentTarget);a=c.closest(".currency-list");c=c.val();!0===(b.isTouchCX()?"Other"===c:"Other"!==c)?(a.find("select").attr("disabled",!0),a.find(".a-button.a-button-dropdown").addClass("a-button-disabled"),a.find(".a-button.a-touch-select").addClass("a-button-disabled")):(a.find("select").attr("disabled",!1),a.find(".a-button.a-button-dropdown").removeClass("a-button-disabled"),a.find(".a-button.a-touch-select").removeClass("a-button-disabled"));
Aa()}function Ca(a){A.actionReregisterCardInBox(a);b.scrollTopTo(H())}function T(a){Aa()}function ma(){B.paymentRows.each(function(){var a=I(this),c=".card-ref-num, .addr-challenge, .addr-challenge-msg, .cup-expired-msg, .enter-date, .expire-date-fields, .rewards-static-help-link, .verified-fail-msg, .tv-update, .billing-address, .cc-continue-button",d=".card-info, .card-name, .card-reg-info, .expire-info, .rewards-err-msg, .rewards-list label, .rewards-list div.a-radio, .rewards-dynamic-help-link, .financial-offer-err-detail";
a.hasClass("payment-selected")&&("1"===b.getAttributeData(a,"hasDerivedCurrency")||"1"===b.getAttributeData(a,"hasPreferredCurrency")&&"1"===b.getAttributeData(a,"isNewCard"))||(c+=", .currency-list");"1"===b.getAttributeData(a,"hasPreferredCurrency")&&"1"!==b.getAttributeData(a,"isNewCard")&&(d+=", .change-currency");a.find(c).hide();a.find(d).show()})}function Za(){B.paymentRows.each(function(){var a=I(this),c="#cc-errors, .enter-date, .expire-date-fields",d=".expire-info";if(a.hasClass("payment-selected")&&
"1"===b.getAttributeData(a,"hasDerivedCurrency"))c+=", .change-currency",d+=", .currency-list";else{var e=a.find(".currency-list"),f=e.find("[type\x3dradio]:checked").val();if(f){var h;if("Other"!==f)h=e.find(".currencyNameLabel").html();else{var f=e.find("#cardCurrencyDropDown option:selected"),g=f.val();"-1"!==g&&"-2"!==g&&(h=f.text())}h&&(d+=", .change-currency",e.closest("div.payment-row").find(".change-currency .currencyNameLabel").html(h))}c+=", .currency-list"}a.find(c).hide();a.find(d).show()})}
function $a(){var a=I("#aan-ads-box");if(a.length){var b=a.data("adsendpoint"),c=a.data("adsclient"),d="https://"+b+"/2009-09-09/ad/",b="/jsc?pt\x3dstatic\x26slot\x3dlib\x26pt2\x3daanjs";a.data("useaannojq")&&(b+="-nojq");I.getScript(d+c+b,function(){p.d16g&&p.d16g.requestAanAd({elemId:"aan-ads-box",baseUrl:d,afterOnload:!0,client:c,pt:"checkout",slot:"display-ad-right",pt2:"payselect"})})}}function ab(){Ya&&(a.declarative("auto-rewards-reg",["click"],M),a.declarative("complete-rewards-register",
["click"],G),a.declarative("confirm-card",["click"],U),a.declarative("register-card-rewards",["click"],Y),a.declarative("cancel-register-card-rewards",["click"],O),a.declarative("show-currencies",["click"],ba),a.declarative("show-expire-date-fields",["click"],ha),a.declarative("focus-cc-update-fields",["click"],y),a.declarative("show-rewards-reg",["click"],ra),a.declarative("submit-payment-form",["submit"],xa),a.declarative("toggle-tfx-option",["click"],oa),a.declarative("reregister-cc-in-dashboard",
["click"],Ca),a.declarative("modify-expire-date-fields",["change"],T),b.isTouchCX()&&a.declarative("continue-button",["click"],Q),Ya=!1);B.paymentRows.unbind("click").has("input[name\x3dpaymentMethod]:enabled").bind("click",sa);q.when("apx-payselect-helper").execute(function(){var a=L.get("payselect");a&&a.initEvents(B.paymentRows,Aa)});B.paymentRows.find("input[name\x3dusePromoBalance]").unbind("change",pa).bind("change",pa);B.disableSubmitButtons.length&&B.paymentRows.has("input[type\x3dcheckbox]:enabled").unbind("click",
za).bind("click",za);B.existingPincodeNum.unbind("click",Ka).bind("click",Ka);B.paymentRows.find("select#cardCurrencyDropDown").unbind("change",R).bind("change",R);B.paymentRows.find(".rewards-list").hasClass("show-currency-input-widget-new")?B.paymentRows.find(".rewards-list").undelegate("label","click").delegate("label","click",ia).each(function(b,c){c=a.$(c);b=c.find("input.custom-rewards-input");c=c.find(".custom-reward-points");var d=a.$(b);b={$element:d,maxAmount:d.data("max")};c={$element:a.$(c),
decimalPlaces:d.data("decimalplaces"),ratio:d.data("ratio")};d=d.data("country-code");d=z.getCurrencyFormatByCountryCode(d);z.initializeInlineFormatting(b,c,d)}):B.paymentRows.find(".rewards-list").undelegate("label","click").delegate("label","click",ia).undelegate("input.custom-rewards-input","keyup").delegate("input.custom-rewards-input","keyup",P);if(b.isTouchCX())B.pageContainer.find("#existing-payment-methods").find("select, input[type\x3dtext], input[type\x3dpassword]").unbind("change",E).bind("change",
E),B.pageContainer.find("#existing-payment-methods").find("div.currency-list label.a-touch-radio").unbind("click").bind("click",oa),B.pageContainer.find("#existing-payment-methods").find("label.promoLabel").unbind("click").bind("click",fa);else if(!m.isSPP()){var c=B.continueBtns.find(".a-button-text");I("#payPageContinueBtnStateFixEnabled").length?c.filter('input[type\x3d"button"]').unbind("mouseenter",Ha).bind("mouseenter",Ha).unbind("focus",Ha).bind("focus",Ha).unbind("mouseleave",X).bind("mouseleave",
X).unbind("blur",X).bind("blur",X):(c.filter('input[type\x3d"submit"]').unbind("mouseenter").bind("mouseenter",C).unbind("focus").bind("focus",C),c.filter('input[type\x3d"button"]').unbind("mouseleave").bind("mouseleave",aa).unbind("blur").bind("blur",aa))}B.netBankingSelect.unbind("change",Ea).bind("change",Ea);B.morePaymentMethodsSelect.unbind("change",V).bind("change",V);B.continueBtnBottom.unbind("click").bind("click",Z);0<I("input[name\x3d'needDisableCODandEMIforGC']").length&&(c=I("input#pm_300[type\x3d'checkbox'], #pm_gc_checkbox"),
c.length&&(c.bind("change",ja),c.is(":checked")&&ta(c)));B.jppoints.length&&B.paymentRows.find('input[name\x3d"useAvailableBalance"]').bind("click",h.handleJPPointsOnPaymentRows);q.when("installments-payselect").execute(function(){a.trigger("installments-payselect:initEvents")});B.hideInputBoxes.length&&(B.paymentRows.find("#confirm-card").unbind("focus").bind("focus",F),B.paymentRows.find("#newExpDate").unbind("focus").bind("focus",ea),B.paymentRows.find("#newExpDate").unbind("change").bind("change",
da))}function Ja(){var a=e.create();a.validatePayment(H());a.hasErrors()||m.makePrefetch(B.existingPaymentForm)}function Ka(a){a=B.showAmexWarning;null!==a&&(a.removeClass("hidden"),a.removeClass("amex_display"))}function La(){if(!b.isMobileCX()){B=b.getElements(ib);B.paymentRows.filter(".payment-selected-marker").removeClass("payment-selected-marker").addClass("payment-selected");var c=H();q.when("rewards-section-desktop").execute(function(b){a.trigger("rewards-section-desktop:page-load",Aa)});q.when("installments-payselect").execute(function(b){a.trigger("installments-payselect:page-load")});
Qa(c);Sa(c);qa(c);ma();Na(c);Oa(c);Pa(c);Ta(c);Ua(c);Va(c);Ra(c);pa();Wa();I.isEmptyObject(x)||x.toggleCustomerNudgingMessage(c);I(document).undelegate("div.pay-desktop .checkout-page-form","keypress").delegate("div.pay-desktop .checkout-page-form","keypress",ga);I(document).undelegate("div.pay-desktop .checkout-page-form .enter-custom-rewards","keyup").delegate("div.pay-desktop .checkout-page-form .enter-custom-rewards","keyup",Aa);B.addressChallengeCardList.length&&B.addressChallengeCardList.show();
B.paymentRows.find('input[type\x3d"radio"][value\x3d"rewardsmax"]').each(function(){I(this).siblings('[type\x3d"checkbox"]').remove()}).removeClass("hidden");J();la();ab();B.existingPaymentForm.data("checkoutFormReady",!0);Ja();$a();B.orderSummaryBottom.show();ca(c);E();Aa();Ba(c);r.determineIsMCBEnabled(B);r.toggleGCForMCB(c,B);I(".a-popover-preload").each(function(){var b=I(this).find(".rewards-registration").data("parentPaymentMethodId");b&&(a.off("a:popover:show:rewards-registration-"+b,n.displayRewardsRegister),
a.off("a:popover:hide:rewards-registration-"+b,n.hideRewardsRegister),a.on("a:popover:show:rewards-registration-"+b,n.displayRewardsRegister),a.on("a:popover:hide:rewards-registration-"+b,n.hideRewardsRegister))});q.when("a-tv").execute(function(b){a.trigger("a:tv:resize");c.find(".a-tv-navigate").length&&ka(c,c,!1)})}}function Aa(b){m.isSPP()?(Da()?B.disableSubmitButtons.length?(b=H(),b.find(".continue-center").addClass("aok-hidden"),b.find(".a-button-disabled").removeClass("aok-hidden")):(B.continueBtns.find(".a-button-primary:not(.a-button-disabled)").addClass("aok-hidden"),
B.continueBtns.find(".a-button-disabled").removeClass("aok-hidden")):aa(),a.trigger("orderSummary:primaryActionButton:mirrorPanelBtnState")):I("#payPageContinueBtnStateFixEnabled").length&&C(b)}function Ia(a,b){a=I(a.target).closest(".order-summary-box").find(".continue-button-errors");a.length&&b.length&&(b=d.triggerLeft(a,b),a.show(),a.offset(b))}function Ha(a){if((!B.continueErrPopover.filter(":visible").length||b.isTouchCX())&&B.continueErrPopover.find(".error-message:not(.hidden)").length&&a&&
("mouseenter"===a.type||"focus"===a.type)){var c=I(a.target).closest(".continue-buttons").find(".a-button-disabled");Ia(a,c)}}function Da(a){if(B.continueErrPopover.filter(":visible").length&&!b.isTouchCX())return!0;var c=H(),f=e.create();Ga(u,u.isEMIPaymentInstrument,c)&&(f.validateEMIMenuForContinueButton(c),c=Ga(u,u.getEMIMenuSelectedCardSection));f.validatePayment(c);f.apxValidatePayment(c,B.paymentRows);f=f.getHighestErrorId();if(!f||!f.identifier)return!1;B.continueErrPopover.find(".error-message").hide();
c=c.find(".pincode-err-block");c.hide();c&&c.length&&f.target&&f.target.length&&f.target.addClass("a-form-error");f.isPincodeError?(c.show(),c.addClass("a-form-error")):(B.continueErrPopover.find("#"+f.identifier).show(),B.continueErrPopover.find("#"+f.identifier).removeClass("hidden"),!a||"mouseenter"!==a.type&&"focus"!==a.type?m.isSPP||B.continueBtns.find(".a-button input").filter(":visible").each(function(){var a=I(this).closest(".order-summary-box").find(".continue-button-errors"),b=d.triggerLeft(a,
I(this));a.show();a.offset(b)}):(c=I(a.target).closest(".continue-buttons").find(".a-button-primary"),Ia(a,c)));return!0}function Na(c){B.paymentRows.find(".addr-challenge, .addr-challenge-msg").hide();B.hideInputBoxes.length?B.paymentRows.find(".card-name").show():B.paymentRows.find(".card-info").show();if("true"===b.getAttributeData(c,"isaddresschallenge")){var d=c.find(".addr-challenge, .addr-challenge-msg");0===d.length&&g.increaseCount("Checkout:Payment:AddressChallengeMissingInputAndMsg");d.show();
B.hideInputBoxes.length?c.find(".card-name").hide():c.find(".card-info").hide();c=c.attr("paymentmethodid")?c.attr("paymentmethodid"):c.attr("data-paymentmethodid");a.trigger("checkout:payment:challenge:log",c)}}function Ma(a){B.paymentRows.find(".expire-date-fields").hide();a=a.find(".expire-date-fields");a.length&&a.show()}function Wa(){B.paymentRows.find(".pci-blocking-cvv").length&&B.paymentRows.each(function(){var a=I(this),b=a.find(".pci-blocking-cvv");a.find("[type\x3dradio]:checked").val()&&
b.length?b.show():b.length&&b.hide()})}function Xa(a,b){q.when("a-tv").execute(function(c){c.add(b.find(".payment-container"));b.find(".tv-update").hide();var d=a.find(".tv-update");d.length&&(c.remove(a.find(".payment-container")),d.show(),S(d.find(".a-button-primary")))})}function Oa(a){B.paymentRows.find(".verified-fail-msg").hide();"true"===b.getAttributeData(a,"isverifiedfail")&&a.find(".verified-fail-msg").show()}function Pa(a){B.paymentRows.find(".cup-expired-msg").hide();"true"!==b.getAttributeData(a,
"iscupcardexpired")&&"true"!==b.getAttributeData(a,"iscupcardexpiringsoon")||a.find(".cup-expired-msg").show()}function Qa(c){B.paymentRows.find(".rewards-list").hide();B.paymentRows.find(".top-cell .inner-grid-left").show().find(".rewards-info").show();var d=c.find('.rewards-list input[type\x3d"radio"]'),e=d.filter(":checked");B.paymentRows.find('.rewards-list input[type\x3d"radio"]').prop("checked",!1);0<e.length?e.prop("checked",!0):c.find(".rewards-list").hasClass("apply-by-default")?d.filter('[value\x3d"rewardsmax"]').prop("checked",
!0):d.filter('[value\x3d"rewardsnone"]').prop("checked",!0);d=c.find(".rewards-list").show();d.find('input[type\x3d"radio"][value\x3d"rewardscustom"]').is(":checked")&&d.children(".enter-custom-rewards").show();b.isTouchCX()&&d.length&&(c.find(".rewards-info").hide(),c.find(".top-cell").addClass("bottom-line"),c.find(".bottom-cell").show());q.when("installments-payselect").execute(function(b){a.trigger("installments-payselect:toggleRewardsInstallmentEligibility",c)})}function Sa(a){B.paymentRows.find(".financial-offer-list").hide();
B.paymentRows.find(".financial-offer-err-detail").hide();var c=a.find('.financial-offer-list input[type\x3d"radio"]'),d=c.filter(":checked");c.prop("checked",!1);0<d.length?d.prop("checked",!0):c.first().prop("checked",!0);c=a.find(".financial-offer-list").show();a.find(".financial-offer-err-detail").show();b.isTouchCX()&&c.length&&(a.find(".top-cell").addClass("bottom-line"),a.find(".bottom-cell").show())}function bb(){I(document.body).find(".a-dropdown").each(function(){t.hide(I(this))})}function cb(a){B.paymentRows.find(".installments-select").hide();
B.paymentRows.find(".installments-message").show();a.find(".installments-select").show();a.find(".installments-message").hide()}function db(a){B.paymentRows.find("#savedCardSuppressed").hide();a.find("#savedCardSuppressed").show()}function eb(a){B.paymentRows.find(".installments-list").hide();a.find(".installments-list").show()}function Ra(a){B.paymentRows.find(".card-ref-num, .selected-note, .selected-more-payment-option").hide();B.paymentRows.find(".card-benefit").show();a.find(".card-ref-num, .selected-note, .selected-more-payment-option").show();
a.find(".card-benefit").hide()}function fb(a){B.paymentRows.find(".otpBlock").hide();a.find(".otpBlock").show()}function gb(a){B.paymentRows.find(B.ovdWidgetSection).hide();a.find(B.ovdWidgetSection).show()}function Ta(a){B.paymentRows.find(".vcc-info-prompt,.vcc-form-fields").hide();a.find(".vcc-info-prompt,.vcc-form-fields").show()}function Ua(a){var c=B.newVDC.find("#vdcBanksSelect"),b=B.newVDC.find(".vdc-selected-bank-prompt").hide(),d=B.newVDC.find("#suppressedVerifiedDebitCard").hide(),e=c.val(),
f="1"===I("#save_citi_card").val()?"CIT"!==e:!0,h="1"===I("#save_citi_card").val()&&"CIT"===e;a.find("#vdcBanksSelect").length?""!==e&&"OtherBanks"!==e&&f&&(B.newVDC.find("option:selected").prop("disabled")?(d.show(),b.hide()):(d.hide(),b.show())):(("OtherBanks"===e||h)&&c.val(c.children("option").first().val()).trigger("change"),b.hide())}function Ga(a,c,b){if(!I.isEmptyObject(a)&&c)return c(b)}function Va(a){var c=I("#cash-back-ineligible-for-cod-message");c&&c.length&&((a=a.find("#cashOnDeliveryCash"))&&
a.length?c.removeClass("hidden"):c.addClass("hidden"))}function hb(){var a=I("#imb-wrapper");if(a.length&&a.is(":visible")){var c=a.find(".defaultPaymentMethodExpired"),b=a.find(".codUnavailable"),d=a.find("p").length;0===c.length&&0===b.length||1!==d||a.hide()}}var I=a.$,Ya=!0,B={},ib={cardImages:"#newCreditCardImages",continueBtns:".continue-buttons:not(.place-order-button)",continueBtnTop:"#continue-top",continueBtnBottom:"#continue-bottom",continueErrPopover:".continue-button-errors",cvvColumnLabel:"#cvvColumnLabel",
existingPaymentForm:"form.checkout-page-form",netBankingSelect:"#net-banking-select-list",morePaymentMethodsSelect:"#more-payment-methods-select-list",newVDC:"#new-vdc",newEMI:"#newEmiCard",orderSummaryBottom:"#order-summary-bottom",pageContainer:"div.a-container",paymentRows:"#existing-payment-methods .payment-row",rewardsRegister:"#rewards-register",addressChallengeCardList:".address-challenge-card",hiddenFormFields:"#hiddenFormFields",jppoints:"#jppoints",gcpromo:"#gcPromo",disableSubmitButtons:"#disableSubmitButtons",
hideInputBoxes:"#hideInputBoxes",showAmexWarning:"#showAmexWarning",existingPincodeNum:"#existingPincodeNum",mcbBalanceWarning:"#mcbBalanceWarning",installmentsOnlyCards:".installments-only-card",ovdWidgetSection:"#ovdWidgetSection"};a.on("checkout:reload:payselect",La);a.on("checkout:reload:spp-payment",La);return{getSelectedPayment:H}});"use strict";q.when("A","page-detector").register("wechat-detector",function(a,k){var g=a.$,b=function(a){a&&!1!==a.isWeChatInstalled&&(a=g("#wechat_payment"),a.length&&
a.show())},e=function(a){},f="MShopWeChatPayment";a.on("checkout:reload:payselect",function(){g("#wechat_payment").length&&(g("#mShopWeChatApiName").length&&(f=g("#mShopWeChatApiName").val()),q.when("safe-mash").execute(function(a){p.cordova.require("cordova/exec")(b,e,f,"isWeChatInstalled",[])}))})});"use strict";q.when("A","page-main","client-side-metrics","ready").register("otp-for-cod",function(a,k,g){function b(){z=w("#cashOnDeliveryCash");if(z.length&&(v=z.find(F.verifyOTP),A=z.find(F.sendOTP),
H=v.length&&A.length,M=w(F.payMobile).length?1:0,H&&(r=z.find(F.submitSendOTP),u=z.find(F.submitVerifyOTP),p=z.find(F.submitResendOTP),x=z.find(F.changeOTPNumber),q=z.find(F.OTPPhoneNumber),D=z.find(F.otpCode),r.length&&u.length&&p.length&&x.length))){P=z.find(F.addURLHash).length;g.increaseCount(X.metricPrefix+X.block,1,1);r.click(function(){t();g.increaseCount(X.metricPrefix+X.send,1,1)});u.click(function(){G=q.val();E=D.val();l();var a=f(G),b;b=/^\d{6}$/;b=E&&b.test(E);a&&b&&""!==N?c("VerifyOTP",
N):b?a||z.find(F.otpServiceFailed).removeClass(F.aokHidden):z.find(F.invalidOTPError).removeClass(F.aokHidden);g.increaseCount(X.metricPrefix+X.verify,1,1)});if(P&&location.hash&&location.hash.length){for(var a=location.hash,a=a.replace("#",""),a=a.split(";"),b=0;b<a.length;b++)0<=a[b].indexOf(U.codehandle)&&(N=a[b].replace(U.codehandle,"")),0<=a[b].indexOf(U.contactid)&&(Q=a[b].replace(U.contactid,"")),0<=a[b].indexOf(U.phonenumber)&&(G=a[b].replace(U.phonenumber,""),q.val(G));""!==N&&""!==Q&&""!==
G&&d()}p.click(function(){g.increaseCount(X.metricPrefix+X.resend,1,1);t()});x.click(function(){v.addClass(F.aokHidden);A.removeClass(F.aokHidden);e(p,!1);e(u,!1);l();g.increaseCount(X.metricPrefix+X.changeNumber,1,1)})}}function e(a,b){b?a.addClass(F.aButtonDisabled):a.removeClass(F.aButtonDisabled);M?a.find("button").prop("disabled",b):a.find("input").prop("disabled",b)}function f(a){var b=/^\d{10}$/;return a&&b.test(a)}function m(){z.find(F.otpServiceFailed).removeClass(F.aokHidden)}function d(){var a=
z.find(F.verifyOTPPhoneNumber);z.find(F.invalidPhoneNumber).addClass(F.aokHidden);A.hasClass(F.aokHidden)?z.find(F.otpResentSuccess).removeClass(F.aokHidden):M&&z.find(F.otpSentSuccess).removeClass(F.aokHidden);A.addClass(F.aokHidden);v.removeClass(F.aokHidden);var b=G.substr(0,2)+"*****"+G.substr(7,9);a.text(b);e(p,!1)}function n(a){if(a!==C&&"object"!==typeof a)try{a=w.parseJSON(a)}catch(b){a={}}a=a||{};var c,d=P&&location.hash?location.hash:"#";P&&location.hash&&";"!==d.slice(-1)&&(d+=";");c=a.status;
a.codeHandle&&null!==a.codeHandle&&(N=a.codeHandle,P&&"SEND-SUCCESS"===c&&(d=h(d,U.codehandle,N)));a.contactId&&null!==a.contactId&&(Q=a.contactId,P&&"SEND-SUCCESS"===c&&(d=h(d,U.contactid,Q),d=h(d,U.phonenumber,G)));P&&(location.hash=d);z.find(F.otpAlertClass).addClass(F.aokHidden);if(aa[c])aa[c]();else aa.DEFAULT()}function h(a,b,c){var d=a.indexOf(b);if(0<=d){var e=a.indexOf(";",d),e=0<=e?e:a.length;a=a.substring(0,d)+a.substring(e+1,a.length+1)}return a+b+c+";"}function c(b,c){a.ajax("/gp/buy/payselect/handlers/otpAjaxHandler.html",
{method:"get",params:{phoneNumber:G,method:b,codeHandle:c,contactId:Q,otp:E},success:n,error:function(){n({status:"SERVICE-FAILED"})}})}function l(){D.val("");z.find(F.otpAlertClass).addClass(F.aokHidden)}function t(){l();G=q.val();f(G)?c("SendOTP",N):z.find(F.invalidPhoneNumber).removeClass(F.aokHidden)}var w=a.$,z,v,A,r,u,p,x,q,D,H,M,P,G="",N="",Q="",E="",F={aokHidden:"aok-hidden",aRadio:".a-radio",aButtonHidden:"a-button-hidden",aButtonDisabled:"a-button-disabled",payMobile:".pay-mobile",invalidOTPError:".invalidOTPError",
verifyOTP:"#verifyOTP",sendOTP:"#sendOTP",submitSendOTP:"#submitSendOTP",submitVerifyOTP:"#submitVerifyOTP",submitResendOTP:"#submitResendOTP",changeOTPNumber:"#changeOTPNumber",OTPPhoneNumber:"#OTPPhoneNumber",otpCode:"#otpCode",cashOnDeliveryCash:"#cashOnDeliveryCash",invalidPhoneNumber:".invalidPhoneNumber",otpServiceFailed:".otpServiceFailed",enterOTPLabel:"#enterOTPLabel",reEnterOTPLabel:"#reEnterOTPLabel",maxOTPError:".maxOTPError",numberAlreadyUsed:".numberAlreadyUsed",verifiedOTPSuccess:".verifiedOTPSuccess",
verifyOTPPhoneNumber:"#verifyOTPPhoneNumber",otpResentSuccess:".otpResentSuccess",otpSentSuccess:".otpSentSuccess",otpAlertClass:".otpAlertClass",phonenumberNotVerified:"phonenumberNotVerified",addURLHash:".addURLHash"},U={codehandle:"codehandle:",contactid:"contactid:",phonenumber:"phonenumber:"},X={metricPrefix:"PayPage-COD-OTP-",block:"Block",send:"Send",verify:"Verify",resend:"ReSend",changeNumber:"ChangeNumber"},aa={"SERVICE-FAILED":m,"SEND-SUCCESS":d,"VERIFY-SUCCESS":function(){A.addClass(F.aokHidden);
v.addClass(F.aokHidden);z.find(F.verifiedOTPSuccess).removeClass(F.aokHidden);z.find("."+F.phonenumberNotVerified).removeClass(F.phonenumberNotVerified);M&&k.setContinueButtonStatus(!0)},"INVALID-NUMBER":function(){z.find(F.invalidPhoneNumber).removeClass(F.aokHidden)},"NUMBER-ALREADY-USED":function(){e(p,!0);e(u,!0);z.find(F.numberAlreadyUsed).removeClass(F.aokHidden)},"MAX-OTP-REACHED":function(){z.find(F.maxOTPError).removeClass(F.aokHidden);e(p,!0)},"INVALID-OTP":function(){z.find(F.invalidOTPError).removeClass(F.aokHidden);
D.val("");M?D.attr("placeholder","Re-enter OTP"):(z.find(F.enterOTPLabel).addClass(F.aokHidden),z.find(F.reEnterOTPLabel).removeClass(F.aokHidden))},DEFAULT:m};a.on("checkout:reload:payselect",b);a.on("checkout:reload:spp-payment",b)});"use strict";q.when("A","pay-common-util","ready").execute(function(a,k){var g={productGls:"#productGls",gcTypes:"#gcDeliveryTypes",device:"#device"},b=k.getElements(g);a.on("checkout:payment:challenge:log",function(e){var f={},k;for(k in g)g.hasOwnProperty(k)&&b[k]&&
b[k].val()&&(f[k]=b[k].val());e&&(f.paymentInstrumentId=e);Object.keys&&Object.keys(f).length&&a.ajax("/gp/buy/payselect/handlers/log-payment-challenge.html?ref_\x3dcheckout-payment-challenge",{method:"POST",params:f,timeout:1E3,cache:!1})})});"use strict";q.when("A","page-spinner-controller","page-main","page-transition-controller","page-conductor","client-side-metrics","button-blocker","ready").register("pay-auth",function(a,k,g,b,e,f,m){function d(){var a=l("#otp_id").val(),b=/^\d{6}$/;a&&b.test(a)?
m.hide("pay-auth-otp-checks"):(a=l("#otp_invalid_msg").val(),m.show("pay-auth-otp-checks",a))}function n(b,c){k.show();a.ajax("validate-otp.html",{method:"post",params:{otp_name:b,paystationRequestId:c},success:function(a){!a||"APPROVED"!==a.status&&"PENDING"!==a.status?(l("#otp_id").addClass("a-form-error"),l("#otpBadCode").removeClass("hidden"),k.hide()):(l("#isFormValidated").val("1"),p.submit())},error:function(a){k.hide()}})}function h(){l("#otp_id").removeClass("a-form-error");l("#otpBadCode").addClass("hidden")}
function c(){f.increaseCount(z.metricPrefix+z.resend,1,1);var b="1"===l("#isPaystationFlow").val(),c;b?(c="resend-otp.html?returnHtml\x3d0\x26isPaystationFlow\x3d1",k.show()):c="resend-otp.html?returnHtml\x3d0";a.ajax(c,{method:"get",success:function(a){b&&(a&&1===a.successful&&(l("#authSourceId").val(a.authSourceId),l("#paystationRequestId").val(a.paystationRequestId)),k.hide())},error:function(a){b&&k.hide()}})}var l=a.$,t,p,z={metricPrefix:"Payauth-",resend:"Resend"};a.on("checkout:reload:payauth",
function(){t=l("#resend_form");p=l("#otp_form");p.submit(function(a){var b=l(a.currentTarget);if("1"===b.find('input[id\x3d"isPaystationFlow"]').val()&&(h(),"1"!==b.find('input[id\x3d"isFormValidated"]').val()))return a=b.find('input[id\x3d"otp_id"]').val(),b=b.find('input[id\x3d"paystationRequestId"]').val(),n(a,b),!1});t.submit(function(a){"1"===l("#isPaystationFlow").val()&&h();c();return!1});d();l("#otp_id").unbind("keyup").bind("keyup",d)})});"use strict";q.when("A","ajax-utility","client-side-metrics",
"loading-spinner-controller","pay-common-lib","pay-common-util","page-conductor","page-transition-controller","quantity-service","weblab-helper").register("pay-gil",function(a,k,g,b,e,f,m,d,n,h){function c(a){L=a.popover;var b=r(L);q("#gil-estimates-popover-"+b+" .gil-popover-content").html("");q("#gil-estimates-popover-"+b+" .gil-popover-error").html("");a.popover.updatePosition(!0)}function l(a){L=a.popover;var c=r(L),d=q("#gil-estimates-popover-"+c);d.find("input[name\x3dgil-subtype]").val(c);
b.showSpinner(d,!1,L);a="/gp/buy/payselect/handlers/get-gil-popover-content.html?cachebuster\x3d"+(new Date).getTime();var e="hasWorkingJavascript\x3d1\x26subtype\x3d"+encodeURIComponent(c);q.ajax({type:"POST",url:a,data:e,dataType:"text",async:!0,cache:!1,dataFilter:function(a){return k.jsonify(a)},success:function(a,e,f){r(L)===c&&(g.increaseCount("Checkout:GIL:"+c+":IneligiblePopoverSuccess",1),e=L,b.hideSpinner(d),a&&a.errors&&0<a.errors.length?d.find(".gil-popover-error").show():a&&a.widgetHTML?
d.find(".gil-popover-content").html(decodeURIComponent(a.widgetHTML)):d.find(".gil-popover-error").show(),e.updatePosition(!0))},error:function(a){r(L)===c&&(g.increaseCount("Checkout:GIL:"+c+":IneligiblePopoverError",1),a=L,b.hideSpinner(d),d.find(".gil-popover-error").show(),a.updatePosition(!0))}})}function t(a){a.$event.preventDefault();a.$target.closest(".a-popover").find(".a-button-close").trigger("click")}function p(a){a.$event.preventDefault();var c=r(L),e=q("#gil-estimates-popover-"+c);b.showSpinner(e,
!1,L);var f=z(a.$currentTarget.parents("#gil-estimates-popover-"+c));b.showSpinner(e,!1,L);n.callBatch(f,{success:function(b,e,f){r(L)===c&&(g.increaseCount("Checkout:GIL:"+c+":SubmitIneligiblePopoverSuccess",1),t(a),d.show(),1==parseInt(q("input[name\x3d'gil-rendered-using-apx']").val(),10)&&h.isGILCreditCardEnabled()?(b=q(".pmts-select-payment-instrument-form"),e=L,"APX_PSP_TO_RCX_SPC"==(e.attrs?e.attrs("data").onSubmit:e.data.onSubmit)&&b&&0<b.length?m.continueClicked(null,b):g.increaseCount("Checkout:GIL:"+
c+"Popover:ErrorRedirectingToSPC",1)):A(c))},error:function(a){r(L)===c&&(g.increaseCount("Checkout:GIL:"+c+":SubmitIneligiblePopoverError",1),a=L,b.hideSpinner(e),e.find(".gil-popover-error").show(),a.updatePosition(!0))},isTrial:0})}function z(a){var b={};a.find(".gil-ineligible-items").children(".gil-ineligible-item").each(function(a,c){a=q(c).find('input[name^\x3d"ineligible-item"]').val();b[a]=0});return b}function v(a){a.$event.preventDefault();var b=q("#gil-ineligible-"+a.data.subtype).find(".gil-ineligible-items"),
c=b.data("index"),d=b.data("size"),c=(c+("next"===a.data.direction?1:-1)+d)%d,d=(c+1)%d;b.find(".gil-ineligible-item").addClass("aok-hidden").removeClass("a-span-last");a=b.find("#gil-ineligible-item-"+c);d=b.find("#gil-ineligible-item-"+d);a.removeClass("aok-hidden");d.addClass("a-span-last").removeClass("aok-hidden");b.data("index",c)}function A(b){f.makeAjaxCall("/gp/buy/payselect/handlers/submit.html",{handler:"new-gil-payment",subtype:b},{successHandler:function(c,d,e){g.increaseCount("Checkout:GIL:"+
b+":NewToExistingSuccess",1);m.ajaxUpdatePage(c,d,e);f.scrollTopTo(q("#existing-payment-methods [value\x3d"+b+"]"));if(m.isSPP())a.on("checkout:afterReload",function N(){q("#existing-gil input[value\x3d"+b+"]").trigger("click");a.off("checkout:afterReload",N)});else q("#existing-gil input[value\x3d"+b+"]").trigger("click")},errorHandler:function(a,c,d){g.increaseCount("Checkout:GIL:"+b+":NewToExistingError",1);m.ajaxUpdatePage(a,c,d)}})}function r(a){return a.attrs?a.attrs("data").subtype:a.data.subtype}
function u(){x&&(a.declarative("gil-close-popover",["click"],t),a.declarative("gil-submit-popover",["click"],p),a.declarative("gil-ineligible-pagination",["click"],v));q("#gil-cc-payment-type").length&&(a.off("a:popover:beforeShow:gil-estimates",c),a.off("a:popover:show:gil-estimates",l),a.on("a:popover:beforeShow:gil-estimates",c),a.on("a:popover:show:gil-estimates",l));q("#gil-payment-type").length&&(a.off("a:popover:beforeShow:gil-si-estimates",c),a.off("a:popover:show:gil-si-estimates",l),a.on("a:popover:beforeShow:gil-si-estimates",
c),a.on("a:popover:show:gil-si-estimates",l));x=!1}var q=a.$,x=!0,L;a.on("checkout:reload:payselect",u);a.on("checkout:reload:spp-payment",u);return{submitNewGilPayment:A,displayGILEstimatesMobile:function(a,b,c){var d="/gp/buy/payselect/handlers/get-gil-popover-content.html?cachebuster\x3d"+(new Date).getTime(),e="hasWorkingJavascript\x3d1\x26subtype\x3d"+encodeURIComponent(a);f.makeAjaxCall(d,e,{successHandler:function(c,d,e){var f=k.jsonify(c);f&&!f.errors&&f.widgetHTML?g.increaseCount("Checkout:GIL:"+
a+":Mobile:IneligibleSubPageSuccess",1):g.increaseCount("Checkout:GIL:"+a+":Mobile:IneligibleSubPageError",1);b(c,d,e)},errorHandler:function(b){g.increaseCount("Checkout:GIL:"+a+":Mobile:IneligibleSubPageError",1);c(b)}})},actionCloseGilMobileSubpage:function(a){a.$event.preventDefault();q("#gil-estimates-subpage").remove();q(f.pages.main.pageId).show()},actionSubmitGilMobileSubpage:function(a,b,c){a.$event.preventDefault();q("#gil-ineligible-view");var d=z(a.$currentTarget.parents("#gil-ineligible-view"));
n.callBatch(d,{success:function(c,d,e){g.increaseCount("Checkout:GIL:"+a.data.subtype+":Mobile:SubmitIneligibleSubPageSuccess",1);b(c,d,e)},error:function(b){g.increaseCount("Checkout:GIL:"+a.data.subtype+":Mobile:SubmitIneligibleSubPageError",1);c(b)},isTrial:0})}}});"use strict";q.when("A","ready").register("new-verified-debit-card",function(a){});"use strict";q.when().register("recommendation-helper",function(){return{}});"use strict";q.when("A").register("apb-limit-messaging-helper",function(a){return{}});
"use strict";q.when("A","jQuery","client-side-metrics","ready").register("temporary-preference-indicator",function(a,k,g){function b(){e()&&k.ajax({type:"GET",url:"/gp/shopwithpoints/temporaryPreference/has-active-temporary-preference.html",async:!0,dataType:"json",success:function(a){a.hasOwnProperty("Result")?(f=a.Result,g.increaseCount("Checkout::PayPage::TemporaryPaymentPreferenceIndicator::Ajax::Success",1),g.increaseCount("Checkout::PayPage::TemporaryPaymentPreferenceIndicator::TPPCheckBackendCall::Success",
1)):g.increaseCount("Checkout::PayPage::TemporaryPaymentPreferenceIndicator::TPPCheckBackendCall::Failure",1)},error:function(){g.increaseCount("Checkout::PayPage::TemporaryPaymentPreferenceIndicator::Ajax::Failure",1)}})}function e(){return"1"===k("meta[name\x3dSWP_TPP_FEATURE_ENABLED]").attr("content")}var f="False";a.on("checkout:reload:payselect",b);a.on("checkout:reload:spp-payment",b);a.on("checkout:reload:pay",b);return{hasActiveTemporaryPreference:function(){return"True"===f},isTemporaryPaymentPreferenceFeatureEnabled:e}});
q.when().register("rentals-ineligible-util",function(){return{}});"use strict";q.when().register("rentals-ineligible",function(){return{}});"use strict";q.when("A","cvf","page-detector","weblab-helper","ready").register("cvf-old-amazon-aui-fixes",function(a,k,g,b){function e(){a.$(".cvf-widget-form .a-button-dropdown .a-button-text").css("text-overflow","unset")}function f(){var a=l(this).parent(),b=a.find(".a-native-dropdown option")[0];if(b&&b.hasAttribute("data-a-html-content")){var c=[];a.find(".cvf-widget-input.a-native-dropdown option").each(function(){c.push({phone_country_code:l(this).data("a-html-content"),
country_iso:l(this).val()})});var d=setInterval(function(){if(l(".a-popover-inner ul").length){var a="rtl"===l("html").attr("dir");l(".a-popover-inner ul").addClass("a-cvf-list-link");l.each(c,function(b,c){if(b=c.phone_country_code){if(a){b=b.split("+");var d=b[1];b=b[0].trim()+" "+d+"+"}l(".a-popover-inner [data-value\x3d'"+c.country_iso+"']").html(b)}});clearInterval(d)}},0)}l(".cvf-widget-form .a-button-dropdown").die("click")}function m(){var a=l(this).data("value");l(".cvf-widget-form .a-native-dropdown.cvf-widget-input").val(a).change()}
function d(){var a=l(this).parent().find(".a-dropdown-prompt"),b=l(this).find("option:selected").html().trim(),c=setTimeout(function(){a.html(b);clearTimeout(c)},0)}function n(){a.$(".cvf-widget-form .a-alert-inline.cvf-hidden").remove()}function h(){0===l(".cvf-widget-form").length&&(l("#apx-content .a-alert-info").first().remove(),l("[data-testid\x3d'pmts-cod-cash-description']").closest(".pmts-portal-component").find(".a-radio input").trigger("click"))}function c(){if(!t)if(w)a.on("a:pageUpdate a:ajax:complete",
n);else a.on("a:pageUpdate a:ajax:complete",e),l(".cvf-widget-form .a-button-dropdown").live("click",f),l(".a-cvf-list-link a").live("click",m),l(".cvf-widget-input.a-native-dropdown").live("change",d);a.on("cvf:verification:complete",h)}var l=a.$,t=g.isMobile(),w=p.P&&p.P.AUI_BUILD_DATE;b.isCvfOldAmazonUiFixesEnabled()&&(a.on("checkout:reload:payselect",c),a.on("checkout:reload:spp-payment",c))});"use strict";q.when("A","page-detector").register("alipay-detector",function(a,k){var g=a.$,b=function(){var a=
g("input[name\x3d'isAlipayAppPayment']");0<a.length&&k.isMobileSpc&&a.val("1")},e=function(a){},f=function(){var a=g("input[name\x3d'isAlipayRedirect']");0<a.length&&k.isMobileSpc&&a.val("1")},m=function(a){};a.on("checkout:reload:spc",function(){g("input[name\x3d'isAlipayAppPayment']").length&&q.when("safe-mash").execute(function(a){a=p.cordova.require("cordova/exec");a(b,e,"AlipayPlugin","isAlipayInstalled",[]);g("input[name\x3d'isAlipayRedirect']").length&&a(f,m,"AlipayPlugin","isAlipayFailReturnSupported",
[])})})});"use strict";q.when("A","page-transition-controller","page-detector").execute(function(a,k,g){function b(){var a=e("#backButtonProtection");a.length&&"1"===a.val()&&(k.showPageTransition(),document.location.reload())}var e=a.$;q.register("back-button-protection",function(){return{markAsDirty:function(){e("#backButtonProtection").val(1)}}});a.on("checkout:reload:spc",b);a.on("checkout:reload:spp-revieworder",b)});"use strict";q.when("A","page-transition-controller","loading-spinner-controller",
"ajax-utility","page-conductor","checkout-general-utils","page-detector","client-side-metrics","delivery-preferences-csm-helper").register("delivery-preferences-controller",function(a,k,g,b,e,f,m,d,n){function h(){m.isTabletSpc()&&(u=r("#spc-orders .delivery-preferences-options"),v(),u.find("select").trigger("change"),p())}function c(){var a=u.find("input[name\x3dpreference]:checked").val(),b=u.find("select[name\x3dSafePlaceLocation]");"NeighborDelivery"===a?(u.find("input[name\x3dneighbor-name]").removeAttr("disabled").removeClass("a-form-disabled"),
u.find("input[name\x3dneighbor-house]").removeAttr("disabled").removeClass("a-form-disabled"),e.isSPP()?q.when("a-dropdown").execute(function(a){a.getSelect(b).update({status:"disabled"})}):b.attr("disabled","disabled").closest(".a-button").addClass("a-button-disabled"),u.find(".safe-place-error").hide()):"SafePlaceDelivery"===a?(e.isSPP()?q.when("a-dropdown").execute(function(a){a.getSelect(b).update({status:"enabled"})}):b.removeAttr("disabled").closest(".a-button").removeClass("a-button-disabled"),
u.find("input[name\x3dneighbor-name]").attr("disabled","disabled").addClass("a-form-disabled"),u.find("input[name\x3dneighbor-house]").attr("disabled","disabled").addClass("a-form-disabled"),u.find(".neighbor-name-error").hide(),u.find(".neighbor-house-error").hide()):(u.find("input[name\x3dneighbor-name]").attr("disabled","disabled").addClass("a-form-disabled"),u.find("input[name\x3dneighbor-house]").attr("disabled","disabled").addClass("a-form-disabled"),e.isSPP()?q.when("a-dropdown").execute(function(a){a.getSelect(b).update({status:"disabled"})}):
b.attr("disabled","disabled").closest(".a-button").addClass("a-button-disabled"),u.find(".neighbor-name-error").hide(),u.find(".neighbor-house-error").hide(),u.find(".safe-place-error").hide());l(!0)}function l(a){var b=u.find("input[name\x3dpreference]:checked").val();u.find(".safe-place-error").hide();u.find(".neighbor-name-error").hide();u.find(".neighbor-house-error").hide();u.find("input").removeClass("a-form-error");u.find("div.a-input-text-wrapper").removeClass("a-form-error");u.find("select").closest(".a-button").removeClass("a-button-error");
0<r("div.spc-tablet").length?u.find(".set-delivery-preferences-button").removeClass("a-button-disabled"):u.find(".set-delivery-preferences-button").show();u.find(".save-disabled").hide();u.find(".current-blocker-content").text("");var c=!1;if("NeighborDelivery"===b){var d=u.find("input[name\x3dneighbor-name]");d.data("defaultValueRemoved")&&d.val()||(u.find(".neighbor-name-error").show(),d.addClass("a-form-error"),d.closest(".a-input-text-wrapper").addClass("a-form-error"),u.find(".current-blocker-content").html(u.find(".neighbor-name-error-text").text()),
c=!0);d=u.find("input[name\x3dneighbor-house]");d.data("defaultValueRemoved")&&d.val()||(u.find(".neighbor-house-error").show(),d.addClass("a-form-error"),d.closest(".a-input-text-wrapper").addClass("a-form-error"),u.find(".current-blocker-content").html(u.find(".neighbor-house-error-text").text()),c=!0)}else"SafePlaceDelivery"===b&&(d=u.find("select[name\x3dSafePlaceLocation]"),d.val()||(u.find(".safe-place-error").show(),d.closest(".a-button").addClass("a-button-error"),u.find(".current-blocker-content").html(u.find(".safe-place-error-text").text()),
c=!0));d=r("#disableSaveBtnWhenNoDeliveryPrefSelected").val();if(a&&c||"true"===d&&b===C)0<r("div.spc-tablet").length?u.find(".set-delivery-preferences-button").addClass("a-button-disabled"):u.find(".set-delivery-preferences-button").hide(),u.find(".save-disabled").show();return!c}function t(a){a&&a.$event&&a.$event.preventDefault();a="hasWorkingJavascript\x3d1\x26returnFullHTML\x3d1\x26cachebuster\x3d"+(new Date).getTime()+"\x26";var c="",f=u.find(".popover-deliv-prefs-content");f.data("obfuscatedEntityId")?
c=f.data("obfuscatedEntityId"):u.data("obfuscatedEntityId")&&(c=u.data("obfuscatedEntityId"));a+="obfuscatedEntityId\x3d"+c+"\x26";c=u.find("input[name\x3dpreference]:checked").val();""!==c&&(a+="prefDelLocation\x3d"+c+"\x26","NeighborDelivery"===c?(a+="neighborName\x3d"+encodeURIComponent(u.find("input[name\x3dneighbor-name]").val())+"\x26",a+="houseNo\x3d"+encodeURIComponent(u.find("input[name\x3dneighbor-house]").val())+"\x26"):"SafePlaceDelivery"===c&&(a+="safePlaceLocation\x3d"+u.find("select[name\x3dSafePlaceLocation]").val()+
"\x26"),c=u.find("input[name\x3ddefaultPreference]:checked").val(),c!==C&&""!==c&&(a+="isDefaultPreference\x3d1"));0<r("div.spc-tablet").length?k.show():g.showSpinner(u.find(".popover-deliv-prefs-content"),!1,K);n.recordCSMWithCurrentFieldValues("popover-submitted","preference","defaultPreference");r.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/update-delivery-preference.html",data:a,dataType:"text",contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc",
"x-amz-checkout-transition":"ajax"},success:function(a,c,f){x=!0;0<r("div.spc-tablet").length?k.hide():g.hideSpinner(u.find(".popover-deliv-prefs-content"));f.getResponseHeader("x-amz-checkout-page")?(u.find(".a-button-close").trigger("click"),e.ajaxUpdatePage(a,c,f)):(a=b.jsonify(a),e.redirect(a));d.increaseCount("checkoutSpcDeliveryPref-save",1)},error:function(a,b,c){0<r("div.spc-tablet").length?k.hide():g.hideSpinner(u.find(".popover-deliv-prefs-content"));l(!0)}})}function p(){u.find("input[name\x3d'neighbor-name'], input[name\x3d'neighbor-house']").unbind("focus").bind("focus",
function(){if(!r(this).data("defaultValueRemoved")){if(m.isMobileSpc()||m.isDesktopSpc())r(this).val(""),r(this).css("color","black");r(this).data("defaultValueRemoved",!0)}}).each(function(){(m.isMobileSpc()||m.isDesktopSpc())&&r(this).data("defaultValueRemoved")&&r(this).css("color","black")});u.find("input:radio[name\x3dpreference]").unbind("click").bind("click",c);u.find("input[name^\x3dneighbor]").unbind("keyup").bind("keyup",function(){l(!1)});0<r("div.spc-tablet").length?u.find("select[name\x3dSafePlaceLocation]").unbind("change").bind("change",
z):u.find("select[name\x3dSafePlaceLocation]").unbind("change").bind("change",function(){l(!1)})}function z(a){l(!0)&&t(a)}function v(a){var b=r("#spc-orders .delivery-preferences-options"),c,d="";a?(c=a.$currentTarget.find("input"),d=b.find("input[name\x3dpreference]:checked").val()):c=b.find("input[name\x3dpreference]:checked");b=c.val();if(d!==b){u.find(".expand-content").hide();var d=c,e=d.closest(".delivery-preferences-options");e.find("i.a-icon-touch-radio-active").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive");
e.find("input").attr("checked",!1);d.siblings("i").addClass("a-icon-touch-radio-active").removeClass("a-icon-touch-radio-inactive");d.attr("checked",!0);"NeighborDelivery"===b||"SafePlaceDelivery"===b?c.closest(".deliverypreference-option").siblings(".expand-content").show():a&&t(a)}}function A(a){(a=u.find("#delivery-preferences-set-default-checkbox"))&&1===a.length&&(a.prop("checked")?d.increaseCount("checkoutSpcDeliveryPref-setAsDefault",1):d.increaseCount("checkoutSpcDeliveryPref-setAsTemporary",
1))}var r=a.$;if(!r("html").hasClass("a-ie6")){var u,K,x;a.on("a:popover:beforeShow",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("button-blocker-delivprefs")&&(a.popover.$popover.find(".a-popover-inner").html(u.find(".current-blocker-content").text()),a.popover.updatePosition())});a.on("a:popover:show",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("deliv-prefs")&&(d.increaseCount("checkoutSpcDeliveryPref-open",1),K=a.popover,u=K.$popover,x=!1,p(),n.recordCSMWithCurrentFieldValues("popover-displayed",
"preference","defaultPreference"),c(),u.find("select").trigger("change"))});a.on("a:popover:dismiss",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("deliv-prefs")&&(x||d.increaseCount("checkoutSpcDeliveryPref-dismissed",1))});a.on("a:popover:hide",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("deliv-prefs")&&(x||n.recordCSM("popover-dismissed"))});a.declarative("delivery-preferences-switch-tablet",["click"],function(a){v(a)});a.declarative("delivery-preferences-expander-toggle",
["click"],function(a){f.toggleExpanderContent(a)});a.declarative("set-delivery-preferences",["click","touchend"],function(a){a.$event.preventDefault();f.protectAgainstDoubleAction("set-delivery-preferences")||l(!0)&&t()});a.declarative("delivery-preferences-set-default-checkbox-triggered","change",A);a.on("checkout:reload:spc",h)}});"use strict";q.when("A","page-detector","time-left-formatter").register("fast-track-controller",function(a,k,g){function b(){for(var b in t)t[b]&&clearInterval(t[b]);
a.defer(e)}function e(){c.DAY=h("#fasttrack-day").html();c.DAYS=h("#fasttrack-days").html();c.HOUR=h("#fasttrack-hour").html();c.HOURS=h("#fasttrack-hours").html();c.AND=h("#fasttrack-and").html();c.MINUTE=h("#fasttrack-minute").html();c.MINUTES=h("#fasttrack-minutes").html();c.SECOND=h("#fasttrack-second").html();c.SECONDS=h("#fasttrack-seconds").html();(h("#isfresh").length&&h(".checkout.spc-mobile").length||h("#lazy-fresh-promise-delivery-message").length?h("#spc-form"):h("#spc-orders")).find(".fasttrack-span").each(function(){var b=
h(this),c=b.find("input[name\x3d'countdownId']").val();l[c]=parseInt(b.find("input[name\x3d'fasttrackExpiration']").val());p[c]=a.now()/1E3+l[c];f(b.find("input[name\x3d'countdownThreshold']").val(),b,b.find("input[name\x3d'showSimplifiedCountdown']").val(),c);b.show()})}function f(a,b,c,e){0>=l[e]?d(b,null):a&&0<a&&l[e]>a?b.find("span.fasttrackavailable").hide():(m(b,c),t[e]=setInterval(function(){m(b,c,e)},1E3))}function m(b,e,f){0<l[f]?(l[f]=Math.round(p[f]-a.now()/1E3),e=g.getTimeLeftFormatted(l[f],
1===e||"1"===e?!0:!1,c),h("html").hasClass("a-tablet")?b.find("span[data-field\x3d'fasttrackcountdown']").html("\x26nbsp;"+e):b.find("span[data-field\x3d'fasttrackcountdown']").html(e),b.find("span.fasttrackexpired").hide(),b.find("span.fasttrackcountdown").show(),b.find("span.fasttrackavailable").show()):d(b,f)}function d(a,b){b?(t[b]&&clearInterval(t[b]),a.find("span.fasttrackavailable").hide(),a.find("span.fasttrackexpired").show()):clearInterval(t[b])}function n(){b()}var h=a.$;if(!h("html").hasClass("a-ie6")){var c=
{},l={},t={},p={};a.on("checkout:reload:spc",b);a.on("checkout:reload:spp-revieworder",b);return{spcLiteLazyLoadFastTrack:n}}});"use strict";q.when("A","page-transition-controller","ajax-utility","page-conductor","client-side-metrics").register("gc-redeem-controller",function(a,k,g,b,e){function f(a){if(!t){a.preventDefault();l(a.currentTarget);var c;0<l("#spc-gcpromoinput").length&&(c=encodeURIComponent(l("#spc-gcpromoinput").val()));0<l("#gc-promo-input").length&&(c=encodeURIComponent(l("#gc-promo-input").val()));
var d=encodeURIComponent(l("#spc-usePromoOnly").val());if(c&&0!==c.length){var e=encodeURIComponent(l("input[name\x3dpurchaseTotal]").val());l("#gc-error").hide();l("#gc-promo-success").hide();l("#gc-success").hide();l("#gc-ineligible").hide();l("#promo-success").hide();b.isSPP()?(k.blockAllActions(),k.showTransitionInContainer(l("#payment"))):k.show();var f=(new Date).getTime();a="/gp/buy/spc/handlers/add-giftcard-promotion.html/ref\x3dox_pay_page_gc_add";l(".checkout.spc.aui-templatized").length&&
(a="/gp/buy/spc/handlers/add-giftcard-promotion.html/ref\x3dox_spc_gc_add");c="purchaseTotal\x3d"+e+"\x26claimcode\x3d"+c+"\x26disablegc\x3d"+d+"\x26returnjson\x3d1\x26returnFullHTML\x3d1\x26hasWorkingJavascript\x3d1\x26fromAnywhere\x3d"+l("input[name\x3dfromAnywhere]").val()+"\x26cachebuster\x3d"+f;d=b.setAjaxTransitionHeader({"Cache-Control":"no-cache",pragma:"no-cache","x-amz-checkout-page":"spc"});l.ajax({type:"POST",url:a,data:c,headers:d,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",
dataType:"text",complete:function(){t=!1},success:m,error:b.ajaxRedirect});t=!0}else n("addGiftCardOrPromo_NoCode")}}function m(a,c,e){var f=e.getResponseHeader("x-amz-checkout-page");if(f){if(b.ajaxUpdatePage(a,c,e),"spc"===f||"spclite"===f||"spp-revieworder"===f)(a=parseInt(l("#checkoutDisplayPage").data("delaySetTitle"),10)||parseInt(l("#gc-promo-delay").data("egcDelayUpdateRedemptionMessage"),10)||0)?setTimeout(function(){d(e)},a):d(e)}else{a=g.jsonify(a);if(!a)return b.redirect();if(a.error)return n(a.error);
if(a.errors)return n(a.errors);if(a.autohandlererror)return h(a.autohandlererror);b.redirect(a)}}function d(a){var b=a.getResponseHeader("x-updated-promo-type");a=a.getResponseHeader("x-updated-gc-applied-but-ineligible");b&&(a||l("#gc-promo-success").show(),0<l("div.spc-desktop").length?(l("#spc-gcpromoinput").removeClass("a-form-error"),l("#gc-promo-input").removeClass("a-form-error")):(l("#spc-gcpromoinput").closest(".a-input-text-wrapper").removeClass("a-form-error"),l("#gc-promo-input").closest(".a-input-text-wrapper").removeClass("a-form-error")),
"giftcard"===b?(c("applied"),a?(l("#gc-ineligible").show(),c("gcIneligible")):l("#gc-success").show()):l("#promo-success").show())}function n(a){k.hide();l("#gc-error p").hide();l("#gc-error").show();c("error");0<l("div.spc-desktop").length?(l("#spc-gcpromoinput").addClass("a-form-error"),l("#gc-promo-input").addClass("a-form-error")):(l("#spc-gcpromoinput").closest(".a-input-text-wrapper").addClass("a-form-error"),l("#gc-promo-input").closest(".a-input-text-wrapper").addClass("a-form-error"));l(0<
l("#gc-promo-input").length?"."+w[a]:"#"+a).show()}function h(a){if(a){var b=a.action,c="/gp/buy/payselect/handlers/error.html?errorType\x3d"+encodeURIComponent(a.type?a.type:b&&b.code?b.code:"string"===typeof a?a:"Unknown:pipelineJSError");"fatal"===b?c+="\x26errorAction\x3dfatal":"redirect"===b&&(a.url?c=a.url:"cart"===a.page&&(c="/gp/cart/view.html"));p.location.href=c}else p.location.href="/gp/buy/payselect/handlers/error.html?errorType\x3dUnknown:pipelineJSError"}function c(b){var c=a.state("cxt-gc-redemption-method").method;
e.increaseCount("rcxGCRedeem:"+c+":"+b,1)}var l=a.$,t=!1;if(!l("html").hasClass("a-ie6")){a.state("cxt-gc-redemption-method",{method:"type"});var w={addGiftCardOrPromo_Unknown:"UNKNOWN",addGiftCardOrPromo_NoCode:"NO_CODE",addPromo_InvalidForPurchase:"PROMO_INVALID_FOR_PURCHASE",addPromo_BadCode:"PROMO_BAD_CODE",addPromo_ExpiredCode:"PROMO_EXPIRED_CODE",addPromo_InvalidForOrgUnit:"PROMO_INVALID_FOR_ORG_UNIT",addPromo_OfferNotYetBegun:"USED_BEFORE_START_DATE",addPromo_AlreadyRedeemed:"PROMO_ALREADY_REDEEMED",
addGiftCard_AlreadyRedeemedByAnotherAccount:"GC_ALREADY_REDEEMED_BY_ANOTHER_ACCOUNT",addGiftCard_AlreadyRedeemedByThisAccount:"GC_ALREADY_REDEEMED_BY_THIS_ACCOUNT",addGiftCard_BadCode:"GC_BAD_CODE",addGiftCard_ExpiredCode:"GC_EXPIRED_CODE",addGiftCard_Cancelled:"CANCELLED_CODE",addGiftCard_WrongOrgUnit:"GC_WRONG_ORG_UNIT",addGiftCard_ServiceDown:"GC_SERVICE_DOWN",addGiftCard_InvalidForAGS:"GC_INVALID_FOR_AGS",addGiftCard_PassedClaimByDate:"PASSED_CLAIM_BY_DATE",addGiftCard_OfferNotYetBegun:"GC_NOT_YET_BEGUN",
addGiftCard_ExceededMaxLimit:"GC_EXCEED_MAX_LIMIT",addGiftCard_Disabled:"GC_DISABLED",addGiftCard_OTP_Required:"GC_OTP_REQUIRED",addGiftCard_SEVIS_Decline:"GC_SEVIS_DECLINE",addGiftCard_OCRAH_Decline:"GC_OCRAH_DECLINE",addGiftCard_DEFAULT_Message:"GC_DEFAULT_MESSAGE"};a.declarative("gc-element",["click"],function(a){var b=a.data.click;b&&null!==b&&f(a.$event)});a.on("a:expander:redeem-gc-expander:toggle:expand",function(a){e.increaseCount("checkout:spp-payment:expand_addgc_coll",1)});l(document).delegate("#spc-gcpromoinput, #gc-promo-input",
"keypress",function(a){13===a.which&&f(a)});return{actionAddGiftPromotion:f,giftSystemErrorHandling:h}}});"use strict";q.when("A","page-transition-controller","loading-spinner-controller","ajax-utility","page-conductor","checkout-general-utils","page-detector","client-side-metrics","gift-utility","weblab-helper").register("gift-popover-controller",function(a,k,g,b,e,f,m,d,n,h){function c(){var a=V;a.find("#select-recipient").empty();for(var b=0;b<ja.length;b++){var c=J("\x3coption/\x3e").attr({value:ja[b].value}).text(ja[b].text);
a.find("#select-recipient").append(c)}ua&&(b=a.find('#select-recipient option[value\x3d"'+ua+'"]').attr("selected","selected"),a.find("#select-recipient").closest("#popover-gift-connection-recipient").find(".a-placeholder").text(b.text()),da())}function l(){a.defer(function(){J("#spc-orders").find(".gift-popover-link").each(function(){J(this).data("action")&&J(this).removeAttr("href").attr("tabindex",0)})});J(".larger-image-link").find("a").removeAttr("href")}function t(a){var b=V;b.find(".gift-error-box").hide();
b.find(".fake-label").each(function(){J(this).unbind("click").bind("click",function(){J(this).closest(".popover-checkbox").find("input").trigger("click")})});a&&a.item&&a.item.title&&b.find(".popover-gift-top .gift-item-title span").html(a.item.title);a&&a.item&&a.item.isAutoripEligible?b.find("#gift-autorip-unavailable-msg").show():b.find("#gift-autorip-unavailable-msg").hide();if(a&&a.obfuscatedEntityId){var d=b.find(".set-gift-options-button input");d.unbind("click").bind("click",{obfuscatedentityid:a.obfuscatedEntityId,
giftData:a},w);f.bindActionEnterKeyOnButton(d)}fa?(ia=a&&a.item&&a.item.isAmazonFulfilled,pa=!(a&&a.address&&0===a.address.shipToSelf),ia&&(a&&a.options&&a.options.canHaveMessage||a&&a.options&&a.options.canBeWrapped)?(A(!0),b.find(".mfn-hide-prices").hide(),b.find(".include-gift-receipt").show()):ia||(A(!0),b.find(".include-gift-receipt").hide(),b.find(".mfn-hide-prices").show(),b.find(".include-gift-message").show()),Fa=b.find(".include-gift-message").is(":visible"),L()):a&&a.options&&a.options.canHidePrices?
b.find(".hide-prices-checkbox").closest("div").show():b.find(".hide-prices-checkbox").closest("div").hide();a&&a.selected&&(d=T(b.find(".hide-prices-checkbox")),a.selected.hidePrices?d.attr("checked",!0):d.removeAttr("checked"));if(a&&a.item&&a.item.purchaseIsKindle){if(d=b.find(".kindle-registration-box"),d.show(),d.find(".register-kindle-customer-name").html(b.find(".gift-customer-name").html()),!fa){var d=T(b.find(".kindle-reg-radio-another-account")),e=T(b.find(".kindle-reg-radio-your-account"));
a.selected.hidePrices||a.selected.isWrapped?(e.removeAttr("checked"),d.attr("checked",!0)):(d.removeAttr("checked"),e.attr("checked","checked"));T(b.find(".hide-prices-checkbox")).trigger("change")}}else b.find(".kindle-registration-box").hide();if(a&&a.options&&a.options.canHaveMessage){a&&a.selected&&(d=a.selected.message,e=T(b.find(".include-gift-message-checkbox")),d&&d.length?(b.find("textarea[name\x3d'gift-message-text']").val(d),u(!0)):null===d&&(a.selected.isWrapped||a.selected.hasReceipt)?
(e.removeAttr("checked"),b.find(".textarea[name\x3d'gift-message-text']").val("")):(b.find("textarea[name\x3d'gift-message-text']").val(""),d="",fa?(d+=b.find(".sample-gift-msg-greeting").html(),a&&a.address&&a.address.firstName&&!pa&&(d+=" "+a.address.firstName),d=d+",\n"+b.find(".sample-gift-msg").html(),d+="\n"):(d+=b.find(".sample-gift-msg").html(),d+="\n\n"),d+=b.find(".sample-gift-msg-from").text(),d=fa?d+n.getNameWithNoTitle(b.find(".gift-customer-name").html()):d+n.getFirstName(b.find(".gift-customer-name").html()),
b.find("textarea[name\x3d'gift-message-text']").val(d),!fa||pa&&Fa||u(!0)));var h=J(".gift-message-warning").length,d=function(){fa&&u(!0);N(a.options.maxMessageChars,a.options.maxMessageLines,a.options.hasFixedGiftMsgLimit);if(h){var b=V.find("textarea[name\x3d'gift-message-text']");n.toggleGiftMessageWarning(b,V)}};if(a&&a.options){var l=b.find("textarea[name\x3d'gift-message-text']");l.bind("keyup",d);l.bind("mouseup",d);N(a.options.maxMessageChars,a.options.maxMessageLines,a.options.hasFixedGiftMsgLimit);
h&&n.toggleGiftMessageWarning(l,b);T(b.find(".include-gift-message-checkbox")).bind("change",function(){var c=J(this).is(":checked"),d=a.options.maxMessageChars,e=a.options.maxMessageLines,f=a.options.hasFixedGiftMsgLimit,g=V,k=g.find("textarea[name\x3d'gift-message-text']");c?fa&&x():(0<g.find(".validateInputCharactersOnBlur.a-form-error").size()&&(g.find(".validateInputCharactersOnBlur.a-form-error").removeClass("a-form-error"),0<g.find("#onblur-character-validation-error-gift-message-text").size()&&
g.find("#onblur-character-validation-error-gift-message-text").remove()),fa?L():(k.val(""),N(d,e,f)));h&&n.toggleGiftMessageWarning(l,b)})}}else b.find(".popover-gift-message-text").css("visibility","hidden"),b.find(".include-gift-message").css("visibility","hidden"),fa&&(b.find(".include-gift-message").hide(),b.find(".popover-gift-message").css("visibility","hidden")),b.find(".popover-gift-message-not-available").show();a&&a.options&&!a.options.canBeWrapped?(b.find(".wrap-option").hide(),b.find(".popover-gift-no-wrap-available").show(),
b.find(".hide-prices-amazon-msg").hide(),b.find(".hide-prices-note").hide(),b.find(".hide-prices-merchant-msg").show(),T(b.find(".hide-prices-checkbox")).attr("disabled",!1)):a&&a.item&&a.item.isAmazonFulfilled?(b.find(".wrap-option").hide(),b.find(".popover-gift-fba-wrap").show(),b.find(".hide-prices-amazon-msg").show(),b.find(".hide-prices-merchant-msg").hide(),(d=a.options.wraps[0].imageurl)&&0<d.length&&(b.find(".large-preview").find("img").attr("src",d),b.find(".large-preview").show(),b.find(".fba-wrap-checkbox").show(),
e=b.find(".larger-image-link"),e.unbind("click").bind("click",{imageURL:d},Q),f.bindActionEnterKeyOnButton(e)),a.options.wraps[0].description&&b.find(".gift-wrap-title").show().html(a.options.wraps[0].description),"1"===J("#multipleAFNGiftWrapOption").val()?a.options&&a.options.wraps&&1<=a.options.wraps.length&&(d=b.find(".popover-gift-amazon-wrap"),q(b,d),Y(a,"afn",d)):a.options&&a.options.wraps&&1===a.options.wraps.length?(b.find(".popover-gift-amazon-wrap").hide(),b.find(".popover-gift-merchant-wrap").hide(),
b.find(".fba-wrap-checkbox .gift-wrap-price").html(a.options.wraps[0].price),e=T(b.find(".amazon-gift-wrap")),e.val(a.options.wraps[0].id),d=T(b.find(".hide-prices-checkbox")),a.selected.isWrapped?(e.attr("checked",!0),a.item.purchaseIsKindle||(d.attr("checked",!0),d.attr("disabled",!0),b.find(".hide-prices-note").show())):(e.removeAttr("checked"),d.attr("disabled",!1),b.find(".hide-prices-note").hide())):a.options&&a.options.wraps&&1<a.options.wraps.length&&(d=b.find(".popover-gift-amazon-wrap"),
q(b,d),ba(a,"afn",d))):(b.find(".wrap-option").hide(),T(b.find(".hide-prices-checkbox")).removeAttr("disabled"),b.find(".hide-prices-amazon-msg").hide(),b.find(".hide-prices-note").hide(),b.find(".hide-prices-merchant-msg").show(),b.find(".large-preview").hide(),d=b.find(".popover-gift-merchant-wrap").show(),d.find(".mfn-wrap-copy").remove(),ba(a,"mfn",d));fa&&(P(),G(),D());if(0<J(".enable-gift-connections").length){b.find("#popover-gift-connection select.a-touch-select-input").each(function(){J(this).unbind("change").bind("change",
function(){var a=J(this),b=a.siblings("a.a-placeholder"),a=a.find(":selected").text();b.text(a);return!1})});b.find("#select-recipient").bind("change",function(a){O(a);return!1});b.find("#select-occasion").bind("change",function(a){ra(a);return!1});b.find("#input-recipient-first-name").keyup(function(){da()});b.find("#input-recipient-last-name").keyup(function(){da()});b.find("#popover-gift-connection-recipient").unbind("click").bind("click",function(a){a=V;ta||a.find("#select-recipient-spinner").show()});
ua=C;if(a.giftConnection){typeof a.giftConnection.giftlistTypeId!==C&&"0"===a.giftConnection.giftlistTypeId&&typeof a.giftConnection.occasionId!==C&&"0"===a.giftConnection.occasionId&&b.find("#include-gift-connection-checkbox").attr("checked",!1);a.giftConnection.firstName&&b.find("#input-recipient-first-name").val(a.giftConnection.firstName);a.giftConnection.lastName&&b.find("#input-recipient-last-name").val(a.giftConnection.lastName);if("1"===a.giftConnection.giftlistTypeId||"2"===a.giftConnection.giftlistTypeId)d=
b.find('#select-recipient option[value\x3d"'+a.giftConnection.giftlistTypeId+'"]').attr("selected","selected"),b.find("#select-recipient").closest(".a-button-inner").find(".a-placeholder").text(d.text()),b.find(".gift-connection-recipient-extra").show();if(a.giftConnection.giftlistId&&"0"!==a.giftConnection.giftlistId)ua=a.giftConnection.giftlistId;else if("0"===a.giftConnection.giftlistTypeId||"1"===a.giftConnection.giftlistTypeId||"2"===a.giftConnection.giftlistTypeId)ua=a.giftConnection.giftlistTypeId;
a.giftConnection.occasionId&&(d=b.find('#select-occasion option[value\x3d"'+a.giftConnection.occasionId+'"]').attr("selected","selected"),b.find("#select-occasion").closest(".a-button-inner").find(".a-placeholder").text(d.text()));a.giftConnection.occasionMonth&&(d=b.find('#select-occasion-month option[value\x3d"'+a.giftConnection.occasionMonth+'"]').attr("selected","selected"),b.find("#select-occasion-month").closest(".a-button-inner").find(".a-placeholder").text(d.text()));a.giftConnection.occasionDay&&
(d=b.find('#select-occasion-day option[value\x3d"'+a.giftConnection.occasionDay+'"]').attr("selected","selected"),b.find("#select-occasion-day").closest(".a-button-inner").find(".a-placeholder").text(d.text()));a.giftConnection.age&&(d=b.find('#select-occasion-age option[value\x3d"'+a.giftConnection.age+'"]').attr("selected","selected"),b.find("#select-occasion-age").closest(".a-button-inner").find(".a-placeholder").text(d.text()));if("1"===a.giftConnection.occasionId||"2"===a.giftConnection.occasionId)b.find(".gift-connection-occasion-extra").show(),
"2"===a.giftConnection.giftlistTypeId&&b.find("#select-occasion-age-row").show();a.giftConnection.hasReminder&&"0"===a.giftConnection.hasReminder&&b.find("#occasion-has-reminder-checkbox").attr("checked",!1)}(!a.giftConnection||typeof a.giftConnection.occasionId===C||"1"!==a.giftConnection.occasionId&&"2"!==a.giftConnection.occasionId&&"3"!==a.giftConnection.occasionId)&&da();ja&&(typeof ua!==C||a.registryId in wa)?(typeof ua===C&&(ua=wa[a.registryId]),c(),b.find("#select-recipient").show(),b.find("#select-recipient-spinner").hide(),
ta=!0):(ta=!1,typeof ua!==C?sa():sa(a.registryId))}V.find(".content-container").css("visibility","visible");xa.updatePosition(!0);g.hideSpinner(b.find(".popover-content-main"))}function w(a){var c=V,d="";if(!(0<c.find(".validateInputCharactersOnBlur.a-form-error").size())){a&&a.data&&a.data.obfuscatedentityid&&(d+="obfuscatedEntityId\x3d"+a.data.obfuscatedentityid+"\x26");ia&&(d+="isAFN\x3d1\x26");T(c.find(".include-gift-receipt-checkbox")).is(":checked")&&(d+="includeReceipt\x3d1\x26");T(c.find(".include-gift-message-checkbox")).is(":checked")?
(d+="includeMessage\x3d1\x26message\x3d"+encodeURIComponent(c.find("textarea[name\x3d'gift-message-text']").val())+"\x26",d+="maxChars\x3d"+a.data.giftData.options.maxMessageChars+"\x26",d+="maxLines\x3d"+a.data.giftData.options.maxMessageLines+"\x26"):d+="includeMessage\x3d0\x26";d=T(c.find(".hide-prices-checkbox")).is(":checked")?d+"hidePrices\x3d1\x26":d+"hidePrices\x3d0\x26";c.find(".kindle-registration-box").is(":visible")&&(d+="isKindlePurchase\x3d1\x26");var f;if(c.find(".popover-gift-fba-wrap").is(":visible"))if(c.find(".popover-gift-amazon-wrap").is(":visible")){if((f=
c.find("input[name\x3d'afn-gift-wrap']:checked").eq(0).val())&&f.length)for(d+="giftWrap\x3d"+f+"\x26",f=0;f<a.data.giftData.options.wraps.length;f++)if(c.find(".popover-gift-amazon-wrap").find(".afn-wrap-"+f).is(":checked")){d+="currencyAmount\x3d"+a.data.giftData.options.wraps[f].priceAmount+"\x26";d+="currencyUnit\x3d"+a.data.giftData.options.wraps[f].unit+"\x26";break}}else f=T(c.find(".amazon-gift-wrap")),f.is(":checked")&&(d+="giftWrap\x3d"+f.val()+"\x26",a.data.giftData.options&&(d+="currencyAmount\x3d"+
a.data.giftData.options.wraps[0].priceAmount+"\x26",d+="currencyUnit\x3d"+a.data.giftData.options.wraps[0].unit+"\x26"));else if(c.find(".popover-gift-merchant-wrap").is(":visible")&&(f=c.find("input[name\x3d'mfn-gift-wrap']:checked").eq(0).val())&&f.length)for(d+="giftWrap\x3d"+f+"\x26",f=0;f<a.data.giftData.options.wraps.length;f++)if(c.find(".popover-gift-merchant-wrap").find(".mfn-wrap-"+f).is(":checked")){d+="currencyAmount\x3d"+a.data.giftData.options.wraps[f].priceAmount+"\x26";d+="currencyUnit\x3d"+
a.data.giftData.options.wraps[f].unit+"\x26";break}if(0<J(".enable-gift-connections").length)if(c.find("#include-gift-connection-checkbox").is(":checked")){d+="includeGiftConnection\x3d1\x26";a=c.find("#select-recipient").val();d+="gcGiftlistTypeId\x3d"+a+"\x26";if("1"===a||"2"===a)d+="gcFirstName\x3d"+c.find("#input-recipient-first-name").val()+"\x26",d+="gcLastName\x3d"+c.find("#input-recipient-last-name").val()+"\x26";f=c.find("#select-occasion").val();d+="gcOccasionId\x3d"+f+"\x26";if("1"===f||
"2"===f)d+="gcMonth\x3d"+c.find("#select-occasion-month").val()+"\x26",d+="gcDay\x3d"+c.find("#select-occasion-day").val()+"\x26","1"===f&&"2"===a&&(d+="gcAge\x3d"+c.find("#select-occasion-age").val()+"\x26"),d+="gcHasReminder\x3d"+(c.find("#occasion-has-reminder-checkbox").is(":checked")?"1":"0")+"\x26"}else d+="includeGiftConnection\x3d0\x26";(a=J("input#executionId").val())&&(d+="executionId\x3d"+a+"\x26");a=(new Date).getTime();d+="isClientTimeBased\x3d"+J("input[name\x3d'useCtb']").val()+"\x26returnjson\x3d1\x26isDecoupleSPC\x3d1\x26hasWorkingJavascript\x3d1\x26returnFullHTML\x3d1\x26cachebuster\x3d"+
a;e.isSPP()&&(xa.hide(),a=J("#setOrderingPrefsCheckbox"),a.length&&a.is(":checked")&&(d+="\x26saveAsDefaultsSelected\x3d1"));k.show();a=e.setAjaxTransitionHeader({"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"});J.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/update-gift.html",data:d,dataType:"text",async:!0,cache:!1,headers:a,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",success:function(a,d,f){f.getResponseHeader("x-amz-checkout-page")?(e.isSPP()||c.find(".a-button-close").trigger("click"),
e.ajaxUpdatePage(a,d,f)):(a=b.jsonify(a),e.redirect(a))},error:function(a,b,c){e.ajaxRedirect(a,b,c)}})}}function q(a,b){a.find(".fba-wrap-checkbox").hide();a.find(".large-preview").hide();b.show();b.find(".afn-wrap-copy").remove()}function v(){var a=V,b=a.find(".popover-gift-amazon-wrap").is(":visible"),c=T(a.find(".amazon-gift-wrap")),d=T(a.find(".afn-wrap-none")),e=T(a.find(".hide-prices-checkbox"));if(c.is(":checked")||!d.is(":checked")&&b)e.attr("checked",!0),e.attr("disabled",!0),a.find(".hide-prices-note").show();
else if(c.not(":checked")||d.is(":checked")&&b)e.attr("checked",!0),e.attr("disabled",!1),a.find(".hide-prices-note").hide()}function A(a){var b=V,c=T(b.find(".include-gift-receipt-checkbox")),b=T(b.find(".mfn-hide-prices-checkbox"));a?(ia&&!c.is(":checked")&&c.attr("checked",!0).trigger("change"),ia||b.is(":checked")||b.attr("checked",!0).trigger("change")):(ia&&c.is(":checked")&&c.removeAttr("checked").trigger("change"),!ia&&b.is(":checked")&&b.removeAttr("checked").trigger("change"))}function r(a){var b=
V,c=T(b.find(".include-gift-receipt-checkbox")),b=T(b.find(".mfn-hide-prices-checkbox"));a?(A(!0),ia?c.attr("disabled","disabled"):b.attr("disabled","disabled")):ia?c.removeAttr("disabled"):b.removeAttr("disabled")}function u(a){var b=T(V.find(".include-gift-message-checkbox"));a?(b.is(":checked")||b.attr("checked",!0).trigger("change"),K(!1),x()):(b.is(":checked")&&b.removeAttr("checked").trigger("change"),L())}function K(a){var b=V,c=b.find(".no-message-warning"),d=b.find(".no-receipt-warning"),
e=b.find("textarea[name\x3d'gift-message-text']"),b=b.find(".message-remaining-text");a&&!d.is(":visible")?(h.showGiftTextAreaOnWarning()||e.addClass("gift-message-warning"),b.hide(),c.show()):(h.showGiftTextAreaOnWarning()||e.removeClass("gift-message-warning"),c.hide(),b.show())}function x(){var a=V,b=a.find("textarea[name\x3d'gift-message-text']"),a=a.find(".gift-message-label");b.removeClass("gift-message-inactive");a.removeClass("a-color-secondary")}function L(){var a=V,b=a.find("textarea[name\x3d'gift-message-text']"),
a=a.find(".gift-message-label");b.addClass("gift-message-inactive");a.addClass("a-color-secondary")}function D(){var b=V,c=T(b.find(".include-gift-message-checkbox")),d=b.find(".gift-msg-on-card"),e=b.find(".gift-msg-on-receipt"),f=a.trim(b.find(".gift-message-default-placeholder").text()),h=a.trim(b.find(".gift-message-with-wrap-placeholder").text()),g=b.find("textarea"),l=!1;b.find(".amazon-gift-wrap").each(function(){T(J(this)).is(":checked")&&(l=!0)});b.find(".afn-gift-wrap").each(function(){T(J(this)).is(":checked")&&
(l=!0)});b.find(".mfn-gift-wrap").each(function(){T(J(this)).is(":checked")&&(l=!0)});l?(e.hide(),d.show(),g.attr("placeholder",h),ia&&(u(!0),Fa&&c.attr("disabled","disabled"))):(d.hide(),ia&&e.show(),g.attr("placeholder",f),c.removeAttr("disabled"))}function H(){var a=V,b=T(a.find(".include-gift-message-checkbox")),a=a.find("textarea[name\x3d'gift-message-text']");!pa&&ia&&(b.is(":checked")&&0<a.val().length?K(!1):K(!0))}function M(){var a=V,b=T(a.find(".include-gift-receipt-checkbox")),c=a.find(".no-receipt-warning"),
a=a.find(".no-message-warning");b.is(":checked")?(c.hide(),Fa||u(!0)):(a.hide(),c.show(),u(!1))}function P(a){a=V;var b=T(a.find(".include-gift-receipt-checkbox")),b=ia&&b.is(":checked"),c=T(a.find(".mfn-hide-prices-checkbox")),c=!ia&&c.is(":checked");b||c?(U(),a.find(".kindle-reg-msg-your-account").hide(),a.find(".kindle-reg-msg-another-account").show()):(X(),r(!1),a.find(".kindle-reg-msg-another-account").hide(),a.find(".kindle-reg-msg-your-account").show())}function G(a){a=V;var b=!1;T(a.find(".include-gift-message-checkbox")).is(":checked")&&
(b=!0);var c=!1;a.find(".amazon-gift-wrap").each(function(){T(J(this)).is(":checked")&&(c=!0)});a.find(".afn-gift-wrap").each(function(){T(J(this)).is(":checked")&&(c=!0)});a.find(".mfn-gift-wrap").each(function(){T(J(this)).is(":checked")&&(c=!0)});(b||c)&&A(!0);b&&Fa||c?r(!0):r(!1)}function N(a,b,c){var d=V;ya=a;oa=b;if(a=d.find("textarea[name\x3d'gift-message-text']")){b=c?a.val().length:p.unescape(encodeURIComponent(a.val())).length;fa&&!pa&&ia&&(0<b?K(!1):K(!0));var f=a.val().split("\n").length;
c=ya-b;f=oa-f;!fa&&0<b&&d.find(".include-gift-message-checkbox").not(":checked")&&d.find(".include-gift-message-checkbox").attr("checked",!0);a=a.val().split("\n");for(var h in a)24<a[h].length&&(f=0===a[h].length%24?f-(Math.floor(a[h].length/24)-1):f-Math.floor(a[h].length/24));d.find(".popover-gift-center .remainder-count").hide();(-1>c?d.find(".popover-gift-center .remaining-char-over-multiple").show():0>c?d.find(".popover-gift-center .remaining-char-over-single").show():1===c?d.find(".popover-gift-center .remaining-char-single").show():
d.find(".popover-gift-center .remaining-char-multiple").show()).find(".chars-remaining").html(Math.abs(c));(-1>f?d.find(".popover-gift-center .remaining-line-over-multiple").show():0>f?d.find(".popover-gift-center .remaining-line-over-single").show():1===f?d.find(".popover-gift-center .remaining-line-single").show():d.find(".popover-gift-center .remaining-line-multiple").show()).find(".lines-remaining").html(Math.abs(f));if(0>c||0>f)e.isSPP()?(d.find(".set-gift-options-button").addClass("aok-hidden"),
d.find(".set-gift-options-button-disabled").removeClass("aok-hidden")):(d.find(".set-gift-options-button").hide(),d.find(".set-gift-options-button-disabled").show()),0>c?(d.find(".gift-char-limit-error").find(".char-limit-error").html(ya),d.find(".current-blocker-content").html(d.find(".gift-char-limit-error").html())):0>f&&(d.find(".gift-line-limit-error").find(".line-limit-error").html(oa),d.find(".current-blocker-content").html(d.find(".gift-line-limit-error").html()));-1<c&&-1<f&&(e.isSPP()?(d.find(".set-gift-options-button").removeClass("aok-hidden"),
d.find(".set-gift-options-button-disabled").addClass("aok-hidden")):(d.find(".set-gift-options-button").show(),d.find(".set-gift-options-button-disabled").hide()))}}function Q(a){a.stopPropagation();var b=V;b.find(".popover-content-main").fadeOut(100,function(){b.find(".popover-content-gift-wrap-preview .gift-wrap-preview-image").attr("src",a.data.imageURL);b.find(".popover-content-gift-wrap-preview").fadeIn(100)});var c=b.find(".popover-content-gift-wrap-preview .back-to-gift-options-button");c.unbind("click").bind("click",
E);f.bindActionEnterKeyOnButton(c);za=!0}function E(a){za=!1;var b=V;a?b.find(".popover-content-gift-wrap-preview").fadeOut(100,function(){b.find(".popover-content-main").fadeIn(100)}):setTimeout(function(){b.find(".popover-content-gift-wrap-preview").hide();b.find(".popover-content-main").show()},500)}function F(a){var b=V,c=!1;J(".amazon-gift-wrap").each(function(){T(J(this)).is(":checked")&&(c=!0)});J(".afn-gift-wrap").each(function(){T(J(this)).is(":checked")&&(c=!0)});J(".mfn-gift-wrap").each(function(){T(J(this)).is(":checked")&&
(c=!0)});if(c)U(),aa();else if(T(b.find(".hide-prices-checkbox")).is(":disabled"))Z();else if(a.is("input[type\x3dcheckbox]")&&(a.closest(".a-checkbox").hasClass("hide-prices-checkbox")||a.hasClass("hide-prices-checkbox")))a.is(":checked")?U():X();else if(e.isSPP())(b=a.closest(".a-radio"))&&a.is(":checked")&&(b.hasClass("kindle-reg-radio-your-account")?X():b.hasClass("kindle-reg-radio-another-account")&&U());else if(a.hasClass("kindle-reg-radio-another-account")||a.hasClass("kindle-reg-radio-your-account"))b.find(".kindle-reg-radio-your-account").is(":checked")?
X():U()}function U(){var a=V,b=T(a.find(".hide-prices-checkbox"));b.is(":checked")&&!e.isSPP()||b.attr("checked","checked");T(a.find(".kindle-reg-radio-your-account")).is(":checked")&&T(a.find(".kindle-reg-radio-another-account")).attr("checked",!0)}function X(){var a=V,b=T(a.find(".hide-prices-checkbox"));b.is(":checked")&&b.removeAttr("checked");T(a.find(".kindle-reg-radio-another-account")).is(":checked")&&T(a.find(".kindle-reg-radio-your-account")).attr("checked",!0)}function aa(){var a=V;T(a.find(".hide-prices-checkbox")).attr("disabled",
"true");T(a.find(".kindle-reg-radio-another-account")).attr("disabled",!0);T(a.find(".kindle-reg-radio-your-account")).attr("disabled",!0);a.find(".hide-prices-merchant-cant").is(":visible")||a.find(".hide-prices-note").show()}function Z(){var a=V;T(a.find(".hide-prices-checkbox")).removeAttr("disabled");T(a.find(".kindle-reg-radio-another-account")).removeAttr("disabled");T(a.find(".kindle-reg-radio-your-account")).removeAttr("disabled");a.find(".hide-prices-note").hide()}function ga(a){var b=f.getPosition(a,
"#",2),c=f.getPosition(a,"#",3);return"60"===a.substring(b+1,c)}function Y(b,c,d){var e=R(),f,g;e?(f=d.find('li[class\x3d"a-carousel-card gift-wrap noshi-wrap none-wrap"]'),g=d.find(".carousel-gift-wrap").find("ol")):(f=d.find("."+c+"-wrap-template"),g=d.find("ul.allGiftWrapList"));e&&a.trigger("checkout:gift:removeEmptyCarouselCards",g);var l=(d.data("lineitemid")||b.obfuscatedEntityId||"").replace(":","-");"afn"!==c||e||(g.find('li[class!\x3d"none-wrap gift-wrap noshi-wrap"]').remove(),J("#giftwrap-carousel-wrap-holder-"+
l).css("width",90*(b.options.wraps.length+1)),J("#giftwrap-carousel-wrap-pane-"+l).css("width",360));for(var k=V,n=k.find(".larger-image-link-carousel-template"),r=0;r<b.options.wraps.length;r++){var m=f.clone(!0).removeClass(c+"-wrap-template").addClass(c+"-wrap-copy"),u=n.clone(!0).removeClass("larger-image-link-carousel-template").addClass("larger-image-link-carousel-"+r),t=c,p=b,y=r,q=m,w=u,x=p.options.wraps[y].id;q.find("input").addClass(t+"-wrap-"+y).val(x);q.find("label").attr("for",t+"-wrap-"+
y);x=p.options.wraps[y].description;q.find("."+t+"-wrap-description").html(x);x=p.options.wraps[y].price;q.find("."+t+"-wrap-price").html(x);(p=p.options.wraps[y].imageurl)&&p.length?(q.find("."+t+"-image").attr("src",p).show(),t=q.find(".larger-image-link"),t.show(),t.unbind("click").bind("click",{imageURL:p},Q),w.unbind("click").bind("click",{imageURL:p},Q),w.find("a").unbind("click").bind("click",{imageURL:p},Q)):"mfn"!==t||R()||(q.find(".a-span3").hide(),q.find(".a-span9").addClass("a-span12").removeClass("a-span9"),
q.find(".a-color-price").removeClass("wrap-price"));if("afn"===c){y=b;w=r;q=l;t=g;p=k;x=y.options.wraps[w].id;m.data("giftwrap-id",x);m.data("wrap-no",w);if(y.selected.wrap===x){t.find("li.none-wrap").find("img").removeClass("selected-giftwrap-image");m.find("img").addClass("selected-giftwrap-image");var y=m.find("img").attr("src"),A=J("#giftwrap-option-preview-imagearea-image-"+q);A.find("img").attr("src",y);A.removeClass("aok-hidden");J("#giftwrap-option-preview-imagearea-default-"+q).addClass("aok-hidden");
F(m.find("input"));v();h.isNoshiGiftMessageEnabled()||ga(x)&&la(q);u.removeClass("aok-hidden");u.addClass("selectedWrapLargeLink")}R()?(q=ga(x)?"gift-wrap":"noshi-wrap",m.removeClass(q).removeClass("none-wrap"),t.append(m.show())):(q=ga(x)?"\x3cli class\x3dnoshi-wrap\x3e":"\x3cli class\x3dgift-wrap\x3e",t.append(J(q).append(m.show())));m=p.find("#carousel-larger-image-div");m.find(".larger-image-link-carousel-"+w).length||m.append(u.show())}}d.find("."+c+"-wrap-checkbox").removeAttr("checked");b.selected&&
b.selected.isWrapped?d.find("input[value\x3d'"+b.selected.wrap+"']").attr("checked",!0):T(d.find("."+c+"-wrap-none")).attr("checked",!0);e&&a.trigger("checkout:gift:adjustCarouselInitial",b,d)}function R(){return e.isSPP()&&J("input[name\x3dsppGiftPopoverWithCarousel]").length}function ba(a,b,c){for(var d=c.find("."+b+"-wrap-template"),f=0;f<a.options.wraps.length;f++){var h=d.clone(!0).removeClass(b+"-wrap-template").addClass(b+"-wrap-copy"),g=a.options.wraps[f].id;h.find("input").addClass(b+"-wrap-"+
f).val(g);h.find("label").attr("for",b+"-wrap-"+f);g=a.options.wraps[f].description;h.find("."+b+"-wrap-description").html(g);g=a.options.wraps[f].price;h.find("."+b+"-wrap-price").html(g);if((g=a.options.wraps[f].imageurl)&&g.length){var l=h.find("."+b+"-image");e.isSPP()&&l.removeClass("hidden");l.attr("src",g).show();l=h.find(".larger-image-link");e.isSPP()&&l.removeClass("hidden");l.show();l.unbind("click").bind("click",{imageURL:g},Q)}else h.find(".a-span3").hide(),h.find(".a-span9").addClass("a-span12").removeClass("a-span9"),
h.find(".a-color-price").removeClass("wrap-price");e.isSPP()&&h.removeClass("hidden");h.insertAfter(d).show()}c.find("."+b+"-wrap-checkbox").removeAttr("checked");a.selected&&a.selected.isWrapped?c.find("input[value\x3d'"+a.selected.wrap+"']").attr("checked",!0):T(c.find("."+b+"-wrap-none")).attr("checked",!0)}function ha(){V.find("#include-gift-connection-checkbox").attr("checked",!0)}function y(){if(V.find(".include-gift-connection-checkbox").not(":checked")){var a=V;a.find(".gift-connection-recipient-extra").hide();
var b;b=a.find('#select-recipient option[value\x3d"0"]').attr("selected","selected");a.find("#select-recipient").closest(".a-button-inner").find(".a-placeholder").text(b.text());a.find("#input-recipient-first-name").val("");a.find("#input-recipient-last-name").val("");da()}}function ea(a){for(var b=V,c=0;c<ja.length;c++)if(a&&a===ja[c].value&&ja[c].bMonth&&ja[c].bDay){var d;d=b.find('#select-occasion-month option[value\x3d"'+ja[c].bMonth+'"]').attr("selected","selected");b.find("#select-occasion-month").closest(".a-button-inner").find(".a-placeholder").text(d.text());
d=b.find('#select-occasion-day option[value\x3d"'+ja[c].bDay+'"]').attr("selected","selected");b.find("#select-occasion-day").closest(".a-button-inner").find(".a-placeholder").text(d.text())}}function da(){var a=V,b=a.find("#popover-gift-connection #select-recipient").find(":selected").val();if(""!==b&&"0"!==b&&("1"!==b&&"2"!==b||a.find("#input-recipient-first-name").val()||a.find("#input-recipient-last-name").val()))a.find("#select-occasion").prop("disabled",!1),a.find("#popover-gift-connection-occasion .a-touch-select").css({opacity:1});
else{b=V;b.find(".gift-connection-occasion-extra").hide();var c;c=b.find('#select-occasion option[value\x3d"0"]').attr("selected","selected");b.find("#select-occasion").closest(".a-button-inner").find(".a-placeholder").text(c.text());c=b.find('#select-occasion-month option[value\x3d"0"]').attr("selected","selected");b.find("#select-occasion-month").closest(".a-button-inner").find(".a-placeholder").text(c.text());c=b.find('#select-occasion-day option[value\x3d"0"]').attr("selected","selected");b.find("#select-occasion-day").closest(".a-button-inner").find(".a-placeholder").text(c.text());
c=b.find('#select-occasion-age option[value\x3d"-1"]').attr("selected","selected");b.find("#select-occasion-age").closest(".a-button-inner").find(".a-placeholder").text(c.text());b.find("#occasion-has-reminder-checkbox").attr("checked",!0);a.find("#select-occasion").prop("disabled",!0);a.find("#popover-gift-connection-occasion .a-touch-select").css({opacity:.5})}}function na(a,b){var c=V;"1"===a&&"2"===b?c.find("#select-occasion-age-row").show():c.find("#select-occasion-age-row").hide()}function O(a){a=
V;var b=a.find("#popover-gift-connection #select-recipient").find(":selected").val(),c=a.find("#popover-gift-connection #select-occasion").find(":selected").val();!b||"1"!==b&&"2"!==b?(a.find(".gift-connection-recipient-extra").hide(),"1"===c&&b&&ea(b)):a.find(".gift-connection-recipient-extra").show();na(c,b);da()}function ra(a){a=V;var b=a.find("#popover-gift-connection #select-occasion").find(":selected").val(),c=a.find("#popover-gift-connection #select-recipient").find(":selected").val();!b||
"1"!==b&&"2"!==b?a.find(".gift-connection-occasion-extra").hide():("1"===b&&c&&"1"!==c&&"2"!==c&&ea(c),a.find(".gift-connection-occasion-extra").show());na(b,c)}function sa(a){var b=V,d="/gp/buy/pipeline/handlers/list-of-giftlists.html?escape\x3d0";ja&&(d+="\x26mappingOnly\x3d1");a&&(d+="\x26fromRegistryIds\x3d"+a);J.ajax({type:"POST",url:d,dataType:"json",async:!0,cache:!1,timeout:5E3,success:function(d){b.find("#select-recipient").hide();!ja&&d.options&&0<d.options.length&&(ja=d.options);a&&d.registryIdMapping?
(wa[a]=d.registryIdMapping[a],ua=d.registryIdMapping[a]):a&&(wa[a]=C);ja&&c();b.find("#select-recipient").show();b.find("#select-recipient-spinner").hide();ta=!0},error:function(){b.find("#select-recipient").show();b.find("#select-recipient-spinner").hide();ta=!0}})}function W(b,c){var d=R(),e=c.lineItemId;c=R()?c.currentTab:b.data("current-tab");var f=J("#popover-gift-options-wrapper-"+e).data("active-tab");c!==f&&(b.parent().find(".selected-giftwrap-tab").removeClass("selected-giftwrap-tab"),b.addClass("selected-giftwrap-tab"),
b=J("#giftwrap-carousel-wrap-holder-"+e),d||b.css("left",0),f=J("#giftwrap-carousel-wrap-holder-"+e+" li"),d?(a.trigger("checkout:gift:changeCarouselWrapOptions",b,c,e),a.trigger("checkout:gift:adaptCarouselSPCPanel",e,c)):"all"===c?f.show():(f.hide(),f.filter("."+{"gift-wrap":"gift-wrap",noshi:"noshi-wrap"}[c]).show()),J("#popover-gift-options-wrapper-"+e).data("active-tab",c),f.find(".selected-giftwrap-image").removeClass("selected-giftwrap-image"),f.filter(".none-wrap").find("img").addClass("selected-giftwrap-image"),
J("#giftwrap-option-preview-imagearea-default-"+e).removeClass("aok-hidden"),J("#giftwrap-option-preview-imagearea-image-"+e).addClass("aok-hidden"),d=J("#allGiftWrapList-"+e).find(".none-wrap").find("input"),c=J(".selectedWrapLargeLink"),d.prop("checked",!0),d.val("").change(),h.isNoshiGiftMessageEnabled()||va(e),c.length&&(c.addClass("aok-hidden"),c.removeClass("selectedWrapLargeLink")))}function Ba(a,b,c){c.$event.preventDefault();a=b.lineItemId;b=parseInt(J("#giftwrap-carousel-wrap-holder-"+a).css("left"),
10);0>b&&(b=b+90+"px",J("#giftwrap-carousel-wrap-holder-"+a).css("left",b))}function S(a,b,c){c.$event.preventDefault();a=b.lineItemId;var d=J("#allGiftWrapList-"+a);b=d.find("li").size();c=d.find("li.gift-wrap").size();var d=d.find("li.noshi-wrap").size(),e=J("#popover-gift-options-wrapper-"+a).data("active-tab"),f;"all"===e?f=b:"gift-wrap"===e?f=c:"noshi"===e&&(f=d);b=parseInt(J("#giftwrap-carousel-wrap-holder-"+a).css("left"),10);b>-90*(f-4)&&(b=b-90+"px",J("#giftwrap-carousel-wrap-holder-"+a).css("left",
b))}function ka(a,b){var c=b.lineItemId;J("#allGiftWrapList-"+c).find(".selected-giftwrap-image").removeClass("selected-giftwrap-image");a.find(".afn-image").addClass("selected-giftwrap-image");b=a.parent();h.isNoshiGiftMessageEnabled()||(b.hasClass("noshi-wrap")&&!b.hasClass("none-wrap")?(la(c),J("#afn-message-span-"+c).find("input").prop("checked",!1)):(va(c),J("#afn-message-span-"+c).find("input").prop("checked",!0)));var d=a.data("giftwrap-id"),e=a.find("input"),f=a.data("wrap-no");e.prop("checked",
!0);e.val(d).change();d=J("#giftwrap-option-preview-imagearea-default-"+c);c=J("#giftwrap-option-preview-imagearea-image-"+c);e=J(".selectedWrapLargeLink");f=J(".larger-image-link-carousel-"+f);b.hasClass("none-wrap")?(d.removeClass("aok-hidden"),c.addClass("aok-hidden"),e.length&&(e.addClass("aok-hidden"),e.removeClass("selectedWrapLargeLink"))):(a=a.find("img").attr("src"),c.find("img").attr("src",a),d.addClass("aok-hidden"),c.removeClass("aok-hidden"),e.length&&(e.addClass("aok-hidden"),e.removeClass("selectedWrapLargeLink")),
f.length&&(f.addClass("selectedWrapLargeLink"),f.removeClass("aok-hidden")))}function qa(a,b){var c=b.lineItemId;b=J("#giftwrap-option-preview-imagearea-default-"+c);c=J("#giftwrap-option-preview-imagearea-image-"+c);a.hasClass("none-wrap")?(b.removeClass("aok-hidden"),c.addClass("aok-hidden")):(a=a.find("img").attr("src"),c.find("img").attr("src",a),b.addClass("aok-hidden"),c.removeClass("aok-hidden"))}function ca(a,b){var c=b.lineItemId;a=J("#giftwrap-option-preview-imagearea-default-"+c);b=J("#giftwrap-option-preview-imagearea-image-"+
c);J("#allGiftWrapList-"+c).find(".selected-giftwrap-image").parentsUntil("ul","li").hasClass("none-wrap")?(a.removeClass("aok-hidden"),b.addClass("aok-hidden")):(c=J("#allGiftWrapList-"+c).find(".selected-giftwrap-image").attr("src"),b.find("img").attr("src",c),a.addClass("aok-hidden"),b.removeClass("aok-hidden"))}function va(a){var b=J("#afn-message-span-"+a+", #gift-message-"+a);J("#gift-message-noshi-warning-"+a).addClass("aok-hidden");b.removeClass("disable-message-area").addClass("enable-message-area");
b.find("input").removeAttr("disabled");b.find("textarea").removeAttr("disabled")}function la(a){var b=J("#afn-message-span-"+a+", #gift-message-"+a);J("#gift-message-noshi-warning-"+a).removeClass("aok-hidden");b.removeClass("enable-message-area").addClass("disable-message-area");b.find("input").attr("disabled","disabled");b.find("textarea").attr("disabled","disabled")}var J=a.$;if(!J("html").hasClass("a-ie6")){var ya,oa,V,xa,za=!1,fa=!1,pa=!0,ia=!0,ja,ta=!1,wa={},ua,Fa=!1;a.on("a:popover:hide",function(a){a.popover&&
a.popover.name&&0===a.popover.name.indexOf("gift-")&&(e.isSPP()&&d.increaseCount("checkout:spp-revieworder:gift_pop_cancel_sec",1),za&&E(),fa&&(a=V,a.find(".gift-msg-on-card").hide(),a.find(".popover-gift-warning").hide(),a.find(".message-remaining-text").show(),T(a.find(".amazon-gift-wrap")).removeAttr("checked"),u(!1),a.find('input[type\x3d"checkbox"]').removeAttr("disabled")))});a.on("a:popover:show",function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("gift-")){V=a.popover.$popover;
xa=a.popover;0<V.find(".include-gift-receipt-checkbox").length&&(fa=!0);g.showSpinner(V.find(".popover-content-main"),!1,xa);V.find(".content-container").css("visibility","hidden");a="returnjson\x3d1\x26hasWorkingJavascript\x3d1\x26isDecoupleSPC\x3d1\x26cachebuster\x3d"+(new Date).getTime();try{var c=xa.data;if(c)a+="\x26obfuscatedEntityId\x3d"+c;else throw{name:"MissingData",message:"lineItemId is undefined"};}catch(d){p.ueLogError&&p.ueLogError(d,{logLevel:"FATAL",attribution:"gift-popover",message:"[No lineItemId to open the gift-popover with]. "})}J.ajax({type:"POST",
url:"/gp/buy/pipeline/handlers/gift-select-content.html",data:a,dataType:"text",async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc"},dataFilter:function(a){return b.jsonify(a)},success:function(a,b,c){a&&a.conductoraction&&a.conductoraction.url&&e.redirect(a);null!==a?t(a,b,c):e.ajaxRedirect()},error:function(a,b,c){e.ajaxRedirect(a,b,c)}})}});a.on("a:popover:beforeShow",function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("button-blocker-gift"))b=V,a.popover.$popover.find(".a-popover-inner").html(b.find(".current-blocker-content").text()),
a.popover.updatePosition(!0);else if(a.popover&&a.popover.$popover){var b=a.popover.$popover;a=b.find(".validateInputCharactersOnBlur.a-form-error");0<a.size()&&a.removeClass("a-form-error");b=b.find("#onblur-character-validation-error-gift-message-text");0<b.size()&&b.remove()}});var Ca={enforceSelectorParity:F,enforceGiftReceiptParity:G,enforceHidePriceParity:P,disableHidePrice:v,toggleMessageBoxDisplay:D,toggleEmptyMsgWarning:H,toggleNoReceiptWarning:M,includeGiftConnection:ha,clearGiftConnection:y,
toggleGiftConnectionRecipientArea:O,toggleGiftConnectionOccasionArea:ra,updateGiftOptionsTabSelection:W,updateCarouselOnLeftClick:Ba,updateCarouselOnRightClick:S,updateSelectedGiftWrap:ka,updatePreviewImageOnMouseEnter:qa,updatePreviewImageOnMouseLeave:ca},T=n.getInput;a.declarative("gift-popover-element",["change"],function(a){var b;b=a.$event.isInit?a.data.onInit||[]:a.data.onChange||[];for(var c=0;c<b.length;c++)if(Ca[b[c]])Ca[b[c]](a.$target,a.data)});a.declarative("gift-popover-element","click mouseenter mouseleave",
function(a){var b;if(b=a.data[{click:"onClick",mouseenter:"mouseEnter",mouseleave:"mouseLeave"}[a.type]])for(var c=0;c<b.length;c++)if(Ca[b[c]])Ca[b[c]](a.$currentTarget,a.data,a)});a.declarative("spc-update-gift-options-tab-selection","click",function(a){var b=a.$target.parents("li");b.attr("data",a.data);W(b,a.data)});a.on("checkout:reload:spc",l);a.on("checkout:reload:spp-revieworder",l)}});"use strict";q.when("A","page-transition-controller","loading-spinner-controller","ajax-utility","page-conductor",
"checkout-general-utils","page-detector","client-side-metrics").register("concealment-popover-controller",function(a,k,g,b,e,f,m,d){function n(){t("#spc-orders").find(".concealment-widgets-desktop").removeClass("no-js-hide");a.defer(function(){t("#spc-orders").find(".concealment-popover-link").each(function(){t(this).data("action")&&t(this).removeAttr("href").attr("tabindex",0)})})}function h(a){return a.is("input")?a:a.find("input")}function c(a){var b=q;b.find(".fake-label").each(function(){t(this).unbind("click").bind("click",
function(){t(this).closest(".popover-checkbox").find("input").trigger("click")})});a&&a.item&&a.item.title&&b.find(".concealment-item-title").html(a.item.title);if(a&&a.obfuscatedEntityId){var c=b.find(".set-concealment-options-button input");c.unbind("click").bind("click",{obfuscatedentityid:a.obfuscatedEntityId,concealmentData:a,quantity:a.quantity},l);f.bindActionEnterKeyOnButton(c)}v=a&&a.item&&a.item.isAmazonFulfilled;a&&a.selected&&(c=h(b.find(".conceal-item-checkbox")),a.selected.concealItem?
c.attr("checked",!0):c.removeAttr("checked"));q.find(".content-container").css("visibility","visible");z.updatePosition(!0);g.hideSpinner(b.find(".popover-content-main"))}function l(a){var c=q,f="";a&&a.data&&a.data.obfuscatedentityid&&(f+="obfuscatedEntityId.0\x3d"+a.data.obfuscatedentityid+"\x26");a&&a.data&&a.data.quantity&&(f+="quantity.0\x3d"+a.data.quantity+"\x26");var g="";a&&a.data&&a.data.concealmentData&&a.data.concealmentData.saveConcealmentRefTag&&(g=a.data.concealmentData.saveConcealmentRefTag);
var l="";a&&a.data&&a.data.concealmentData&&a.data.concealmentData.cancelConcealmentRefTag&&(l=a.data.concealmentData.cancelConcealmentRefTag);(a=h(c.find(".conceal-item-checkbox")).is(":checked"))?(v&&(f+="isAFN.0\x3d1\x26"),f=f+"includeReceipt.0\x3d1\x26includeMessage.0\x3d1\x26"+("message.0\x3d"+encodeURIComponent(t("input[name\x3d'concealment-item-message']").val())+"\x26"),f=f+"hidePrices.0\x3d0\x26saveOnly\x3d1"+("ref\x3d"+g+"\x26")):f+="ref\x3d"+l+"\x26";var n=t("input#executionId").val();
n&&(f+="executionId\x3d"+n+"\x26");n="/gp/buy/gift/handlers/save-all.html/ref\x3d";a?(n+=g,d.increaseCount("CPEX.Checkout.Select.Concealment",1)):(n+=l,d.increaseCount("CPEX.Checkout.Cancel.Concealment",1));e.isSPP()&&(c.find(".a-button-close").trigger("click"),g=t("#setOrderingPrefsCheckbox"),g.length&&g.is(":checked")&&(f+="\x26saveAsDefaultsSelected\x3d1"));k.show();t.ajax({type:"POST",url:n,data:f,dataType:"text",async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"},
contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",success:function(a,d,f){f.getResponseHeader("x-amz-checkout-page")?(e.isSPP()||c.find(".a-button-close").trigger("click"),e.ajaxUpdatePage(a,d,f)):(a=b.jsonify(a),e.redirect(a))},error:function(a,b,c){e.ajaxRedirect(a,b,c)}})}var t=a.$;if(!t("html").hasClass("a-ie6")){var q,z,v=!0;t(document).delegate(".concealment-popover-link, .concealment-options-button","click",function(){d.increaseCount("CPEX.Checkout.Concealment.Button.click",
1)});a.on("a:popover:hide",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("concealment-")&&(e.isSPP()&&d.increaseCount("checkout:spp-revieworder:concealment_pop_cancel_sec",1),h(q.find(".conceal-item-checkbox")).removeAttr("checked"))});a.on("a:popover:show",function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("concealment-")){q=a.popover.$popover;z=a.popover;g.showSpinner(q.find(".popover-content-main"),!1,z);q.find(".content-container").css("visibility","hidden");
a="returnjson\x3d1\x26hasWorkingJavascript\x3d1\x26isDecoupleSPC\x3d1\x26cachebuster\x3d"+(new Date).getTime();try{var d=z.data.lineItemEntityId,f=z.data.itemId;if(d)a+="\x26obfuscatedEntityId\x3d"+d;else if(f)a+="\x26lineItemEntityId\x3d"+f;else throw{name:"MissingData",message:"lineItemId is undefined"};var h=z.data.quantity;if(h)a+="\x26quantity\x3d"+h;else throw{name:"MissingData",message:"quantity is undefined"};}catch(l){p.ueLogError&&p.ueLogError(l,{logLevel:"FATAL",attribution:"concealment-popover",
message:"[Data missing to open the concealment-popover]. "})}d=z.data.ref;t.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/concealment-select-content.html/ref\x3d"+d,data:a+("\x26ref\x3d"+d),dataType:"text",async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc"},dataFilter:function(a){return b.jsonify(a)},success:function(a,b,d){a&&a.conductoraction&&a.conductoraction.url&&e.redirect(a);null!==a?c(a,b,d):e.ajaxRedirect()},error:function(a,b,c){e.ajaxRedirect(a,b,c)}})}});a.on("a:popover:beforeShow",
function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("button-blocker-concealment")){var b=q;a.popover.$popover.find(".a-popover-inner").html(b.find(".current-blocker-content").text());a.popover.updatePosition(!0)}});var A={};a.declarative("concealment-popover-element",["change"],function(a){var b;b=a.$event.isInit?a.data.onInit||[]:a.data.onChange||[];for(var c=0;c<b.length;c++)if(A[b[c]])A[b[c]](a.$target,a.data)});a.declarative("concealment-popover-element","click mouseenter mouseleave",
function(a){var b;if(b=a.data[{click:"onClick",mouseenter:"mouseEnter",mouseleave:"mouseLeave"}[a.type]])for(var c=0;c<b.length;c++)if(A[b[c]])A[b[c]](a.$currentTarget,a.data,a)});a.on("checkout:reload:spc",n);a.on("checkout:reload:spp-revieworder",n)}});"use strict";q.when("A","page-conductor","scroll-controller","page-detector","client-side-metrics","button-blocker").register("gold-box-controller",function(a,k,g,b,e,f){function m(){a.defer(n);a.defer(h)}var d=a.$;if(!d("html").hasClass("a-ie6")){var n=
function(){var a=d("#goldbox-countdown"),b=d("#spc-orders");b&&0!==b.length||(b=d("#spclite-items-block"));b=b.find("input[name\x3dgoldboxexpirelefttime]");if(0!==b.length){if(1<b.size()){var f=parseInt(b.attr("data-timeleftms"),10),h=b;d.each(b,function(){var a=d(this),b=parseInt(a.attr("data-timeleftms"),10);b<f&&(h=a,f=b)});b=h}var n=parseFloat(b.attr("data-pagestarttime")),m=parseFloat(b.attr("data-timeleftms")/1E3);if(!(isNaN(n)||isNaN(m)||0>=m)){var q=(new Date).getTime(),r=a.find("span[data-timefield\x3dminute]"),
u=a.find("span[data-timefield\x3dsecond]"),K=p.setInterval(function(){var b=(new Date).getTime();m-=(b-q)/1E3;q=b;if(0>m&&K)u.html("00"),p.clearInterval(K),K=null,k.isSPP()&&e.increaseCount("checkout:spp-revieworder:deal_expired",1),d("#gold-box-modal-launcher").trigger("click"),g.scrollToTop(),g.toggleScrollOff();else{var b=Math.floor(m/60%60),f=Math.floor(m%60),f=10>f?"0"+f:f;r.html(b);u.html(f);a.is(":visible")||a.show()}},1E3);k.isSPP()&&e.increaseCount("checkout:spp-revieworder:deal_countdown",
1)}}},h=function(){var a=d("#gold-box-button-blocker");1===a.length&&f.show("place-order-gold-box-blocker",a.attr("data-blocker-message"))};a.on("checkout:reload:spc",m);a.on("checkout:reload:spclite",m);a.on("checkout:reload:spp-revieworder",m)}});"use strict";q.when("A","page-transition-controller","ajax-utility","page-conductor","currency-formatter","page-detector","client-side-metrics","pay-rewards-currency","weblab-helper").register("inline-points-controller",function(a,k,g,b,e,f,m,d,n){function h(){r("#spc-points-input")&&
r("#spc-points-input").data("points-used")&&(r("#points-applied").show(),r("#inline-points-button").hide());r("#inline-points-register")&&r("#inline-points-register").removeAttr("href");r("#spc-loyalty-points-input")&&r("#spc-loyalty-points-input").val()&&(r("#loyalty-points-applied").show(),r("#loyalty-points-button").hide());r("#spc-points-input")&&r("#spc-points-input").hasClass("show-currency-input-widget-new")&&r("#spc-points-input").each(function(b,c){var e=a.$(c);b={$element:e,maxAmount:e.data("max-dollar-amount")};
c={$element:a.$("#inline-raw-points"),decimalPlaces:e.data("decimal-places"),ratio:e.data("conversion-ratio")};var f=e.data("country-code"),f=d.getCurrencyFormatByCountryCode(f);d.initializeInlineFormatting(b,c,f);r(document).delegate("#spc-points-input","keydown",function(a){if(e.data("points-used")!==e.val){a=r("#inline-points-button");var b=!1;a.is("span")&&(b=!0);var c=a.find("span.apply"),d=a.find("span.change");r("#points-applied").hide();e.data("points-used")?(c.hide(),d.show()):(c.show(),
d.hide());b?a.addClass("display-inline-block"):a.show()}})})}function c(a,c){a.preventDefault();if(l(c)){b.isSPP()?(k.blockAllActions(),k.showTransitionInContainer(r("#payment"))):k.show();var d;a={"x-amz-checkout-page":"spc"};if(c){var e=n.isPointsRedemptionPageTypeHeaderFixEnabled();e&&m.resetMetrics();d=r("#loyalty-points-hidden-fields");c="/gp/buy/spc/handlers/update-loyalty-points.html/ref\x3dox_spc_points_edit";d="\x26jpPointsPaymentInstrumentId\x3d"+encodeURIComponent(d.find("input[name\x3d'jpPointsPaymentInstrumentId']").val())+
"\x26jpPointsCustomerRequestedAmount\x3d"+r("#spc-loyalty-points-input").val()+"\x26jpPointsConversionRate\x3d"+d.find("input[name\x3d'jpPointsConversionRate']").val()+"\x26jpPointsBaseCurrencyCode\x3d"+d.find("input[name\x3d'jpPointsBaseCurrencyCode']").val()+"\x26jpPointsTargetCurrencyCode\x3d"+d.find("input[name\x3d'jpPointsTargetCurrencyCode']").val()+"\x26hasWorkingJavascript\x3d1\x26setPageTypeInResponse\x3d"+(e?1:0)+"\x26isClientTimeBased\x3d"+r("input[name\x3duseCtb]").val()}else a=b.setAjaxTransitionHeader(a),
d=r("#inline-points-hidden-fields"),e=d.find("input[name\x3d'useGCBalance']").val(),c="/gp/buy/pipeline/handlers/update-reward-points.html/ref\x3d"+(b.isSPP()?"chk_pay_addswp_coll":"ox_pay_page_points_apply"),d="paymentMethodId\x3d"+d.find("input[name\x3d'paymentMethodId']").val()+"\x26paymentMethodType\x3d"+d.find("input[name\x3d'paymentMethodType']").val()+"\x26rewardAccountId\x3d"+d.find("input[name\x3d'rewardAccountId']").val()+"\x26rewardAccountAmount\x3d"+r("#spc-points-input").val()+"\x26rewardAccountRate\x3d"+
d.find("input[name\x3d'rewardAccountRate']").val()+"\x26useGCBalance\x3d"+e+"\x26usePromoBalance\x3d"+e+"\x26returnFullHTML\x3d1\x26returnjson\x3d1\x26hasWorkingJavascript\x3d1\x26isClientTimeBased\x3d"+r("input[name\x3duseCtb]").val();r.ajax({type:"POST",url:c,data:d,dataType:"text",async:!0,cache:!1,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",headers:a,success:function(a,c,d){d.getResponseHeader("x-amz-checkout-page")?b.ajaxUpdatePage(a,c,d):(a=g.jsonify(a),b.redirect(a))},
error:function(a,c,d){b.ajaxRedirect(a,c,d)}})}}function l(a){var b=!1,c=r("input[name\x3drewardAccountAmount]"),d=r("#inline-points-error-block");a||r("#spc-points-input")&&!r("#spc-points-input").hasClass("show-currency-input-widget-new")?(a&&(c=r("input[name\x3dloyaltyPointsValue]"),d=r("#loyalty-points-error")),d.hide(),d.find("p").hide(),p(c))?q(c,a)?v(c,a)||(d.find("p").filter(function(){return"badMax"===r(this).data("error")}).show().css("display","inline"),b=!0):(d.find("p").filter(function(){return"badMin"===
r(this).data("error")}).show().css("display","inline"),b=!0):(d.find("p").filter(function(){return"badValue"===r(this).data("error")}).show().css("display","inline"),b=!0):a||q(c,a)||(d.find("p").filter(function(){return"badMin"===r(this).data("error")}).show().css("display","inline"),b=!0);if(b)return d.show(),c.addClass("a-form-error"),!1;c.removeClass("a-form-error");return!0}function t(a,b){var c=r(a.currentTarget),d=c.val();a=r("#inline-raw-points");b&&(a=r("#loyalty-points-applied-value"));
var f=a.html();if(b)!/^\s*$/.test(d)&&!isNaN(d)&&0<d?a.html(d):a.html(0);else if(!r("#spc-points-input").hasClass("show-currency-input-widget-new")){var h=c.data("min-dollar-amount");!/^\s*$/.test(d)&&!isNaN(d)&&0<d&&!isNaN(h)&&d>=h?(h=c.data("conversion-ratio"),c=c.data("decimal-places"),d=e.getNumberWithSeparators(d/h,c),a.html(d)):a.html(0)}(b||r("#points-applied").is(":visible"))&&f!==a.html()&&(a=r("#spc-loyalty-points-display"),f=r("#loyalty-points-applied"),d=r("#loyalty-points-button"),c=
!1,b||(a=r("#inline-points-button"),a.is("span")&&(c=!0),f=a.find("span.apply"),d=a.find("span.change"),r("#points-applied").hide()),f.hide(),d.show(),c?a.css("display","inline-block"):a.show())}function p(a){a=a.val();return/^\s*$/.test(a)||!isNaN(a)}function q(a,b){if(b)return!0;b=a.val();if(/^\s*$/.test(b))return!0;b=parseFloat(b);return isNaN(b)||!a.data("min-dollar-amount")?!0:0===b||b>=a.data("min-dollar-amount")}function v(a,b){var c=a.val();if(/^\s*$/.test(c))return!0;var c=parseFloat(c),
d=a.data("max-dollar-amount");b&&(d=a.data("available-points"));return isNaN(c)||!d?!0:c<=d}function A(a){switch(a.keyCode?a.keyCode:a.which){case 13:case 10:var b=r("#loyalty-points-button"),d=r("#spc-points-input");0<b.length&&b.is(":visible")?c(a,1):0<d.length&&c(a,0)}}var r=a.$;r("html").hasClass("a-ie6")||(r(document).delegate("#spc-loyalty-points-input","keypress",function(a){A(a)}),r("#spc-points-input")&&!r("#spc-points-input").hasClass("show-currency-input-widget-new")&&(r(document).delegate("#spc-points-input",
"keypress",function(a){A(a)}),r(document).delegate("#spc-points-input","keyup",function(a){t(a,0)})),r(document).delegate("#spc-loyalty-points-input","keyup",function(a){t(a,1)}),r(document).delegate("#inline-points-button","click",function(a){c(a,0)}),r(document).delegate("#loyalty-points-button","click",function(a){c(a,1)}),a.on("a:expander:apply-point-expander:toggle:expand",function(a){m.increaseCount("checkout:spp-payment:expand_addswp_coll",1)}),a.on("checkout:reload:spc",h),a.on("checkout:reload:spp-revieworder",
h))});"use strict";q.when("A","client-side-metrics","ready").execute(function(a,k){var g=a.$;a.on("checkout:reload:spc",function(){var a=g("input[name\x3d'rewardsProgramId']").val(),e=g("input[name\x3d'swpWidgetCase']").val();a&&e&&k.increaseCount("Checkout::SPC::SWPWidgetCSM::"+a+"::"+e,1)})});"use strict";q.when("A","client-side-metrics","ready").execute(function(a,k){function g(){"1"!==b("meta[name\x3dSWP_TPP_FEATURE_ENABLED]").attr("content")||e||b.ajax({type:"POST",url:"/gp/shopwithpoints/temporaryPreference/verify-and-log-temporary-preference.html",
data:{sourcePage:"SPC"},dataType:"text",async:!0,success:function(){e=!0;k.increaseCount("Checkout::SPC::LogTemporaryPaymentPreferenceAppliedAjax::Success",1)},error:function(){k.increaseCount("Checkout::SPC::LogTemporaryPaymentPreferenceAppliedAjax::Failure",1)}})}var b=a.$,e=!1;a.on("checkout:reload:spc",g);a.on("checkout:reload:spclite",g);a.on("checkout:reload:spp-revieworder",g);a.on("checkout:reload:spp-collapsed",g)});"use strict";q.when("A","page-transition-controller","ajax-utility","page-conductor").register("inline-fps-balance-controller",
function(a,k,g,b){function e(a){a.preventDefault();f("#inline-fps-balance-checkbox").prop("disabled","disabled");b.isSPP()?(k.blockAllActions(),k.showTransitionInContainer(f("#payment"))):k.show();var d=f("#inline-fps-balance-hidden-fields"),e=0;f("#inline-fps-balance-checkbox").prop("checked")&&(e=1);a=b.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});var h="/gp/buy/pipeline/handlers/update-fps-balance.html/ref\x3d"+(b.isSPP()?"chk_pay_"+(e?"apply":"remmove")+"_fps_balance_coll":"ox_spc_page_fps_balance_apply"),
d="fpsPaymentMethodId\x3d"+d.find("input[name\x3d'fpsPaymentMethodId']").val()+"\x26useFlexiblePayments\x3d"+e+"\x26returnFullHTML\x3d1\x26returnjson\x3d1\x26hasWorkingJavascript\x3d1\x26isClientTimeBased\x3d"+f("input[name\x3duseCtb]").val();f.ajax({type:"POST",url:h,data:d,dataType:"text",async:!0,cache:!1,headers:a,success:function(a,d,e){e.getResponseHeader("x-amz-checkout-page")?b.ajaxUpdatePage(a,d,e):(a=g.jsonify(a),b.redirect(a))},error:function(a,d,e){b.ajaxRedirect(a,d,e)}})}var f=a.$;f("html").hasClass("a-ie6")||
f(document).delegate("#inline-fps-balance-checkbox","click",function(a){e(a)})});"use strict";q.when("A","page-transition-controller","ajax-utility","page-conductor","checkout-general-utils","error-feature-detection","page-detector","client-side-metrics","weblab-helper","a-modal").register("shipping-speed-selection-controller",function(a,k,g,b,e,f,m,d,n,h){function c(){X?E("fieldset div.a-radio").addClass("a-touch-radio").removeClass("a-radio"):a.defer(function(){var a=E("#spc-orders").find("div.ship-option");
a.filter(".no-scheduled-delivery");a.each(function(){E(this).find("input.radio-image").remove()});a.each(function(){var a=E(this).find("input.radio-standard");a.attr("checked")&&a.attr("checked",!0)})});ga=E("#spc-orders").find("div.ship-option").find('input[type\x3d"radio"]:checked');l();f.markFeatureAvailable("shipping-speed-selection-controller");t()}function l(){var a=0<E("#trigger-case-call-to-resolve-cv").length||0<E(".force-resolve-invalid-ship-option").length;if(b.isSPP()&&a){var a=function(){var a=
p.setInterval(function(){b.isAnimating()||(k.show(),p.clearInterval(a))},50)},c=E("div.ship-option").filter(".call-set-to-resolve-cv").first().find("input[type\x3d'radio']");if(c&&c.length){var d=c.parents(".shipping-speeds").find("input.lineitemidinput[type\x3dhidden]").val();D(c,null,null,{transitionAction:a,refTag:"chk_revieworder_set_ship_option_no_default",extraData:{callingCASEResolveCV:1,lineItemIds:d}})}}}function t(){E("#buy-button-disabled-state").length&&q(function(a){z(a)})}function q(a){E("div.sd_widget_root").each(function(b,
c){a(c)})}function z(a){var b=setInterval(E.proxy(function(){if(E(this).hasClass("sd_widget_initialized")){var a=E(this),c=E(a).attr("id");c&&(a=v(a),a["ScheduledDeliveryEntity.startDeliveryDate"]&&D(null,c,a));p.clearInterval(b)}},a),1E3)}function v(a){var b={};A(a,function(a){var c=E(a).attr("key");a=E(a).val();b[c]=a||""});return b}function A(a,b){E(a).find("input[type\x3d'hidden']").each(function(a,c){b(c)})}function r(){F||(F=E("input[type\x3d'hidden'][name\x3d'scopeId']").val());return F}function u(a,
c,d){if(d.getResponseHeader("x-amz-checkout-page")){var e=g.jsonify(a);return e&&e.success&&e.trialkey&&U[e.trialkey]?(a=U[e.trialkey],b.isSPP()&&"object"===typeof a&&(a=JSON.stringify(U[e.trialkey])),n.isSPCMobileDisplayMoreShipOptionsEnabled()&&0<E(".mobile-view").length?b.ajaxUpdatePage(a,c,d,{pushNewFrame:"false"}):b.ajaxUpdatePage(a,c,d),aa&&(clearTimeout(aa),aa=null),U={},!0):n.isSPCMobileDisplayMoreShipOptionsEnabled()&&0<E(".mobile-view").length?b.ajaxUpdatePage(a,c,d,{pushNewFrame:"false"}):
b.ajaxUpdatePage(a,c,d)}return b.redirect(a)}function K(a,b){if(a){var c=a.data(b);if(c!==C)return c;(a=a.closest(".radio-standard"))&&(c=a.data(b));return c}}function x(a){a.closest("fieldset").find("i.a-icon-touch-radio-active").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive");a.siblings("i").addClass("a-icon-touch-radio-active").removeClass("a-icon-touch-radio-inactive")}function L(a){var b=a;E(".shipping-group").each(function(a,c){var d=!1;E(c).parents().each(function(a,
b){return E(b).hasClass("shipment")?(d=!0,!1):!0});d||(b=b.add(c))});return b}function D(a,c,d,e){X&&x(a);e&&e.transitionAction?e.transitionAction():k.show();for(var f in Z)Z.hasOwnProperty(f)&&(Z[f].abort(),delete Z[f]);f=E("#spc-orders").find("input[type\x3d'hidden'][name\x3d'shiptrialprefix']").val();var h;a||(a=E("#"+c).closest(".shipping-speed").find("input[type\x3d'radio']"));h=a.closest(".shipment").data("orderid");a&&a.length&&a.hasClass("valid-btn")&&a.closest(".prime-calendar").hasClass("long-calendar")&&
(h=a.closest(".prime-calendar").data("orderid"));var g="returnpipedata\x3d0\x26returnFullHTML\x3d1\x26cachebuster\x3d"+(new Date).getTime()+"\x26hasWorkingJavascript\x3d1";if(e&&e.extraData)for(var l in e.extraData)e.extraData.hasOwnProperty(l)&&(g+="\x26"+l+"\x3d"+e.extraData[l]);var m=E(".shipment"),t=0;l=m.length;m=L(m);g+="\x26groupsadded\x3d"+(m.length-l);m.each(function(b,e){var f=E(e),l="";b=f.has(".prime-calendar-container");e=f.find("input[name\x3d'currentshippingspeed']").attr("value");
var k=f.find("input[name\x3d'currentshipsplitpreference']").attr("value");1===m.length&&(g+="\x26oldoption\x3d"+e+"."+k);e=f.find("input[name\x3d'defaultshipsplitpreference."+t+"']").attr("value");k=f.find("input[name\x3d'usingprimeshipping."+t+"']").attr("value");e&&k&&(g+="\x26defaultshipsplitpreference."+t+"\x3d"+e,g+="\x26usingprimeshipping."+t+"\x3d"+k);e=f.find(".shipping-speed");e=a?e.find('input[type\x3d"radio"]:checked'):e.find("input[src*\x3dradio-on]");b&&!e.length&&(e=f.find("input[name\x3d'hiddenSelection"+
t+"']"));k=f.find(".ship-split-preferences").find("input[type\x3d'radio']:checked");1!==k.length&&(k=f.find(".ship-split-preferences").find("input[type\x3d'hidden'][name^\x3d'shippriority']"));h===f.data("orderid")&&(K(a,"shippingofferingid")?e=a:k=a,1===m.length&&(l=b?l+("\x26option\x3d"+e.data("key")+"."+(k?k.attr("value"):"")):l+("\x26option\x3d"+e.attr("value")+"."+(k?k.attr("value"):""))));var n=f.find("input[name\x3d'lineitemids"+t+"']");0<n.length&&(l+="\x26lineitemids"+t+"\x3d"+n.attr("value"));
l+=N(f,t);if(e.length){var f=e,r="",n=t;K(f,"rcxsspdecoupling")?(r={},r["shippingspeed"+n]=b?f.attr("key"):f.attr("value"),r["shippingofferingid"+n]=K(f,"shippingofferingid"),r["guaranteetype"+n]=K(f,"guaranteetype"),r["issss"+n]=K(f,"issss"),r["forceshipsplitpreference"+n]=K(f,"forceshipsplitpreference"),b="shipWhenComplete",k&&(b=k.attr("value")),1===K(f,"isscheduleddelivery")&&(r["isscheduleddelivery"+n]="1",b="shipWhenComplete"),r["shippriority"+n]=b,r["preferredSSP"+n]=K(f,"shipsplitpriority"),
r["currentSSP"+n]=k.attr("value"),r["isShipWheneverValid"+n]=K(f,"isshipwhenevervalid"),r["isShipWhenCompleteValid"+n]=K(f,"isshipwhencompletevalid"),r=E.param(r),b="\x26"+r):(r=b?r+("\x26shippingspeed"+n+"\x3d"+f.data("key")):r+("\x26shippingspeed"+n+"\x3d"+f.attr("value")),r+="\x26shippingofferingid"+n+"\x3d"+K(f,"shippingofferingid"),r+="\x26guaranteetype"+n+"\x3d"+K(f,"guaranteetype"),r+="\x26issss"+n+"\x3d"+K(f,"issss"),r+="\x26forceshipsplitpreference"+n+"\x3d"+K(f,"forceshipsplitpreference"),
b="shipWhenComplete",k&&(b=k.attr("value")),1===K(f,"isscheduleddelivery")&&(r+="\x26isscheduleddelivery"+n+"\x3d1",b="shipWhenComplete"),b=r+("\x26shippriority"+n+"\x3d"+b));l+=b;if(1===K(e,"isscheduleddelivery"))if(b=e.closest(".shipping-speed").find('[id^\x3d"sd_widgets_"]'),c&&d&&(c===b.attr("id")||c===C))for(var p in d)d.hasOwnProperty(p)&&(l+="\x26"+p+"."+t+"\x3d"+d[p]);else l+="\x26"+b.children(":input").serialize();else 1===K(e,"isscheduleddeliveryslot")&&K(e,"sddatastring")&&(l+="\x26ScheduledDeliveryEntity.data."+
t+"\x3d"+encodeURIComponent(e.data("sddatastring")))}else l+="\x26isdigital"+t+"\x3d1";t++;g+=l});0<t&&(g+="\x26groupcount\x3d"+t);l="ox_spc_set_ship_option";if(b.isSPP()){l="chk_revieworder_set_ship_option";var p=E("#setOrderingPrefsCheckbox");p.length&&p.is(":checked")&&(g+="\x26saveAsDefaultsSelected\x3d1")}p=E("input[name\x3duseCtb]").val();g+="\x26isClientTimeBased\x3d"+p;1===K(a,"istrial")?(f=r()+":"+a.attr("name")+":"+a.attr("value"),g+="\x26trialkey\x3d"+f,U[f]&&(aa&&clearTimeout(aa),l="ox_spc_set_cached_ship_option",
b.isSPP()&&(l="chk_revieworder_set_cached_ship_option"),g=g.replace("returnFullHTML\x3d1","returnFullHTML\x3d0"),g+="\x26trialSuccess\x3d1")):"undefined"!==typeof f&&(f=f+":"+a.attr("name")+":"+a.attr("value"),g+="\x26trialkey\x3d"+f);e&&e.refTag&&(l=e.refTag);e&&e.removeGiftOption&&(g+="\x26giftOrderid\x3d"+a.closest(".shipment").data("orderid"));0===g.indexOf("\x26")&&(g=g.substr(1));e="/gp/buy/spc/handlers/set-delivery-options.html/ref\x3d"+l;f=b.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});
n.isSPCMobileDisplayMoreShipOptionsEnabled()&&0<E(".mobile-view").length&&(f=b.setAjaxTransitionHeader({"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"}));E.ajax({type:"POST",url:e,data:g,dataType:"text",async:!0,cache:!1,headers:f,success:function(a,b,c){u(a,b,c)},error:function(a,c,d){b.ajaxRedirect(a,c,d)}})}function H(a){var b=[a.closest(".shipment").data("orderid")];P(a,b)}function M(a){var b=[];E("#spc-orders").find(".shipment").each(function(a,c){b.push(a)});n.isFTCMobileUpsellBannerMetricsEnabled()&&
d.increaseCount("checkout:spc:mobile:same-day-upsell-banner:clicked",1);P(a,b)}function P(a,c){k.show();var d="returnpipedata\x3d0\x26returnFullHTML\x3d1\x26cachebuster\x3d"+(new Date).getTime()+"\x26hasWorkingJavascript\x3d1",e="/gp/buy/spc/handlers/set-delivery-options.html/ref\x3d"+a.data("reftag");E("#spc-orders").find(".shipment").each(function(b,e){d+="\x26lineitemids"+b+"\x3d"+E(e).find("input[type\x3d'hidden'][name\x3d'lineitemids"+b+"']").attr("value");d+=N(E(e),b);var f=E(e).find("input[type\x3d'hidden'][name^\x3d'shippriority']");
if(e=-1===c.indexOf(b)?E(e).find("#selected-ship-option-"+b):a)d+="\x26shippingofferingid"+b+"\x3d"+e.data("shippingofferingid"),d+="\x26guaranteetype"+b+"\x3d"+e.data("guaranteetype"),d+="\x26issss"+b+"\x3d"+e.data("issss"),d+="\x26forceshipsplitpreference"+b+"\x3d"+e.data("forceshipsplitpreference"),d+="\x26shippriority"+b+"\x3d"+e.data("targetshipoptionkey"),e.data("rcxsspdecoupling")&&(d+="\x26preferredSSP"+b+"\x3d"+e.data("shipsplitpriority"),d+="\x26currentSSP"+b+"\x3d"+f.attr("value"),d+="\x26isShipWheneverValid"+
b+"\x3d"+e.data("isshipwhenevervalid"),d+="\x26isShipWhenCompleteValid"+b+"\x3d"+e.data("isshipwhencompletevalid"))});var f=E("#spc-orders").find("input[type\x3d'hidden'][name\x3d'groupcount']").val(),d=d+("\x26groupcount\x3d"+f),d=d+("\x26isClientTimeBased\x3d"+E("input[type\x3d'hidden'][name\x3d'useCtb']").attr("value")),d=d+("\x26trialkey\x3d"+r()+":"+a.data("orderindex")+":"+a.data("targetshipoptionkey")),f=b.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});E.ajax({type:"POST",url:e,data:d,
dataType:"text",async:!0,cache:!1,headers:f,success:function(a,b,c){u(a,b,c)},error:function(a,c,d){b.ajaxRedirect(a,c,d)}})}function G(b,c,d,f){e.protectAgainstDoubleAction(c)||R||(a.trigger(d,b),b=b.$currentTarget.find("a"),f&&f(b))}function N(a,b){var c=a.find("input[name\x3d'onOrAfterAppointment"+b+"']").val();a=a.find("input[name\x3d'onOrAfterLineItemId"+b+"']").val();var d="";c&&a&&(d=d+("\x26onOrAfterAppointment"+b+"\x3d"+c)+("\x26onOrAfterLineItemId"+b+"\x3d"+a));return d}function Q(){Y.closest("div.shipping-speed").find('input[type\x3d"radio"]').attr("checked",
!0);"undefined"!==typeof h?(0<E(".mobile-view").length?h.get(E("#faster-than-same-day-sosp-popover")):h.get(E("#faster-than-same-day-spc-popover"))).hide():a.$("div.a-popover button.a-button-close").trigger("click");D(Y,null,null,{removeGiftOption:!0})}var E=a.$;if(!E("html").hasClass("a-ie6")){var F,U={},X=E("html").hasClass("a-touch"),aa,Z={},ga,Y;p.spcpage.scheduledDeliverySetSOCallback=function(c,d){b.isSPP()&&a.objectIsEmpty(c)||(p.spcpage&&E("#spcpagecontent").is(":visible")?p.spcpage.actionSetShipOptions(null,
d,c):D(null,d,c))};p.spcpage.scheduledDeliveryEnableSOCallback=function(){};E(document).delegate(".ship-option","click",function(b){var c=E(b.target);n.isSPCMobileDisplayMoreShipOptionsEnabled()&&E(b.target).closest(".ship-option").hasClass("mobile-view")&&b.preventDefault();var f=E(b.currentTarget);d.resetMetrics();if(!(c.is('a[target\x3d"AmazonHelp"]')||c.is('a[target\x3d"PromoDetails"]')||c.hasClass("no-ship-option-selection-change")||f.is("input")||c.hasClass("a-button")||c.closest("a-button").length||
c.is("img")&&(c.closest("div").is(".prime-ship-speed")||c.closest(".prime-fake-radio").parent().is(".prime-ship-speed"))))if(c=f.find("div.prime-ship-speed"),0<c.length)c.find("a:first img").trigger("click");else if((c=f.find("input[type\x3d'image']").attr("src"))&&c.match(/radio-off/)&&E(".ap_popover_sprited").hide(),f=f.find("input[type\x3d'radio']"),(c=f.closest("div.shipping-speeds").data("sospargs"))&&1===f.data("isscheduleddelivery")&&!f.is(":checked"))k.show(),f.attr("checked",!0),x(f),e.redirectWithJavascript("/gp/buy/shipoptionselect/handlers/display.html?"+
c);else if(n.removesGiftOptionOnRush()&&0<f.closest(".shipment").find("input[name^\x3dItemIsGift]").length&&1===f.closest(".radio-standard").data("nosupportforgiftoption")){Y=f;Y.is(":checked")&&(Y.attr("checked",!1),ga.attr("checked",!0));var g=0<E(".mobile-view").length?E("#faster-than-same-day-sosp-popover"):E("#faster-than-same-day-spc-popover");"undefined"!==typeof h?h.get(g).show():a.delay(function(){g.trigger("click")},10)}else{f.hasClass("js-no-serverside-callback")&&(f.attr("checked",!0),
x(f),f.closest(".a-section-expander-container").find(".a-link-section-expander").click());var c=E("#disableSubmitButtons").length,l=!1;n.isSPCMobileDisplayMoreShipOptionsEnabled()&&(b=E(b.currentTarget).closest(".ship-option"),b.hasClass("mobile-view")&&!b.hasClass("mobile-selected-option")&&(l=!0));!c&&f.is(":checked")&&!l||1===f.data("isscheduleddelivery")||(f.attr("checked",!0),D(f))}});E(document).delegate(".ship-option input[type\x3d'radio']","change",function(a){if(!n.isSPCMobileDisplayMoreShipOptionsEnabled()||
!E(a.target).closest(".ship-option").hasClass("mobile-view")){a=E(a.currentTarget);var b=a.closest("div.prime-ship-speed");n.removesGiftOptionOnRush()&&0<a.closest(".shipment").find("input[name^\x3dItemIsGift]").length&&1===a.closest(".radio-standard").data("nosupportforgiftoption")||(0<b.length?b.find('input[type\x3d"radio"]').attr("checked",!1):1!==a.data("isscheduleddelivery")&&D(a))}});a.declarative("shipping-speed-expander-toggle",["click"],function(a){var b=a.$target.closest(".a-box"),c,d;b.hasClass("a-single")?
(c=b.find(".expanded-header-content"),d=b.find(".collapsed-header-content"),d.hide(),c.hasClass("prime-title")&&c.find("div").attr("style",""),c.show()):(d=b.find(".collapsed-header-content"),c=b.find(".expanded-header-content"),b=b.siblings(".a-expander-content").find(".a-icon-touch-radio-active").siblings(".a-radio-label").html(),d.html(b),c.hide(),d.show());e.toggleExpanderContent(a)});a.declarative("select-prime-slot",["click"],function(a){a=a.$currentTarget;E(".a-button-close").trigger("click");
a.closest(".valid-slot").hasClass("selected-slot")||D(a)});var R=!1;E(document).delegate(".mobile-upsell","touchmove",function(a){R=!0});E(document).delegate(".mobile-upsell","touchstart",function(a){R=!1});a.declarative("select-upsell-shipping-speed",["click","touchend"],function(a){G(a,"select-upsell-shipping-speed","a:checkout:mobile-upsell-shipping-speed:select",H)});a.declarative("select-all-upsell-shipping-speed",["click","touchend"],function(a){G(a,"select-all-upsell-shipping-speed","a:checkout:mobile-upsell-shipping-speed:select-all",
M)});a.declarative("faster-than-same-day-save",["click"],Q);a.declarative("faster-than-same-day-sosp-save",["click"],Q);a.on("checkout:reload:spc",c);a.on("checkout:reload:spp-revieworder",c)}});"use strict";q.when("A","page-detector","spc-page-state","client-side-metrics","page-conductor","weblab-helper").register("order-summary-controller",function(a,k,g,b,e,f){function m(){z=c("#transactionalRadio");v=c("#marketplaceRadio");t=c("#tfx-see-exchange-rates");q=c("#tfx-switch-currency-options");l||
(b.increaseCount("removeauijs15"),c("#transactionalRadioImage").remove(),c("#marketplaceRadioImage").remove(),c("#acceptAccImage").remove());var a=c("#exchange-rate-link"),e=c("#switch-currency-link");if(0!==v.length){var h=q.find('input[name\x3d"switchCurrency"]'),k=h.not(":checked"),h=g.prop("currencyType")||h.filter(":checked").val();k.val()===h?f.isFixTfxInitializeEnabled()?k.trigger("click"):k.parent().trigger("click"):d(h);l||(b.increaseCount("removeauijs16"),a.find("i.a-icon-collapse").remove(),
e.find("i.a-icon-collapse").remove())}}function d(d){c(".tfx-currency").each(function(){c(this).text(c(this).data(d))});g.prop("currencyType",d);var h=c("#subtotals-marketplace-table"),n=c("#subtotals-transactional-table"),m=c("#subtotals-marketplace-spp-bottom"),p=c("#subtotals-transactional-spp-bottom"),q=c("#vatRetailSubtotals-transactional-table"),w=c("#vatGlobalSubtotals-transactional-table"),H=c("#vatMerchantSubtotals-transactional-table"),C=c("#vatRetailSubtotals-marketplace-table"),P=c("#vatGlobalSubtotals-marketplace-table"),
G=c("#vatMerchantSubtotals-marketplace-table"),N=c(".place-your-order-button"),Q=c("#fx-enable"),E=e.isSPP()?c(".place-order-button-text"):c(".place-your-order-button + span");e.isSPP()||setTimeout(function(){var a=Math.max(h.outerHeight(),n.outerHeight());0<a&&(h.height(a),n.height(a))},500);if(!l){b.increaseCount("removeauijs17");var F=v.siblings("i"),U=z.siblings("i");if(F.hasClass("a-icon-touch-radio-inactive")||F.hasClass("a-icon-touch-radio-active"))"marketplace"===d?(F.removeClass("a-icon-touch-radio-inactive").addClass("a-icon-touch-radio-active"),
U.removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive")):(U.removeClass("a-icon-touch-radio-inactive").addClass("a-icon-touch-radio-active"),F.removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive"))}"marketplace"===d?(c("#fxGoodNews-transactional").hide(),c("#fxGoodNews-marketplace").show(),n.hide(),h.show(),p.hide(),m.show(),q.hide(),w.hide(),H.hide(),C.show(),P.show(),G.show(),f.isTFXGuaranteedExchangeFeeEnabled()&&(t.hide(),Q.hide()),N.val(c("#placeYourOrderTextMarketplace").val()),
l&&E.text(c("#placeYourOrderTextMarketplace").val()),c("#currencyChanged").attr("value","true"),c("#fxCurrencyChoice").attr("value","marketplace"),c("#tfx-total-header").addClass("aok-hidden"),c("#mkt-total-header").removeClass("aok-hidden")):(c("#fxGoodNews-transactional").show(),c("#fxGoodNews-marketplace").hide(),h.hide(),n.show(),m.hide(),p.show(),C.hide(),P.hide(),G.hide(),q.show(),w.show(),H.show(),f.isTFXGuaranteedExchangeFeeEnabled()&&(t.show(),Q.show()),N.val(c("#placeYourOrderTextTransactional").val()),
l&&E.text(c("#placeYourOrderTextTransactional").val()),c("#currencyChanged").attr("value","false"),c("#fxCurrencyChoice").attr("value","transactional"),c("#mkt-total-header").addClass("aok-hidden"),c("#tfx-total-header").removeClass("aok-hidden"));a.trigger("checkout:spc:ordersummary:sizeChanged");k.isMobileSpc()&&(m=c("#vatBreakdownNote"),0<m.size()&&(p=m.attr("href"),p=0<p.lastIndexOf(".html?")?p+("\x26currencyType\x3d"+d):p+("?currencyType\x3d"+d),m.attr("href",p)))}function n(a){var e=c("#tfx-footer"),
f=c("#tfx-header");if(!l){b.increaseCount("removeauijs18");var g=c("#fxApplicabilityDecision").siblings("i"),k=c("#fxApplicabilityAdoption").siblings("i");if(k.hasClass("a-icon-touch-checkbox-inactive")||k.hasClass("a-icon-touch-checkbox-active"))k.removeClass("a-icon-touch-checkbox-active").addClass("a-icon-touch-checkbox-inactive"),g.removeClass("a-icon-touch-checkbox-inactive").addClass("a-icon-touch-checkbox-active")}"accept"===a?(h()?(c("#fx-terms-and-conditions").show(),c("#fxCardCurrencySubcondition").hide()):
(c("#fx-enable").show(),c("#fx-disable").hide()),c("#fxApplicabilityDecision").prop("checked",!0),f.show(),d("transactional"),e.show(),c("#marketplaceRadio").prop("checked",!1),c("#transactionalRadio").prop("checked",!0),c("#fxApplicabilityChoice").attr("value","accept")):(h()?(c("#fx-terms-and-conditions").hide(),c("#fxCardCurrencySubcondition").show()):(c("#fx-enable").hide(),c("#fx-disable").show()),c("#fxApplicabilityAdoption").prop("checked",!1),f.hide(),d("marketplace"),e.hide(),c("#transactionalRadio").prop("checked",
!1),c("#marketplaceRadio").prop("checked",!0),c("#fxApplicabilityChoice").attr("value","decline"))}function h(){return e.isSPP()&&c("input[name\x3disNewTFXExperienceEnabled]").length}var c=a.$;if(!c("html").hasClass("a-ie6")){var l=p.P&&p.P.AUI_BUILD_DATE,t,q,z,v;f.isFixTfxCurrencyToggleEnabled()?(c(document).delegate("#transactionalRadio","click",function(){d("transactional")}),c(document).delegate("#marketplaceRadio","click",function(){d("marketplace")})):(c(document).delegate("#checkoutCurrencyTransactional",
"click",function(){d("transactional")}),c(document).delegate("#checkoutCurrencyMarketplace","click",function(){d("marketplace")}));c(document).delegate("#fxApplicabilityDecisionCheckbox","click",function(){n("decline")});c(document).delegate("#fxApplicabilityAdoptionCheckbox","click",function(){var a=h()&&!c("#fxApplicabilityAdoption").is(":checked");n(a?"decline":"accept")});a.on("a:expander:tfx-options-expander:toggle:expand",function(a){b.increaseCount("checkout:spp-ordersummary:expand_tfx_options",
1)});a.on("a:expander:tfx-see-rate-expander:toggle:expand",function(a){b.increaseCount("checkout:spp-ordersummary:expand_tfx_see_rate",1)});return{changeCurrency:d,initOrderSummary:m}}});"use strict";q.when("A","ready").register("spc-page-state",function(a){var k={};return{prop:function(a,b){if(a&&"string"===typeof a)return 1<arguments.length&&(k[a]=b),k[a]}}});"use strict";q.when("A","ready").execute(function(a){function k(){0<g("#spcCachedPromiseData").length&&(b=(new Date).getTime(),g(".place-your-order-button").click(function(){var a=
(new Date).getTime()-b;g("#spc-form").append("\x3cinput type\x3d'hidden' name\x3d'spcWaitingTime' value\x3d'"+a+"' /\x3e")}))}var g=a.$,b=0;a.on("checkout:reload:spc",k);a.on("checkout:reload:spclite",k);a.on("checkout:reload:spp-revieworder",k)});"use strict";q.when("A","page-transition-controller","scroll-controller","loading-spinner-controller","page-conductor","checkout-general-utils","ready").register("changeCustomerDetailsPopover",function(a,k,g,b,e,f){function m(){return 0<h("#onblur-character-validation-error-changeNameInput").size()}
function d(){c&&c.find("button[data-action\x3da-popover-close]").trigger("click")}function n(){var a=h("#saveButton");if(a.length){var b=h("#changeNameInput"),c=h("#changePostNumberInput"),d=h("#changePhoneInput"),e=1,f=1,g=1;b.length&&!b.val()&&(e=0);c.length&&!c.val()&&(f=0);d.length&&!d.val()&&(g=0);e&&f&&g&&!m()?(a.removeClass("a-button-disabled"),a.removeAttr("disabled")):(a.addClass("a-button-disabled"),a.attr("disabled","true"))}}var h=a.$,c;a.declarative("clickedsave","click submit",function(a){if(!m()){var b=
h("#changeNameInput").val(),c=h("#changePhoneInput").val(),f=h("#changePostNumberInput").val(),g=h("#changeAccountNameCheckBox").is(":checked")?1:0,n=h("#changePostNumberCheckBox").is(":checked")?1:0,b="custName\x3d"+encodeURIComponent(b)+"\x26changeAccountName\x3d"+encodeURIComponent(g);c&&(b=b+"\x26custPhoneNumber\x3d"+encodeURIComponent(c));f&&(b=b+"\x26dhlPostNumber\x3d"+encodeURIComponent(f),n&&(b=b+"\x26changeDhlPostNumberInEmbu\x3d"+encodeURIComponent(n)));c=a.data.changeDetailUrl;e.isSPP()&&
(c=a.$target.data("changedetailurl"),h("#cancelReminderPopover").click());e.isSPP()||(b+="\x26usePipelineDispatch\x3d1");k.show();c&&h.ajax({type:"POST",data:b,url:c,dataType:"html",contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",async:!0,cache:!1,headers:e.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"}),success:function(a,b,c){d();k.hide();e.ajaxUpdatePage(a,b,c)},error:function(a,b,c){e.ajaxRedirect(a,b,c)}})}});a.declarative("clickedsave","mouseenter mousemove touchstart",
function(a){n()});a.declarative("changeNameKeyIn changePostNumberKeyIn changePhoneNumberKeyIn","keydown keyup change keypress mouseenter mouseleave mousemove",function(a){n()});a.declarative("clickedcancel","click submit",function(a){d()});a.on("a:popover:beforeShow:changeDetailPopover",function(a){m()&&h("#onblur-character-validation-error-changeNameInput").remove()});a.on("a:popover:show:changeDetailPopover",function(a){if(!e.isSPP()){var b=h(p).width(),d=h(p).height(),b=parseInt(.6*b,10),d=parseInt(.7*
d,10);c=a.popover.$popover;var f=a.popover;c.css("position","absolute");c.css("top","50px");c.css("height",d+"px");c.css("width",b+"px");f.updatePosition()}b=e.isSPP()?a.popover.originalnamevalue:a.popover.$trigger.data("original-name-value");d=e.isSPP()?a.popover.originalcellphonevalue:a.popover.$trigger.data("original-cellphone-value");a=e.isSPP()?a.popover.originalpostnumbervalue:a.popover.$trigger.data("original-postnumber-value");var f=h("#changeNameInput"),g=h("#changePhoneInput"),k=h("#changePostNumberInput");
f.val(b);g.val(d);k.val(a);n()})});"use strict";q.when("A","page-transition-controller","ajax-utility","page-conductor","page-detector","checkout-general-utils").register("prime-decline-controller",function(a,k,g,b,e,f){function m(){n("input[name\x3d'changeCardNoEndDatePrime']").attr("data-action","prime-decline-element")}function d(a,c,d){if(d.getResponseHeader("x-amz-checkout-page"))b.ajaxUpdatePage(a,c,d);else{a=g.jsonify(a);if(!a)return b.redirect();a.error?k.hide():a.errors?k.hide():a.autohandlererror?
(c=(a=a.autohandlererror)?a.action:null,d=a&&a.type?a.type:c&&c.code?c.code:"string"===typeof a?a:"Unknown:pipelineJSError",p.location.href="fatal"===c?"/gp/buy/payselect/handlers/error.html?errorAction\x3dfatal\x26errorType\x3d"+encodeURIComponent(d):"redirect"===c?a.url:"/gp/buy/payselect/handlers/error.html?errorType\x3d"+encodeURIComponent(d)):b.redirect(a)}}var n=a.$;n("html").hasClass("a-ie6")||(a.declarative("prime-decline-element",["click","touchend"],function(a){f.protectAgainstDoubleAction("prime-decline-element")||
(a.$event.preventDefault(),k.show(),a=(new Date).getTime(),a="changeCardNoEndDatePrime\x3d1\x26hasWorkingJavascript\x3d1\x26returnjson\x3d1\x26returnFullHTML\x3d1\x26fromAnywhere\x3d"+n("input[name\x3dfromAnywhere]").val()+"\x26cachebuster\x3d"+a,n.ajax({type:"POST",url:"/gp/buy/spc/handlers/stuff-handler.html/ref\x3dox_spc_prime_renew_nodate",data:a,headers:{"Cache-Control":"no-cache",pragma:"no-cache","x-amz-checkout-page":"spc"},contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",
dataType:"text",success:d,error:b.ajaxRedirect}))}),a.on("checkout:reload:spc",m),a.on("checkout:reload:spp-revieworder",m))});"use strict";q.when("A","loading-spinner-controller","page-conductor").register("prime-popover-controller",function(a,k,g){function b(){f={};a.defer(function(){0!==e("#spc-orders").find(".prime-popover-link").length&&(e("#spc-orders").find(".prime-popover-link").each(function(){var a=e(this);if(a.data("action")){a.removeAttr("href").attr("tabindex",0);var b=a.data("aCheckoutModalPopover");
var g=b.name,h="";b.width&&b.height&&(h="width:"+b.width+"px;height:"+b.height+"px;");0<e("#spc-orders").find("#"+g+"-popover").length||(b=e(['\x3cdiv id\x3d"a-popover-'+g+'" class\x3d"a-popover-preload" style\x3d"display:none;"\x3e','\x3cdiv id\x3d"'+g+'-popover" class\x3d"checkout" style\x3d"'+h+'"\x3e\x3c/div\x3e',"\x3c/div\x3e"].join("")),e("#spc-orders").append(b));a=a.data("aCheckoutModalPopover").name;f[a]||(b=e(".prime-popover-content").html())&&0<b.length&&(f[a]=b,e("#"+a+"-popover").html(b))}}),
e("#spc-orders").find(".a-box").each(function(){var a=e(this),b=a.find(".prime-ad-banner-content .prime-popover-link");1<b.length&&(b=b.first());a.find("a.primeAdLauncher").each(function(){var a=e(this);a.wrap('\x3cspan class\x3d"a-declarative" data-action\x3d"prime-event" data-prime-event\x3d\'{"metric":"lm3"}\'\x3e\x3c/span\x3e');a.replaceWith(b.clone().text(a.text()).addClass("a-size-mini"))})}))})}var e=a.$;if(!e("html").hasClass("a-ie6")){var f={};a.on("a:popover:show",function(a){if(a.popover&&
a.popover.name&&0===a.popover.name.indexOf("prime")&&(a=a.popover.name,!f[a])){var b=e("input#primePopopverFallbackContent").val()||"";f[a]=b;e("#"+a+"-popover").html(b)}});a.on("checkout:reload:spc",b);a.on("checkout:reload:spp-revieworder",b)}});"use strict";q.when("A","page-transition-controller","back-button-protection","page-conductor","continue-wrapper-selector","weblab-helper").register("place-order-controller",function(a,k,g,b,e,f){function m(){if(!b.isAnimating()){var d=n("#spc-form");if("0"===
n("#showPageTransition").attr("content"))if(d.hasClass("paylast-spc"))k.show();else{if(0<n("#enableAlternatePYOBlocker").length){var c;c=e.SELECTOR?n(e.SELECTOR):d.find(".a-button.continue-button");if("disabled"===c.find("input").attr("disabled"))return;c.find("input").attr("disabled","disabled");c.addClass("a-button-disabled");setTimeout(function(){c.removeClass("a-button-disabled");c.find("input").removeAttr("disabled")},4E4)}}else k.showPageTransition();var l=n("#currencyChanged");0<l.length&&
"true"===l.val()&&(l='\x3cinput type\x3d"hidden" name\x3d"checkoutCurrencySelection.'+n("#tfx-switch-currency-options").find("input:radio:checked").val()+'" /\x3e',n("#spc-form-inputs").append(l));if(f.isMfaPSD2DeviceDescriptionCollectionEnabled())for(var l=[{name:"javaEnabled",value:p&&p.navigator&&p.navigator.javaEnabled()},{name:"language",value:p&&p.navigator&&p.navigator.language},{name:"screenColorDepth",value:p&&p.screen&&p.screen.colorDepth},{name:"screenHeight",value:p&&p.screen&&p.screen.height},
{name:"screenWidth",value:p&&p.screen&&p.screen.width},{name:"timeZone",value:(new Date).getTimezoneOffset()}],m=0;m<l.length;m++)if(l[m].name!==C&&l[m].value!==C){var q='\x3cinput type\x3d"hidden" name\x3d"'+l[m].name+'" value\x3d"'+l[m].value+'" /\x3e';n("#spc-form-inputs").append(q)}d.append("\x3cinput type\x3d'hidden' name\x3d'placeYourOrder1' value\x3d'1' /\x3e");(l=a.state("firetv-aws-attributes"))&&l.queryParams&&(m=d.attr("action"),m+=0<=m.indexOf("?")?"\x26":"?",m+=n.param(l.queryParams),
d.attr("action",m));b.isSPP()&&d.append(n("#subtotalsSection").find("input").hide());g.markAsDirty();d.submit()}}function d(a){a.preventDefault();m(a.target)}var n=a.$;if(!n("html").hasClass("a-ie6"))return a.declarative("a-checkout-place-order",["click"],function(a){m(a.target)}),n(document).delegate("span.place-order-button-link","click",d),{placeOrderClick:m,placeOrderClickDelegate:d,PLACE_ORDER_BUTTON_LINK_SELECTOR:"span.place-order-button-link"}});"use strict";q.register("continue-wrapper-selector",
function(){return{SELECTOR:null}});"use strict";q.when("A","page-conductor","button-blocker","client-side-metrics","weblab-helper").register("verification-checkbox-controller",function(a,k,g,b,e){function f(a){v?m(a):d(a);A&&a&&a.blocking&&(b.setmarker("fn"),A=!1)}function m(a){var b=t(".continue-button"),d=t(".continue-button-blocker"),e=t(".place-order-blocker-message.custom-blocker-message");if(a.blocking||!c())a.blocking?(e.text(a.message),b.addClass("aok-hidden"),d.removeClass("aok-hidden")):
(e.empty(),b.removeClass("aok-hidden"),d.addClass("aok-hidden"),q.when("a-tooltip").execute(function(a){(a=a.get(d))&&a.isActive()&&a.hide()}))}function d(a){a.blocking?g.show("place-order-imb-checks",a.message):(g.hide("place-order-imb-checks"),t("#hasTVNavigation").length&&q.when("a-tv").execute(function(a){a.select(".continue-button")}))}function n(){var c,d={blocking:!1,message:""};if(v)c=t("#spc-imb").find(".verification-checkbox input:not(:checked)"),0<c.length&&(d={blocking:!0,message:c.first().closest(".verification-checkbox").attr("data-blocker-message")});
else{b.increaseCount("removeauijs23");if(!t("#spc-imb").find(".verification-checkbox").length)return;c=k.isSPP()?t("#spc-imb").find(".verification-checkbox input:not(:checked)"):t("#spc-imb").find(".verification-checkbox:not(:checked)");0<c.length&&(d={blocking:!0,message:k.isSPP()?c.first().closest(".spp-panel").hasClass("aok-hidden")?c.first().closest(".verification-checkbox").data("non-review-panel-blocker-msg"):c.first().closest(".verification-checkbox").data("blocker-message"):c.first().attr("data-blocker-message")})}e.isPyoClientSideInitiationEnabled()?
f(d):a.trigger("checkbox:primaryActionBlocker:blockingStateChanged",d)}function h(){var a=t("#wineNoticeCheckbox");a&&a.length&&(w?(a.attr("checked",""),z&&(a=a.siblings(".a-icon-touch-checkbox-inactive"))&&a.length&&(a.removeClass("a-icon-touch-checkbox-inactive"),a.addClass("a-icon-touch-checkbox-active"))):(a.removeAttr("checked",""),z&&(a=a.siblings(".a-icon-touch-checkbox-active"))&&a.length&&(a.removeClass("a-icon-touch-checkbox-active"),a.addClass("a-icon-touch-checkbox-inactive"))))}function c(){var a=
t("input[name\x3disINExpressCheckoutCC]");return a&&a.length?1===parseInt(a.val(),10):!1}function l(){e.isPyoClientSideInitiationEnabled()||h();t('[data-client-component\x3d"PrimaryActionBlockerCheckbox"]').length||(n(),e.isPyoClientSideInitiationEnabled()&&h());var a=p.P&&p.P.AUI_BUILD_DATE?'.verification-checkbox input[type\x3d"checkbox"]':"input.verification-checkbox";t("#spc-imb").find(a).unbind("change.verification-checkbox").bind("change.verification-checkbox",n)}var t=a.$,w,z=t("html").hasClass("a-touch"),
v=!k.isSPP()&&p.P&&p.P.AUI_BUILD_DATE,A=!0;if(!t("html").hasClass("a-ie6")){if(!e.isPyoClientSideInitiationEnabled())a.on("checkbox:primaryActionBlocker:blockingStateChanged",f);a.declarative("change-wine-notice-checkbox",["change"],function(a){w=a.$target.is(":checked")?1:0});a.on("checkout:reload:spc",l);a.on("checkout:reload:spclite",l);a.on("checkout:reload:spp-revieworder",l);a.on("checkout:reload:spp-collapsed",l);a.on("checkout:unload",function(){A=!0});a.on("checkout:afterReload",function(){A=
!1});return{verifyCheckboxes:n,updatePyo:f}}});"use strict";q.when("A","page-transition-controller","scroll-controller","ajax-utility","page-conductor","quantity-service","checkout-modal-popover","page-detector","checkout-general-utils","a-popover","client-side-metrics","weblab-helper").register("quantity-update-controller",function(a,k,g,b,e,f,m,d,n,h,c,l){function t(){aa=X=!1;a.defer(function(){var a=G("#spc-orders");a.find("a.quantity-change-button-static").remove();"1"!==G("#spc-form-inputs").find("input[name\x3d'isQuantityInvariant']").val()&&
a.find("div.quantity-value-static").remove()});G(".lineitem").each(function(a,b){a=G(b);a.find(".no-js-quantity").remove();b=a.find(".quantity-dropdown");b.is(":visible")?(a.find(".js-select").prop("disabled",!1),b.removeClass("a-button-disabled")):(a=a.find(".quantity-input"),a.prop("disabled",!1),a.removeClass("a-form-disabled"))});var b=G("#pantry-mov-popover-content"),d=G("#pantry-mov-popover-placeholder");!b.length&&d.length&&(b=d.attr("data-device"),G.ajax({type:"GET",url:"/gp/pantry/checkout/mov/get-pantry-mov-popover-contents.html",
data:"device\x3d"+b,dataType:"text",async:!0,cache:!1,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",success:function(a,b,e){~a.indexOf("pantry-mov-popover-content")?d.append(a):c.increaseCount("checkout:pantry:pantry_mov_popover_contents:bad-content",1)},error:function(a,b,d){c.increaseCount("checkout:pantry:pantry_mov_popover_contents:"+d,1)}}))}function w(a,b){a=G('.update-quantity-error[data-itemid\x3d"'+a+'"]');a.find(".error-message").hide();a.find('.error-message[data-error-type\x3d"'+
b+'"]').show();a.find("i").show();a.find(".a-span12").show();a.show();b=a.closest(".item-details-right-column");b.find(".spc-quantity-dropdown-button").addClass("a-button-error");b.find(".spc-quantity-input").addClass("a-form-error");b=a.parents("div.update-quantity-error");a=b.siblings(".item-details");0<a.length&&(a.find(".a-input-text-wrapper").addClass("a-form-error"),a.removeClass("a-spacing-large"),a.find(".a-touch-select").addClass("a-input-text a-form-error"));b.show()}function z(a,d,f){var l=
f.getResponseHeader("x-amz-checkout-new-cart-quantity");n.updateCartByMash(l);if(f.getResponseHeader("x-amz-checkout-page"))e.ajaxUpdatePage(a,d,f,{pushNewFrame:"false"}),a=f.getResponseHeader("x-amz-checkout-updated-itemid"),f=f.getResponseHeader("x-amz-checkout-quantity-error"),a&&f&&w(a,f);else if(a=b.jsonify(a))if(a&&a.errors&&a.errors.pantry&&a.errors.pantry.mov)A(a.errors.pantry.showAddonInfo);else{if(a&&a.errors&&a.errors.addon&&(e.isSPP()&&c.increaseCount("checkout:spp-revieworder:addon_warn_pri",
1),f=a.errors.addon.type,d=a.errors.addon.asins,v(),G(".item-list").hide(),d.forEach(function(a){G('[data-asin\x3d"'+a+'"]').show()}),f=G("#addon-warning-"+f+"-launcher"),f.length)){G("input[name\x3duseLiveAUI]").length?h.get(f).attrs({$trigger:Z}).show():ga&&G("div.checkout.spc-mobile.aui-templatized").length?f.click():(c.increaseCount("removeauijs19"),a=G.Event("keyup",{triggerPositioningElement:Z,manualTrigger:!0}),f.trigger(a),0<G("div.spc-mobile").length&&(g.scrollToTop(),g.toggleScrollOff()));
k.hide();return}return e.redirect(a)}else e.redirect()}function v(){G("#a-popover-addon-warning-normal .select-address-title").hide();0<N?(G("#a-popover-addon-warning-normal .reduce-title").show(),G("#a-popover-addon-warning-normal .delete-title").hide()):(G("#a-popover-addon-warning-normal .delete-title").show(),G("#a-popover-addon-warning-normal .reduce-title").hide())}function A(a){var b=G("#pantry-mov-popover-launcher"),d=G(".pantry-mov-reduce-prompt"),f=G(".pantry-mov-delete-prompt"),g=G("#pantry-mov-addon-info-container");
b.length?(P()||c.increaseCount("checkout:pantry:pantry_mov_popover:non_spc",1),g.length&&g.empty(),a&&G("#addon-warning-normal-popover-content").length&&(v(),g.length||(g=G("\x3cdiv/\x3e",{id:"pantry-mov-addon-info-container"})),g.append('\x3chr class\x3d"a-divider-normal"\x3e').append(G("#addon-warning-normal-popover-content").html()).appendTo("#pantry-mov-popover-content")),0<N?(d.show(),f.hide()):(f.show(),d.hide()),b.length&&(b.click(),k.hide())):(c.increaseCount("checkout:pantry:pantry_mov_popover_contents:no-launcher",
1),e.redirect())}function r(a,b){k.show();var c={isClientTimeBased:G('input[name\x3d"useCtb"]').val(),fromAnywhere:G("input[name\x3dfromAnywhere]").val(),success:z};if(b)for(var d in b)b.hasOwnProperty(d)&&(c[d]=b[d]);e.isSPP()?(c.ref="chk_ship_chg_qty_pri",b=G("#setOrderingPrefsCheckbox"),b.length&&b.is(":checked")&&(c.saveAsDefaultsSelected=1)):G(".spc-mobile.aui-templatized").length&&(c.ref="ox_spc_change_quantity");b=G("#addon-indicator")&&"true"===G("#addon-indicator").attr("data-has-addon-items");
d=G("#pantry-mov-indicator")&&"true"===G("#pantry-mov-indicator").attr("data-has-pantry-items");a||!b&&!d||(c.istrial=1);f.call(E,N,c);F?F.data("currentQuantity",N):U&&U.data("currentQuantity",N)}function u(){k.hide();p.location="/gp/aw/c/ref\x3dox_spc_deal_expired?app-action\x3dcart"}function C(a){var b=Q;N=Q;F&&q.when("a-dropdown").execute(function(a){F&&(a.getSelect(F).setValue(b.toString()),F.data("currentQuantity",N))});a===Y.addOn&&g.toggleScrollOn();U&&(U.val(b),U.data("currentQuantity",N),
a=U.closest(".quantity-block"),a.find(".change-quantity-button").closest(".a-declarative").removeClass("hidden"),a.find(".quantity-display").removeClass("hidden"),a.find(".quantity-display-block-tablet").removeClass("hidden"),a.find(".dynamic-quantity-update").hasClass("stay-visible")||a.find(".dynamic-quantity-update").addClass("hidden").children().addClass("hidden"))}function x(a,b){var c=a.$currentTarget.is("a")?a.$currentTarget:a.$currentTarget.find("a");E=c.data("entityId");N=0;F=null;Q=c.data("currentQuantity");
Z=G("a.quantity-delete-button[data-entity-id\x3d'"+E+"']");Z.length||(Z=a.$currentTarget);U=c.closest(".dynamic-quantity-update").find(".quantity-input");U.length||(U=null);c.data("isBundleDelete")?setTimeout(function(){G("#pb-delete-trigger-"+c.data("bundleGroupId")).trigger("click")},100):(r(!1,b),m.hideById(c.closest(".a-popover").data("aPopoverId")))}function L(a){if(!n.protectAgainstDoubleAction("order-summary-update-quantity",200)){c.resetMetrics();var b=a.$currentTarget,d=b.closest(".lineitem"),
e=b.find("select"),e=e.length?e:b;E=d.data("entityId");var f=G('.update-quantity-error[data-itemid\x3d"'+E+'"]');U=F=null;e.is("select")?(F=b.find("select"),N=e.val()):(U=d.find(".quantity-input"),N=U.val());Q!==N&&(Z=e.is("select")?F.parent():U,""===N?M(d):"Delete"===N||0===parseInt(N,10)?(a.$event.preventDefault(),n.protectAgainstDoubleAction("delete-item")||D(a)):n.validateNumber(N,0,999)?(f.hide(),d.blur(),d.data("isBundleDelete")?setTimeout(function(){G("#pb-delete-trigger-"+d.data("bundleGroupId")).trigger("click")},
100):r(!1)):w(E,"changeQuantity_quantityNotInRange"))}}function D(a,b){var c=a.$currentTarget.closest(".lineitem");E=c.data("entityId");N=0;c.data("isBundleDelete")?setTimeout(function(){G("#pb-delete-trigger-"+c.data("bundleGroupId")).trigger("click")},100):(r(!1,b),m.hideById(c.closest(".a-popover").data("aPopoverId")))}function H(a){var b=a.$currentTarget.closest(".quantity-text-field").find(".update-quantity-link"),c=a.$currentTarget.is("input")?a.$currentTarget.val():a.$currentTarget.find("input").val(),
d=a.$currentTarget.find("input").data("currentQuantity");Q=d;-1===parseInt(c,10)||""===c?("change"===a.type&&M(a.$currentTarget.closest(".lineitem")),b.hide()):parseInt(c,10)!==d?b.show():b.hide()}function M(a){a.find(".quantity-input").val(Q)}function P(){return e.isSPP()?G("#revieworder").hasClass("expanded")?!0:!1:0<G("div.spc").length?!0:!1}var G=a.$;if(!G("html").hasClass("a-ie6")){var N,Q,E,F,U,X=!1,aa=!1,Z,ga=p.P&&p.P.AUI_BUILD_DATE,Y={addOn:"addOn",pantryMOV:"pantryMOV"};a.declarative("change-quantity",
["click","touchend"],function(a){if(!n.protectAgainstDoubleAction("lock-update-quantity",200)){a=a.$currentTarget;var b=!0;a.addClass("hidden");a=a.closest(".quantity-block");a.find(".change-quantity").addClass("hidden");a.find(".quantity-display").addClass("hidden");a.find(".quantity-display-block-tablet").addClass("hidden");a.find(".dynamic-quantity-update").removeClass("hidden").find(".hidden").each(function(){var a=G(this);a.removeClass("hidden");a.is("input")&&(a.focus(),a.select(),a.unbind("keydown.update-quantity-spc").bind("keydown.update-quantity-spc",
function(a){13===a.which&&a.preventDefault()}),a.unbind("keyup.update-quantity-spc").bind("keyup.update-quantity-spc",function(a){13!==a.which||b||G(a.target).closest(".dynamic-quantity-update").find(".update-quantity-button").trigger("click")}))});setTimeout(function(){b=!1},500)}});a.declarative("order-summary-get-quantity",["click","touchend"],function(a){n.protectAgainstDoubleAction("order-summary-get-quantity",200)||a.$currentTarget.find("select").length&&(Q=a.$currentTarget.find("select").val())});
a.declarative("order-summary-update-quantity",["change"],L);a.declarative("order-summary-update-quantity-text-field",["click","touchend"],L);a.declarative("order-summary-handle-text-input",["keydown"],function(a){13===a.$event.which?(a.$event.preventDefault(),L(a)):n.limitInputToNumbers(a)});a.declarative("order-summary-show-update-button",["change","keyup"],H);a.declarative("trigger-update-quantity-button",["keydown"],function(a){13===a.$event.which&&(a.$event.preventDefault(),a.$currentTarget.closest(".quantity-block").find(".update-quantity-button").trigger("click"))});
a.declarative("toggle-update-quantity-button",["change","keyup"],function(a){var b=a.$currentTarget.closest(".quantity-block").find(".update-quantity-button"),c=a.$currentTarget.find("input"),d=c.val(),e=c.data("currentQuantity");""===d?("change"===a.type&&c.val(e),b.hide()):parseInt(d,10)!==e?b.show():b.hide()});a.declarative("update-quantity",["click","touchend"],function(a){c.resetMetrics();var b=a.$currentTarget.is("a")?a.$currentTarget:a.$currentTarget.find("a");a=b.closest(".quantity-block");
var d=b.closest(".dynamic-quantity-update"),e=d.find(".quantity-input");d.length||(e=a.find(".quantity-input"));if(n.protectAgainstDoubleAction("lock-update-quantity",200))e.focus();else{var f=e.val();E=b.data("entityId");var g=G('.update-quantity-error[data-itemid\x3d"'+E+'"]');n.validateNumber(f,0,999)?(g.hide(),d.find(".a-form-error").removeClass("a-form-error"),e.removeClass("a-form-error"),f=parseInt(f,10),U=e,Q=U.data("currentQuantity"),Q=parseInt(Q,10),f===Q?(a.find(".change-quantity-button").closest(".a-declarative").removeClass("hidden"),
a.find(".quantity-display").removeClass("hidden"),a.find(".quantity-display-block-tablet").removeClass("hidden"),d.addClass("hidden").children().addClass("hidden")):(N=f,Z=b,b.blur(),b.data("isBundleDelete")?setTimeout(function(){G("#pb-delete-trigger-"+b.data("bundleGroupId")).trigger("click")},100):r(!1))):w(E,"changeQuantity_quantityNotInRange")}});G(document).delegate(".spc-quantity-dropdown","change",function(a){F=G(a.currentTarget);c.resetMetrics();ga?(a=F.next(),E=a.data("entityId"),Q=a.data("currentQuantity")):
(c.increaseCount("removeauijs21"),E=F.data("entityId"),Q=F.data("currentQuantity"));var b=F.find(":selected");N=parseInt(b.val(),10);Q!==N&&(a=G("#toggleDropdownQuantityTrigger"),a.length&&N===parseInt(a.val(),10)?(a=F.closest(".quantity-block"),a.find(".spc-quantity-dropdown-button").hide(),a.find(".quantity-input").show()):(Z=F.parent(),F.blur(),b&&b.data("isBundleDelete")?setTimeout(function(){G("#pb-delete-trigger-"+b.data("bundleGroupId")).trigger("click")},100):r(!1)))});a.declarative("dont-delete-item",
["click","touchend"],function(a){a.$event.preventDefault();n.protectAgainstDoubleAction("dont-delete-item")||m.hideById(a.$currentTarget.closest(".a-popover").data("aPopoverId"))});a.declarative("delete-item",["click","touchend"],function(a){a.$event.preventDefault();n.protectAgainstDoubleAction("delete-item")||x(a)});a.declarative("delete-prime-membership-item-confirm",["click","touchend"],function(a){a.$event.preventDefault();if(!n.protectAgainstDoubleAction("delete-prime-membership-item-confirm")){var b=
{additionalData:{deletePrimeMembership:1,primeMembershipASIN:(a.$currentTarget.is("a")?a.$currentTarget:a.$currentTarget.find("a")).data("asin")}};x(a,b)}});a.declarative("bundle-delete",["click","touchend"],function(){n.protectAgainstDoubleAction("bundle-delete")||r(!1)});a.declarative("bundle-delete-action",["click","touchend"],function(a){n.protectAgainstDoubleAction("bundle-delete-action")||(q.when("a-popover-base").execute(function(b){b.get(a.data.popoverName).hide()}),r(!1))});a.declarative("egc-delete",
function(a){E=a.entityId;N=0;r(!0)});a.declarative("bundle-dont-delete",["click","touchend"],function(){n.protectAgainstDoubleAction("bundle-dont-delete")||(N=Q,F&&q.when("a-dropdown").execute(function(a){a.setValue(F.attr("id"),Q.toString());F.data("currentQuantity",N)}))});a.declarative("pantry-return-to-cart-btn",["click","touchend"],function(){n.protectAgainstDoubleAction("pantry-return-to-cart-btn")||P()&&u()});a.declarative("pantry-delete-items-btn",["click","touchend"],function(){!n.protectAgainstDoubleAction("pantry-delete-items-btn")&&
P()&&(aa=!0,G(".a-button-close").trigger("click"),r(!0))});a.declarative("pantry-cancel-delete-btn",["click","touchend"],function(){n.protectAgainstDoubleAction("pantry-cancel-delete-btn")||P()&&C(Y.pantryMOV)});a.on("a:popover:hide:pantry-mov-popover",function(){P()&&(aa||C(Y.pantryMOV))});a.declarative("addon-return-to-cart",["click","touchend"],function(){n.protectAgainstDoubleAction("addon-return-to-cart")||P()&&u()});a.declarative("addon-delete-items",["click","touchend"],function(){n.protectAgainstDoubleAction("addon-delete-items")||
(P()&&(X=!0,G(".a-button-close").trigger("click"),r(!0)),e.isSPP()&&c.increaseCount("checkout:spp-revieworder:addon_delete_pri",1))});a.declarative("addon-dont-delete",["click","touchend"],function(){n.protectAgainstDoubleAction("addon-dont-delete")||(P()&&C(Y.addOn),e.isSPP()&&c.increaseCount("checkout:spp-revieworder:addon_keep_pri",1))});a.on("a:popover:hide:addon-warning-normal",function(){0<G("div.spc-mobile").length?u():P()&&(X||C(Y.addOn))});a.on("a:popover:hide:addon-warning-special",function(){P()&&
(X||C(Y.addOn))});a.on("checkout:reload:spc",t);a.on("checkout:reload:spp-revieworder",t)}});q.when("A","ready").execute(function(a){a.on("a:popover:beforeShow",function(a){if(a.popover.$trigger.hasClass("quantity-dropdown-button")){var g=a.popover.$popover,b=g.closest("div.a-dropdown");b.length&&(a.popover.$iframe.css("max-height","260px"),g.css("max-height","260px"),g=b.find("div.a-popover-inner"),g.css({"max-height":"260px"}),a.popover.updatePosition(),g.css({"overflow-y":"scroll"}))}})});"use strict";
q.when("A","page-transition-controller","page-conductor","ajax-utility").register("tax-exemption-controller",function(a,k,g,b){function e(a,e,f){return f.getResponseHeader("x-amz-checkout-page")?g.ajaxUpdatePage(a,e,f,{pushNewFrame:"false"}):(a=b.jsonify(a))?g.redirect(a):g.redirect()}function f(a,b){var f=b.$target.data("entityId");if(f){k.show();var c={isClientTimeBased:m('input[name\x3d"useCtb"]').val(),fromAnywhere:m("input[name\x3dfromAnywhere]").val()},c=c||{};b={returnFullHTML:1,cachebuster:(new Date).getTime(),
isClientTimeBased:0,hasWorkingJavascript:1};m.extend(b,c);b.entityId=f;b.optOut=a;a=g.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});m.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/tax-exemption-optout.html",data:m.param(b),dataType:"text",async:!0,cache:!1,headers:a,success:e,error:g.ajaxRedirect})}else p.ueLogError&&p.ueLogError({name:"MissingData",message:"lineItemId is undefined, when trying to opt out from tax exemption",logLevel:"FATAL"})}var m=a.$;m("html").hasClass("a-ie6")||(a.declarative("tax-exemption-opt-out",
["click","touchend"],function(a){f(!0,a)}),a.declarative("tax-exemption-opt-in",["click","touchend"],function(a){f(!1,a)}))});"use strict";q.when("A").execute(function(a){return{}});"use strict";q.when("A","page-transition-controller","page-conductor").register("sns-subscription-controller",function(a,k,g){function b(){var b=m(document);b.delegate(".sns-option","click",function(a){a=m(this);f(a.closest(".sns-upsell"),a)});b.delegate(".sns-option-mobile","click",function(a){var b=m(this);a.target.name&&
"snsSetCreateSubscription"===a.target.name&&f(b.closest(".sns-upsell-mobile"),b)});b.delegate(".sns-option-tablet","click",function(a){a=m(this);f(a.closest(".sns-upsell-tablet"),a)});b.delegate(".sns-upsell-nextdelivery","change",function(){e(m(this))});a.declarative("sns-upsell-nextdelivery-dropdown","change",function(a){e(m(a.$target))});b.delegate(".sns-upsell-learn-more","click",function(a){var b=m(this);a=b.width();var c=b.height(),d=b.position(),b=b.find(".sns-upsell-popover-learn-more");b.removeClass("aok-hidden");
var e=b.width();b.height();b.css({top:d.top+c,left:d.left-(e-a)/2,position:"absolute"})});b.delegate(".sns-upsell-learn-more-close","click",function(a){(a=m(this))&&a.closest(".sns-upsell-popover-learn-more")&&a.closest(".sns-upsell-popover-learn-more").addClass("aok-hidden");return!1})}function e(a){var b=a.closest(".sns-upsell,.sns-upsell-mobile,.sns-upsell-tablet");if(a.length&&b.length){var e=b.data("index"),c=b.find("span.sns-change-delivery-txt");c&&c.text(a.find("option:selected").data("date"));
c=a.find("option:selected").data("epoch");a=a.find("option:selected").val();b.find("input[type\x3d'hidden'][name\x3d'sns_nextDelivery"+e+"']").val(c);b.find("input[type\x3d'hidden'][name\x3d'sns_frequency"+e+"']").val(a)}}function f(a,b){k.show();var e=a.data("index"),c=(new Date).getTime(),f=a.find("input[type\x3d'hidden'][name\x3d'sns_lineItemIdentifier"+e+"']").attr("value"),p=a.find("input[type\x3d'hidden'][name\x3d'sns_merchantId"+e+"']").attr("value"),q=a.find("input[type\x3d'hidden'][name\x3d'sns_asin"+
e+"']").attr("value");a=a.find("input[type\x3d'hidden'][name\x3d'sns_frequency"+e+"']").attr("value");b=b.prop("checked")||b.find("[type\x3dcheckbox]").is(":checked");c={returnpipedata:0,returnFullHTML:1,cachebuster:c,hasWorkingJavascript:1};c.lineItemIdentifier=f;c.isONMLSelected=b?1:0;c.merchantId=p;c.asin=q;c.frequency=a;f=g.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});m.ajax({type:"POST",url:"/gp/buy/spc/handlers/set-sns-options.html",data:m.param(c),dataType:"text",async:!0,cache:!1,
headers:f,success:function(a,b,c){return g.ajaxUpdatePage(a,b,c)},error:function(a,b,c){g.ajaxRedirect(a,b,c)}})}var m=a.$;m("html").hasClass("a-ie6")||b()});"use strict";q.when("A","page-detector","page-detector-current-page","page-conductor","page-transition-controller","ajax-utility","place-order-controller","client-side-metrics").execute(function(a,k,g,b,e,f,m,d){function n(a){"function"===typeof p.ues&&(p.ues("t0",a,new Date),p.ues("ctb",a,"1"));"function"===typeof p.uet&&p.uet("tc",a,{wb:1})}
function h(a,b){"function"===typeof p.ues&&p.ues("id",a,b)}function c(a,b){"function"===typeof p.uet&&p.uet(a,b,{wb:1})}function l(a){"function"===typeof p.uex&&p.uex("ld",a,{wb:1})}function q(a){p.ueLogError&&p.ueLogError({message:a},{logLevel:"WARN",attribution:"ajax-typ"})}function w(){var a=M("span#typ-load").attr("data-typ-args");p.location.href="https://"+p.location.hostname+"/gp/buy/thankyou/handlers/display.html?"+a}function z(){if(aa){var a=M("#typ-desktop-frame").contents(),b=aa;if(b.deliveryestimates)for(var c in b.deliveryestimates)if(b.deliveryestimates.hasOwnProperty(c)){var d=
a.find("span#"+c);d&&d.replaceWith(b.deliveryestimates[c])}b.autorip&&(a=a.find("#thank-you-rogue"))&&a.replaceWith(b.autorip)}}function v(){c("cf","ajax-typ:place-your-order");z();var a=M("#typ-desktop-frame").contents(),b="ThankYouCart",f=a.find("span#typ-rewrite-url");history&&history.pushState&&f&&0<f.length&&(history.pushState({},"",f.attr("data-url")),b=f.attr("data-view"));a=a.find("title").text();M("#checkoutDisplayPage").hide();M("#typ-desktop").show();document.title=a;e.hide();b=M("span#typ-load").attr("data-typ-args")+
"\x26viewId\x3d"+b;c("be","ajax-typ:place-your-order");d.setmarker&&(a=d.getscope(),ga&&(b+="\x26requestID\x3d"+Y,d.setscope("ajax-typ")),d.setmarker("cf"),ga&&d.setscope(a));M.ajax({type:"POST",url:"/gp/buy/thankyou/handlers/log-data.html",data:b,dataType:"text",async:!0,cache:!1,complete:function(a,b){b=M("#typ-desktop-frame")[0].contentWindow;"function"===typeof b.updateCart&&b.updateCart();a.getResponseHeader("x-amz-checkout-requestid")&&(a=a.getResponseHeader("x-amz-checkout-requestid"),d.sendue&&
(b=d.getscope(),d.setscope("ajax-typ"),d.setrid(a),d.sendue("ld"),d.setscope(b)),h("ajax-typ:place-your-order",a),l("ajax-typ:place-your-order"))}});ga||(d.sendUEPageLoadStats(),l("ajax-typ:place-your-order"))}function A(a,d,e){a&&a.conductoraction&&a.conductoraction.url?b.redirect(a):(c("af","ajax-typ:place-your-order"),aa=a,Q?v():G?E=1:(q("No TYP data available after place-order, redirecting to static TYP"),w()))}function r(){if(!ha)if(ba&&clearTimeout(ba),3===R.readyState){var a;try{a=f.jsonify(R.responseText)}catch(c){a=
null}null!==a?(ha=1,A(a)):ba=setTimeout(r,50)}else 4===R.readyState&&(ha=1,200===R.status?(a=f.jsonify(R.responseText),null!==a?A(a):(q("No results from place-order, calling ajaxRedirect"),b.ajaxRedirect())):(q("Error calling place-order, calling ajaxRedirect"),b.ajaxRedirect()))}function u(){N=1;U&&clearTimeout(U);X&&clearTimeout(X);var a=M("#currencyChanged");0<a.length&&"true"===a.val()&&(a='\x3cinput type\x3d"hidden" name\x3d"checkoutCurrencySelection.'+M("#tfx-switch-currency-options").find("input:radio:checked").val()+
'" /\x3e',M("#spc-form-inputs").append(a));M("#spc-form").append("\x3cinput type\x3d'hidden' name\x3d'placeYourOrder1' value\x3d'1' /\x3e");a=(new Date).getTime()-y;M("#spc-form").append("\x3cinput type\x3d'hidden' name\x3d'waitingTime' value\x3d'"+a+"' /\x3e");M("#spc-form").append("\x3cinput type\x3d'hidden' name\x3d'returnjson' value\x3d'1' /\x3e");ea&&M("#spc-form").append("\x3cinput type\x3d'hidden' name\x3d'isAsyncTYPEnabled' value\x3d'1' /\x3e");var a=M("#spc-form").serialize(),c=M("#typ-desktop-frame").contents().find("input#cached-promise-data");
0<c.length&&(a+="\x26cachedPromiseData\x3d"+c.val());if(Z){if(p.XMLHttpRequest)R=new XMLHttpRequest;else if(p.ActiveXObject)try{R=new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(d){R=null}if(!R){q("Can't get XMLHttpRequest for data stream, calling standard placeOrderController");N=1;m.placeOrderClick();return}R.open("POST","/gp/buy/spc/handlers/place-your-decoupled-order.html",!0);R.setRequestHeader("Content-type","application/x-www-form-urlencoded");R.setRequestHeader("Content-length",a.length);R.setRequestHeader("Connection",
"close");R.onreadystatechange=r;R.overrideMimeType("text/plain");R.send(a)}else M.ajax({type:"POST",url:"/gp/buy/spc/handlers/place-your-decoupled-order.html",data:a,dataType:"text",async:!0,cache:!1,dataFilter:function(a){return f.jsonify(a)},success:function(a,c,d){null!==a?A(a,c,d):(q("No results from place-order, calling ajaxRedirect"),b.ajaxRedirect())},error:function(a,c,d){q("Error calling place-order, calling ajaxRedirect");b.ajaxRedirect(a,c,d)}});"function"===typeof p.uet&&p.uet("bb","ajax-typ:place-your-order",
{wb:1})}function C(){Q=G=F=0;M("div#typ-desktop").empty()}function x(a,b,c){F||(F=1,clearTimeout(X),G=0,Q=1,P++,(a=M("#typ-desktop-frame").contents().find("span#typ-rewrite-url"))&&0<a.length&&(a=a.attr("data-requestid"),n("ajax-typ:place-your-order"),ga?Y=a:(d.setAsyncRequestId(a),h("ajax-typ:place-your-order",a))),E?v():!N&&5>P&&(U=setTimeout(function(){C();L()},12E4)))}function L(){if(!(N||G||5<=P)){G=1;var a=M("span#typ-load").attr("data-typ-args");X=setTimeout(function(){C();E&&(q("Timed out waiting for TYP fetch after place-order, redirecting to static TYP"),
w())},45E3);M("\x3ciframe /\x3e",{name:"typ-desktop-frame",id:"typ-desktop-frame",width:"100%",height:"100%",frameborder:"0",src:"/gp/buy/thankyou/handlers/display.html?"+a}).appendTo("div#typ-desktop").load(x)}}function D(){x()}function H(){k.isSpc()&&0<M("span#typ-load").length&&(y=(new Date).getTime(),P=0,M("div#typ-desktop").length?C():M("body").append('\x3cdiv id\x3d"typ-desktop" style\x3d"position:absolute;left:0;right:0;bottom:0;top:0;display:none;"\x3e\x3c/div\x3e'),Z=M("span#typ-load").attr("data-early-json-flush")&&
!M("html").hasClass("a-lt-ie10"),ea=0<M("span#async-typ-enabled").length,ga=M("span#typ-load").attr("data-use-cds-stub"),M(document).undelegate("span.place-order-button-link","click"),M(document).delegate("span.place-order-button-link","click",function(a){a.preventDefault();ga?(a=d.getscope(),d.setscope("ajax-typ"),d.setctb(),d.resetue(),d.setmarker("tc"),d.setscope(a)):(d.resetMetrics(),d.setmarker("tc"));G||Q?(e.show(),u()):(N=1,m.placeOrderClick())}),L())}var M=a.$;if(!M("html").hasClass("a-ie6")){var P=
0,G=0,N=0,Q=0,E=0,F=0,U,X,aa,Z=0,ga=0,Y,R,ba,ha=0,y=0,ea=0;a.on("ajax-typ-cf",D);a.on("checkout:reload:spc",H);a.on("checkout:reload:spp-revieworder",H);a.on("checkout:reload:spclite",H)}});"use strict";q.when("A","client-side-metrics").register("trialSignPrefetchCommon",function(a,k){function g(){b()&&(c().val(0),k.increaseCount("TrialSign:js:activated"),e(),q!==C&&h(),q=a.interval(n,5E4),z=0)}function b(){return 0!==c().length&&0!==l("input[name\x3d'purchaseID']").length}function e(){p!==C&&p.abort();
p=a.ajax("/gp/buy/spc/handlers/trigger-trial-sign.html",{method:"post",params:{purchaseId:l("input[name\x3d'purchaseID']").val()},success:f,error:m,abort:d})}function f(a,b,d){c().val(a.signPurchaseTrialId);p=C;k.increaseCount("TrialSign:js:success")}function m(a,b,c){h();p=C;k.increaseCount("TrialSign:js:failed")}function d(){h();p=C;k.increaseCount("TrialSign:js:aborted")}function n(){z++;10<z?h():(k.increaseCount("TrialSign:js:retry"),k.increaseCount("TrialSign:js:retry:"+z),e())}function h(){q!==
C&&(clearInterval(q),q=C)}function c(){return l("input[name\x3d'trialSignId']")}var l=a.$,p,q,z=0;a.on("checkout:reload:spc",g);a.on("checkout:reload:spclite",g);a.on("checkout:billing-address-update",g);return{makeTrialSignCall:e,trialSignCallSucceeded:f,isTrialSignActivated:b}});"use strict";q.when("A","client-side-metrics","ajax-utility","button-blocker","button-blocker-popover","spclite-items-viewer","fast-track-controller").register("get-final-results-update",function(a,k,g,b,e,f,m){function d(){for(var b=
function(){a.trigger("checkout:spc:ordersummary:sizeChanged")},c=0;20>c;++c)setTimeout(b,100*c)}function n(a,b){setTimeout(function(){var c=f.prepare(a);c&&w("#spclite-items-operation").show();w("#spclite-items-header-dynamic").fadeIn(b?0:300,function(){c&&w("#spclite-items-operation").find(".spclite-items-view-switch").each(function(){var a=w(this).attr("view-name");a&&w(this).find("a").click(function(){k.increaseCount("SPCLite:ClientSide:SwitchViewClick:"+a,1);f.switchToView(a);w("#spclite-items-operation").fadeOut(b?
0:300);d()})})})},b?0:800)}function h(b,c,d){if(b&&w.isArray(b))for(var e=!1,f=0;f<b.length;f++){var g=b[f];if(g.identifier&&g.content){var h=w("#"+c+"-"+g.identifier);h&&0!==h.length?a.slideDown(h.html(g.content),d?0:500,"ease-out",function(){}):(k.increaseCount("SPCLite:LazyContentPlaceHolderMissing:Item:"+c,1),e||(k.increaseCount("SPCLite:LazyContentPlaceHolderMissing:Page:"+c,1),e=!0))}}}function c(b,c){if(b.presentCVs&&0<b.presentCVs.countOfCVs)l();else{b.orderSummaryHTML&&(a.fadeOut(w("#order-summary-footer"),
c?0:250,"ease-out"),a.fadeOut(w("#spc-order-summary"),c?0:250,"ease-out",function(){w("#spc-order-summary").replaceWith(b.orderSummaryHTML).hide();b.additionalOrderSummaryHTML&&w("#order-summary-footer").html(b.additionalOrderSummaryHTML);a.fadeIn(w("#spc-order-summary"),c?0:400,"ease-out");a.fadeIn(w("#order-summary-footer"),c?0:400,"ease-out")}));b.freshDeliveryMessageHTML&&(w("#lazy-fresh-promise-delivery-message").html(b.freshDeliveryMessageHTML),a.slideDown(w("#lazy-fresh-promise-delivery-message"),
c?0:500,"ease-out"),m.spcLiteLazyLoadFastTrack());h(b.itemToPrimeMembershipDelivery,"lazy-membership-delivery",c);h(b.itemToGiftContentMapping,"lazy-gift-options",c);h(b.itemToShipOfferingMapping,"lazy-ship-method",c);h(b.itemToPromise,"lazy-promise",c);b.freshDeliverySlotInformationHTML&&(w("#lazy-fresh-delivery-slot-information").html(b.freshDeliverySlotInformationHTML),a.slideDown(w("#lazy-fresh-delivery-slot-information"),c?0:250,"ease-out"));b.freshDeliveryInstructionsHTML&&(w("#lazy-fresh-delivery-instructions").html(b.freshDeliveryInstructionsHTML),
a.slideDown(w("#lazy-fresh-delivery-instructions"),c?0:250,"ease-out"));if(b.itemToPromoMapping&&w.isArray(b.itemToPromoMapping))for(var e=w("#items-block"),f=0;f<b.itemToPromoMapping.length;f++){var g=b.itemToPromoMapping[f];"lightningdeal"===g.type?e.find(".lazy-lightning-promo-details-"+g.identifier).removeClass("aok-hidden"):"promotion"===g.type&&e.find(".lazy-promo-details-"+g.identifier).removeClass("aok-hidden")}b.freeShippingId&&w("#"+b.freeShippingId).removeClass("aok-hidden");w("input#isOrderSummaryReady").val(1);
n(b.itemGroupData,c);d()}}function l(){var c=w("#spclite-block-order-place-message").html()||"";b.show("disabled-order-place",c);b.lock();e.create({name:"disabled-order-place",content:c});e.lock();var d=b.getButtonBlocker().data("a-popover-id");a.on("checkout:beforeReload",function(){e.unlock();b.unlock();e.destroy();w("#a-popover-"+d).remove()})}function q(a){if(a&&a.data){var b;try{b=p.atob(a.data)}catch(c){return k.increaseCount("SPCLite:FinalResult:Base64Decode:Failure",1),null}if((b=g.jsonify(b))&&
!w.isEmptyObject(b))return b}return null}var w=a.$,z,v=function(a,b){function c(){if(f&&0!==f.length){for(var a="",b=0;b<d%3+1;b++)a+=".";f.html(a);d++}}var d=0,e,f;this.start=function(){b&&b.useTextAnimate&&(d=0,f=a.find(".spclite-loading-text .spclite-processing-indicator"),e=setInterval(c,800))};this.stop=function(){e&&(clearInterval(e),f&&0<f.length&&f.html(""),d=0);a.find(".spclite-loading-spinner").hide();b&&b.showTextAlways||a.find(".spclite-loading-text").hide()}};a.on("checkout:reload:spclite",
function(){if("1"===w('script[type\x3d"spclite-encoding"]').attr("data-base64-encode-final-results")){var a=q(p.__spcliteFinalResultsData);if(a){c(a,!0);return}}else if(p.__spcliteFinalResultsData){c(p.__spcliteFinalResultsData,!0);return}var a="",b=w("input#executionId").val();b&&(a+="executionId\x3d"+b);return w.ajax({type:"GET",url:"/gp/buy/spclite/handlers/get-final-results.html/ref\x3dox_spclite_get_final_results",data:a,dataType:"text",async:!0,beforeSend:function(a){z=new v(w("#spclite-order-summary-loading-indicator"),
{showTextAlways:!0});z.start();p.uet&&p.uet("bb","SPCLite:ClientSide:Perf:FinalAjax",{wb:1})},success:function(a,b,d){a=g.jsonify(a);"1"===w('script[type\x3d"spclite-encoding"]').attr("data-base64-encode-final-results")?(a=q(a))?c(a,!1):l():a&&!w.isEmptyObject(a)?c(a,!1):l()},error:function(a,b,c){l()},complete:function(a){z.stop();p.uex&&p.uex("ld","SPCLite:ClientSide:Perf:FinalAjax",{wb:1})},cache:!1})});a.on("checkout:beforeLoadPage",function(){p.__spcliteFinalResultsData=C})});"use strict";q.when("A",
"client-side-metrics").register("spclite-items-viewer",function(a,k){function g(){var a=e("#spclite-items-block").find(".spclite-item-detail");a&&0<a.length&&(m={},a.each(function(a){a=e(this).attr("entity-id");m[a]=e("\x3cp\x3e\x3c/p\x3e").append(e(this).clone().removeClass("a-span-last")).html()}))}function b(a,b){if(!b||0===b.length)return null;a=e('\x3cdiv class\x3d"a-row spclite-item-view" view-type\x3d"order-by-delivery"\x3e\x3c/div\x3e');var f=b;b=[];for(var c=[],g=0;g<f.length;g++){var k=
f[g];if("normal"!==k.type)c.push(k);else{for(var p=0;p<b.length;)if(k.data.destinationAddressId!==b[p].data.destinationAddressId)p++;else break;for(;p<b.length;)if(k.data.destinationAddressId===b[p].data.destinationAddressId&&k.data.promise.starttime.dayepoch>b[p].data.promise.starttime.dayepoch)p++;else break;b.splice(p,0,k)}}for(f=0;f<c.length;f++)switch(k=c[f],k.type){case "primemembership":b.unshift(k);break;case "vas":case "digital":case "no-promise":case "exception":b.push(k);break;default:b.push(k)}for(c=
0;c<b.length;c++){k=b[c];if(f=k.content)g='\x3cdiv class\x3d"row spclite-item-group-title"\x3e',f.destination&&(g+='\x3cdiv class\x3d"row destination"\x3e'+f.destination+"\x3c/div\x3e"),f.promise&&(g+='\x3cdiv class\x3d"row promise"\x3e'+f.promise+"\x3c/div\x3e"),g+="\x3c/div\x3e",a.append(g);a:if(f=k.items,m&&f&&0!==f.length){g="";for(p=0;p<f.length;p++){0===p%2&&(g+='\x3cdiv class\x3d"a-row"\x3e');var q=f[p].identifier;if(!m[q]){f=null;break a}q=e(m[q]);1===p%2&&q.addClass("a-span-last");g+=e("\x3cp\x3e\x3c/p\x3e").append(q).html();
1===p%2&&(g+="\x3c/div\x3e")}1===f.length%2&&(g+='\x3cdiv class\x3d"a-column a-span6 a-span-last"\x3e\x3c/div\x3e\x3c/div\x3e');f=g}else f=null;if(f)f=e(f),("no-promise"===k.type||"normal"===k.type&&k.data&&k.data.promise&&"scheduled"!==k.data.promise.type)&&f.find(".spclite-promise").hide(),a.append(f);else return null;c<b.length-1&&a.append("\x3chr\x3e")}return a}var e=a.$,f,m;return{prepare:function(a){try{var e;a:{g();if(m){var h=b("order-by-delivery",a);if(h){f={"order-by-delivery":h};e=!0;break a}}e=
!1}return e}catch(c){k.increaseCount("SPCLite:ClientSide:Exception:SwitchViewPrepare",1)}return!1},switchToView:function(a,g){var h;f&&f[a]?h=f[a]:(k.increaseCount("SPCLite:ClientSide:SwitchViewNoPrepared:"+a,1),"order-by-delivery"===a&&(h=b(a,g)));if(h){var c=e("#spclite-items-block");c.find(".spclite-item-view").fadeOut(300,function(){c.empty();c.append(h.clone().hide());c.find(".spclite-item-view").fadeIn(500)})}}}});"use strict";q.when("A","loading-spinner-controller").register("cpf-controller",
function(a,k){function g(a){var b,g,d;if(/^\d{11}$/.test(a)||/^\d{3}\.\d{3}\.\d{3}-\d{2}$/.test(a)){a=a.replace(/[^\w\s]|_/g,"");if(/(\d)\1{10}/.test(a))return!1;b=a.substring(0,9);g=a.substring(9);d=0;for(var k=10;1<k;k--)d+=b.charAt(10-k)*k;if((2>d%11?0:11-d%11)!==g.charAt(0))return!1;b=a.substring(0,10);d=0;for(a=11;1<a;a--)d+=b.charAt(11-a)*a;return(2>d%11?0:11-d%11)!==g.charAt(1)?!1:!0}return!1}var b=a.$;a.on("checkout:reload:spp-taxid",function(){b("#useThresholdTaxIdService").length||b("#taxidForm").submit(function(){var a=
b("#taxidregistration-imb");if(!g(b("#taxid-field").val()))return k.hideSpinner(b("#spinner-anchor"),!0),a.show(),!1;a.hide();return!0})})});"use strict";q.when("A","page-conductor","ready").register("taxid-threshold-controller",function(a,k){function g(){var a=b();k.isSPP()?a?(e("#taxid-continue-disabled").hide(),e("#taxid-continue-enabled").show()):(e("#taxid-continue-enabled").hide(),e("#taxid-continue-disabled").show()):a?e("span.#continue").removeClass("a-button-disabled").find('input[type\x3d"submit"]').removeAttr("disabled"):
e("span.#continue").addClass("a-button-disabled").find('input[type\x3d"submit"]').attr("disabled","disabled")}function b(){var a=!0,b=e("#taxIdForm");b.length&&b.find('input[type\x3d"text"]').each(function(){var b=e(this);if(!b.val()||7>b.val().length)b.parents(".taxid-form").find('input[type\x3d"checkbox"]').attr("checked")||(a=!1)});return a}var e=a.$;a.on("checkout:reload:spp-taxid",function(){if(e("#useThresholdTaxIdService").length){var a=e("#taxIdForm");a.length&&(a.find('input[type\x3d"text"]').keyup(g),
a.find('input[type\x3d"checkbox"]').change(g));g()}})});"use strict";q.when("A","page-conductor","loading-spinner-controller","taxaddress-page-config","ready").register("taxaddress-controller",function(a,k,g,b){function e(){var a=d(h.taxidInputIdSelector).val();if(0===a.length)return!0;var b=d(h.taxlegalnameInputIdSelector).val();return n.test(a)&&0!==b.trim().length?(a=d(h.taxaddressInputNameSelector).val())&&0<a.length:!1}function f(){var a=e();if(k.isSPP()){var b=d("#taxid-continue-enabled"),c=
d("#taxid-continue-disabled");a?(c.hide(),b.show()):(b.hide(),c.show());0<d(h.taxidInputIdSelector).val().length?(b.find("span.a-button-text").text(h.saveContinueLabel),c.find("span.a-button-text").text(h.saveContinueLabel)):(b.find("span.a-button-text").text(h.continueLabel),c.find("span.a-button-text").text(h.continueLabel))}}function m(){var a=d(h.taxidInputIdSelector).val();if(c||0===a.length)c=!1;else{var b=0<d(h.newTaxaddressInputIdSelector).val().length;c||!b&&!e()||d.ajax({type:"POST",url:h.sifEncryptionUrl,
dataType:"json",data:{taxid:a},success:function(a,b,e){d(h.taxidInputIdSelector).val(a.sifEncryptedPayload);c=!0;d(h.taxaddressFormIdSelector).submit()},error:function(a,b,c){console.log("Error [tramway][away] failed calling sifcontinue.html :"+b)}});return!1}}var d=a.$,n=/^\d{11}$/,h=b.getConfig(),c=!1;a.on("checkout:reload:spp-taxaddress",function(){d(h.taxidInputIdSelector).keyup(f);d(h.taxlegalnameInputIdSelector).keyup(f);d('input:radio[name\x3d"'+h.taxaddressInputName+'"]').each(function(){d(this).change(f)});
d(h.taxaddressFormIdSelector).submit(m);f()});return{getNewTaxAddressPopoverURL:function(){return h.newTaxAddressPopoverURL},submitTaxAddressFormWithNewAddressId:function(a){d(h.newTaxaddressInputIdSelector).val(a);g.showSpinner(d(h.taxAddressPanelSelector),!1);d(h.taxaddressFormIdSelector).submit()}}});q.when("A","address-popovers","taxaddress-controller","ready").register("taxaddress-addresspopover-helper",function(a,k,g){k.actionRegisterTaxAddressController(g)});"use strict";q.when("A","page-spinner-controller",
"ajax-utility","page-conductor","client-side-metrics").execute(function(a,k,g,b,e){function f(){function e(a){if(!g)if(a.preventDefault(),a=encodeURIComponent(m("#spc-deliverytipinput").val()),m("#tip-error").addClass("aok-hidden"),m("#tip-promo-success").addClass("aok-hidden"),m("#tip-success").addClass("aok-hidden"),m("#tip-ineligible").addClass("aok-hidden"),m("#tip-success").addClass("aok-hidden"),a&&0!==a.length)if(0>a)c("invalidDeliveryTip_NoAmount");else if(/^[0-9]*(\.[0-9]{1,2})?$/.test(a)){k.show();
p=m("#spc-deliverytipnoticecheckbox").attr("checked")?1:0;var d=(new Date).getTime();a="tipamount\x3d"+a+"\x26isDefaultTip\x3d"+p+"\x26returnjson\x3d1\x26returnFullHTML\x3d1\x26hasWorkingJavascript\x3d1\x26fromAnywhere\x3d"+m("input[name\x3dfromAnywhere]").val()+"\x26cachebuster\x3d"+d;d=b.setAjaxTransitionHeader({"Cache-Control":"no-cache",pragma:"no-cache","x-amz-checkout-page":"spc"});m.ajax({type:"POST",url:"/gp/buy/spc/handlers/add-delivery-tip.html/ref\x3dox_tip_page_delivery_tip_add",data:a,
headers:d,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",dataType:"text",complete:function(){g=!1;k.hide()},success:f,error:b.ajaxRedirect});g=!1}else c("invalidDeliveryTip_NoAmount");else c("addDeliveryTip_NoAmount")}function f(a,b,c){k.hide()}function c(a){k.hide();m("#tip-error").removeClass("aok-hidden");0<m("div.spc-desktop").length?m("#spc-deliverytipinput").addClass("a-form-error"):m("#spc-deliverytipinput").closest(".a-input-text-wrapper").addClass("a-form-error");m("#"+
a).removeClass("aok-hidden")}var g=!1,p=0;d&&(a.declarative("tip-element",["click"],function(a){var b=a.data.click;b&&null!==b&&e(a.$event)}),d=!1)}var m=a.$;if(!m("html").hasClass("a-ie6")){var d=!0;a.on("checkout:reload:spc",f);a.on("checkout:reload:spclite",f)}});"use strict";q.when("A","checkout-general-utils","page-conductor","loading-spinner-controller").register("checkout-feedback-controller",function(a,k,g,b){function e(){if(!m||"function"!==typeof m)return"";var a=m(),b="";if(a)for(var e in a)if("number"===
typeof a[e]||"string"===typeof a[e]||"boolean"===typeof a[e])b+="\x26__pagedata_"+e+"\x3d"+a[e];return b}var f=a.$,m;a.declarative("checkout-submit-feedback",["click","touchend"],function(a){if(!k.protectAgainstDoubleAction("checkout-submit-feedback",200)&&(a=f("#checkout-feedback-form"),a.length)){b.showSpinner(a,!1);var m=a.serialize(),m=m+e();f.ajax({type:"POST",url:a.attr("action"),data:m,dataType:"text",error:g.ajaxRedirect,success:function(a,b,d){b=d.getResponseHeader("checkout-feedback-submitted");
f(".a-button-close").trigger("click");null!==b&&b!==C&&f("#checkout-feedback-banner").append(a)}})}});return{registerPageDataCollecter:function(a){a&&"function"===typeof a&&(m=a)}}});"use strict";q.when("A","page-spinner-controller","scroll-controller","ajax-utility","page-conductor","checkout-modal-popover","page-detector","checkout-general-utils","a-popover","client-side-metrics").execute(function(a,k,g,b,e,f,m,d,n,h){function c(){function c(a){a=a.$currentTarget.closest(".delivery-instructions-block");
a.find(".edit-delivery-instructions-link").addClass("aok-hidden");a.find(".delivery-instructions-display").addClass("aok-hidden");var b=a.find(".dynamic-delivery-instructions-update").find(".delivery-instructions-input").attr("maxlength");a.find(".dynamic-delivery-instructions-update").removeClass("aok-hidden");l("#deliveryInstructions").focus();l("#deliveryInstructions").select();l("#deliveryInstructions").keydown(function(a){10===a.which&&a.preventDefault()});l("#deliveryInstructions").keyup(function(){l("#delivery-instructions-left-text").hasClass("aok-hidden")&&
l("#delivery-instructions-left-text").removeClass("aok-hidden");var a=b-l(this).val().length;0>a&&(a=0);l("#delivery-instructions-left").text(a)});setTimeout(function(){},500)}function d(a){k.show();a=a.$currentTarget;var b=l("#deliveryInstructions").val(),c=a.closest(".delivery-instructions-block"),g=a.closest(".dynamic-delivery-instructions-update");c.find(".edit-delivery-instructions-link").removeClass("aok-hidden");c.find(".delivery-instructions-display").removeClass("aok-hidden");g.addClass("aok-hidden");
c=(new Date).getTime();b="deliveryInstructions\x3d"+encodeURIComponent(b)+"\x26returnjson\x3d1\x26returnFullHTML\x3d1\x26hasWorkingJavascript\x3d1\x26fromAnywhere\x3d"+l("input[name\x3dfromAnywhere]").val()+"\x26cachebuster\x3d"+c;c=e.setAjaxTransitionHeader({"Cache-Control":"no-cache",pragma:"no-cache","x-amz-checkout-page":"spc"});l.ajax({type:"POST",url:"/gp/buy/spc/handlers/add-delivery-instructions.html/ref\x3dox_instructions_page_delivery_instructions_update",data:b,headers:c,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",
dataType:"text",complete:function(){k.hide()},success:f,error:e.ajaxRedirect});a.blur()}function f(a,c,d){(a=b.jsonify(a))&&!l.isEmptyObject(a)&&l("#deliveryInstructionsDisplay").html(a.deliveryInstructions);k.hide()}p&&(a.declarative("edit-delivery-instructions",["click"],c),a.declarative("update-delivery-instructions",["click"],d),p=!1)}var l=a.$;if(!l("html").hasClass("a-ie6")){var p=!0;a.on("checkout:reload:spc",c);a.on("checkout:reload:spclite",c)}});"use strict";q.when("A","page-conductor").register("installments-service",
function(a,k){var g=a.$;return{call:function(a,e,f){g.ajax({type:"POST",url:"/gp/buy/installments/handlers/set-item-installments.html/ref\x3dox_spc_inst_toggle",data:{itemId:a,programId:e},dataType:"text",async:!0,cache:!1,headers:k.setAjaxTransitionHeader(),success:f.success||null,error:f.error||null})}}});"use strict";q.when("A","page-transition-controller","page-conductor","page-detector","button-blocker","installments-service","client-side-metrics").register("installments-controller",function(a,
k,g,b,e,f,m){function d(){a.defer(h)}function n(a,b,c){k.hide();g.ajaxUpdatePage(a,b,c,{pushNewFrame:"false"})}function h(){var a=c("#installments-button-blocker");1===a.length&&(a=a.data("blocker-message"),e.show("place-order-installments-blocker",a))}var c=a.$;a.declarative("installments-sync-state",["change"],function(a){var b=a.data.itemId,c=a.$target.is(":checked");a=c?a.data.programId:"";var d={success:n,error:g.ajaxRedirect};m.increaseCount(c?"Checkout:Installments:UpdateOptIn":"Checkout:Installments:UpdateOptOut");
k.show();f.call(b,a,d)});a.on("checkout:reload:spp-revieworder",d);a.on("checkout:reload:spc",d)});"use strict";q.when("A","page-conductor","checkout-modal-popover","page-transition-controller","ajax-utility","page-detector","payments-portal-common","ready").register("spc-payments-portal",function(a,k,g,b,e,f,m){function d(b,d){d={refTag:d,callbackBeforePageUpdate:function(){a.$("div.a-popover button.a-button-close").trigger("click")}};k.isSPP()&&(d.keepCachedPagesData=1);k.loadPage("spc",b,null,
d)}function n(a,d,e){k.isSPP()?(b.blockAllActions(),b.showTransitionInContainer(h("#payment"))):b.show();a="/gp/buy/spc/handlers/pmts-continue-widget.html/ref\x3d"+a;var f=k.setAjaxTransitionHeader({"Cache-Control":"no-cache",pragma:"no-cache","x-amz-checkout-page":"spc"});h.ajax({type:"POST",url:a,data:d,headers:f,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",dataType:"text",success:function(a,b,c){c.getResponseHeader("x-amz-checkout-page")?k.ajaxUpdatePage(a,b,c):e(a)},error:k.ajaxRedirect})}
var h=a.$;return{prepareDelegatedPopovers:function(b){function d(a,b){a=h(a);a.data("aCheckoutModalPopover",b);g.createModal({$declarativeParent:a},b)}a.on("pmts:retail:billing-address-popover",function(a){d(".pmts-change-address-link",{header:b.billingAddressPopoverHeader,footer:"",name:"billing-address",allowScrollOnPage:!0})});a.on("pmts:retail:rewards-registration",function(a){d(".pmts-shop-with-points-learn-more-link",{header:b.rewardsRegistrationPopoverHeader,footer:"",name:"rewards-registration",
allowScrollOnPage:!0})})},handleClaimCodeSubmittedEvent:function(a,b){var d={returnjson:"1",returnFullHTML:"1",hasWorkingJavascript:"1",fromAnywhere:h("input[name\x3dfromAnywhere]").val(),cachebuster:(new Date).getTime(),nextAction:"pipeline-dispatch",embedOnlyData:"1"};a=h.param(a)+"\x26"+h.param(d);n("ox_pay_page_gc_add",a,function(a){m.claimCodePageUpdater(b,a)})},handleChangeBillingAddressRequestedEvent:function(){f.isDesktopSpc()?k.isSPP()?h("#pmts-change-billing-address-popover").trigger("click"):
a.trigger("pmts:retail:billing-address-popover"):(b.show(),k.isPipeliningOn()&&d("billingaddressselect","ox_spc_change_ship_addr"))},handleChangePaymentInstrumentRequestedEvent:function(){b.show();k.isPipeliningOn()&&d("payselect","ox_spc_change_payment")},handleRewardsAccountLearnMoreRequestedEvent:function(){a.trigger("pmts:retail:rewards-registration")},handlePointsAccountSubmittedEvent:function(a){var b={hasWorkingJavascript:"1",isClientTimeBased:h("input[name\x3duseCtb]").val(),nextAction:"dispatch"};
a=h.param(a)+"\x26"+h.param(b);n("ox_spc_points_edit",a,function(a){a=e.jsonify(a);k.redirect(a)})}}});"use strict";q.when("ajax-utility","gc-redeem-controller","page-transition-controller","ready").register("payments-portal-common",function(a,k,g){return{claimCodePageUpdater:function(b,e){e=a.jsonify(e);null!==e?e.widgetJsonData?(b.update(e.widgetJsonData),g.hide()):e.autohandlererror&&k.giftSystemErrorHandling(e.autohandlererror):g.hide()}}});"use strict";q.when("A","page-detector-current-page",
"a-button","a-meter").register("checkout-throttle-error",function(a,k,g,b){var e=a.$;a.on("checkout:reload:throttle",function(){if(e("#checkout-throttle-meter").length){var a=1E3*e('input[name\x3d"waiting-time"]').val()/100;g("#checkout-throttle-return-to-cart").disable();var k=b("#checkout-throttle-meter"),d=0,n=setInterval(function(){k.percent(d);if(100>d)d+=1;else{clearInterval(n);var a=g("#checkout-throttle-return-to-cart");a.text(e("#checkout-throttle-primary-button-active-text").text());a.enable()}},
a)}})});"use strict";q.when("A","weblab-helper").register("nav-bar-helper",function(a,k){function g(){try{q.register("navCF")}catch(a){if(-1===a.message.toLowerCase().indexOf("already registered"))throw a;}}if(k.isNavCFWeblabOn())a.on("checkout:reload",g)});q.when("A").execute(function(a){a.declarative("remaining-customizations-action","click",function(a){a.$currentTarget.parent().find(".remaining_customization_info").removeClass("aok-hidden");a.$currentTarget.hide();a.$event.preventDefault()})});
"use strict";q.when("A","checkout-federation-utilities","client-side-metrics").register("checkout-federation-wrapper",function(a,k,g){function b(a){for(var b=[],d=e;d<a.length;d++)b.push(a[d]);return b}var e=2;return{wrap:function(a,e){try{return a.apply(null,b(arguments))}catch(c){var d=e,n=c,h;h=d;h=k.getExternalDependecies()[h];h=h!==C&&null!==h?h.cti:"Undefined";g.logError(n,"["+d+"] Javascript error thrown while executing wrapper",h,"FATAL");p.console&&p.console.error&&p.console.error(n,d,h)}}}});
"use strict";q.when("A","jQuery","checkout-federation-utilities").register("checkout-federation-injector",function(a,k,g){function b(a){a=a.assetsModule;if(e[a]?0:0<k('script[type\x3d"checkout-asset-trigger"][data-checkout-asset-trigger\x3d"'+a+'"]').length)e[a]=!0,q.register("trigger"+a,function(){})}var e={};a.on("checkout:reload",function(){var a=g.getExternalDependecies(),e;for(e in a)a.hasOwnProperty(e)&&b(a[e])})});"use strict";q.when("A","client-side-metrics").register("checkout-federation-utilities",
function(a,k){return{getExternalDependecies:function(){var g=a.state("triggerExternalDependencies");Object&&Object.keys&&k.increaseCount("Checkout:ExternalDependencies:count:"+(g?Object.keys(g).length:"undefined"));return g===C||null===g?{}:g}}})});
/* ******** */
(function(k){var m=window.AmazonUIPageJS||window.P,q=m._namespace||m.attributeErrors,a=q?q("CheckoutSinglePagePipeline",""):m;a.guardFatal?a.guardFatal(k)(a,window):a.execute(function(){k(a,window)})})(function(k,m,q){k.when("A").register("scroller-controller",function(a){function c(a){a.scrollTop>=l&&g(m).height()>e.height()?e.css({position:"fixed",width:"inherit",top:"14px"}):e.css({position:"relative",top:"0px"})}var g=a.$,e,l;a.on("checkout:reload",function(){if(e=g("#subtotalsContainer")){var d=
e.closest(".page-container");d&&d.offset()&&(l=d.offset().top,a.on.scroll(c))}})});"use strict";k.when("A","address-book-controller","address-utilities","page-conductor","cache-page-data-controller").register("spp-address-controller",function(a,c,g,e,l){function d(){h("div.address-book-entry").each(function(){h(this).find(".displayAddressLI:last-child").append(h(this).find(".address-edit-link, .address-delete-link").show())});var a=h("#inline-address-form");0<a.length&&g.customizeFormFromIdentity(a);
a=h("#address-list");e.isPrefetchFromAddressEnabled()&&0<a.length&&f(a)}function f(a){a.data("enableFormPrefetch")&&0<a.find("input:checked").length&&(a.data("checkoutFormReady",!0),e.makePrefetch(a),a.data("checkoutFormReady",!1))}function b(a){a=a.popover.getContent().find(".enterAddressFormField");a.length&&(a.unbind("keydown.overrideEnterKeypress").bind("keydown.overrideEnterKeypress",function(a){r=h(a.currentTarget).val()}),a.unbind("keyup.overrideEnterKeypress").bind("keyup.overrideEnterKeypress",
function(a){13!==a.which&&13!==a.keyCode||h(a.currentTarget).val()!==r||(a.preventDefault(),a=h(a.target).closest(".a-popover"),a.length&&(a=a.find(".a-popover-footer .a-button-primary"),a.length&&a.click()))}))}var h=a.$,r;a.on("a:popover:afterUpdatePosition:edit-address",b);a.on("a:popover:afterUpdatePosition:add-address",b);a.declarative("switch-address-book-page","click",function(b){b.$event.preventDefault();var d,f,g=b.$target.closest("div.address-book"),r=g.find(".address-book-page.current-visible-page");
r.length&&(d=r.first(),f=d.find(".a-pagination li.a-selected a").attr("href"),f=""===f||f===q?0:f);if(b.$target.is("a")&&(b=b.$target.attr("href"),b=""===b||b===q?0:b,b!==f)){var c=g.find(".address-book-page-"+b);d.removeClass("current-visible-page").hide();a.fadeIn(c,500,"ease-in",function(){c.addClass("current-visible-page");h("div.address-book").trigger("recalculate-address-height")});d=c;f=b}});a.declarative("show-all-addresses","click",function(a){a.$event.preventDefault();a=a.$target.closest("div.address-book");
a.find(".address-book-page").each(function(){var a=h(this);a.removeClass("current-visible-page");a.show();a.find(".pagination-row").hide()});a.trigger("recalculate-address-height");a.find(".show-all-addresses").hide();a.find(".hide-all-addresses").show()});a.declarative("hide-all-addresses","click",function(a){a.$event.preventDefault();a=a.$target.closest("div.address-book");a.find(".address-book-page").each(function(){var a=h(this);a.find(".pagination-row").show();a.hide()});a.find(".address-book-page-0").addClass("current-visible-page").show();
a.trigger("recalculate-address-height");a.find(".hide-all-addresses").hide();a.find(".show-all-addresses").show()});a.declarative("select-address-in-list","click",function(a){a=a.$target;if(!a.is("a")){var b=h(".address-row");b.removeClass("list-address-selected");b.find('input[type\x3d"radio"]').removeAttr("checked");b=a.closest(".address-row");a=b.find('input[type\x3d"radio"]');b.addClass("list-address-selected");a.attr("checked","checked");b=h("#address-list");b.attr("action",a.val());e.isPrefetchFromAddressEnabled()&&
(e.disablePageNoUpdateTransition(),l.clearCache(),f(b))}});a.on("checkout:reload:spp-shipaddress",d);a.on("checkout:reload:spp-billing-address",d)});"use strict";k.when("A").register("spp-address-suggestion-controller",function(a){var c=a.$;a.declarative("suggestion-continue-submit",["click"],function(a){a.$event.preventDefault();var e=a.data.name;"editSelectedAddress"===e&&(e=(e=a.$target.parents("form:first").find('input[type\x3d"radio"]:checked'))?"edit_"+e.val():void 0);var l=a.data.value;a=a.$target.parents("form:first");
var d=a.attr("action"),d=0<d.indexOf("?")?d+"\x26":d+"?";a=d=d+(e+"\x3d"+l+"\x26")+a.serialize();e=c("#continueLink");e.attr("href",a);e.trigger("click")})});"use strict";k.when("A","a-checkbox","weekend-availability-expander-helper").register("weekend-availability-expander",function(a,c,g){function e(a){a=a.expander.expanderName;null!==r[a]&&(a=l(r[a].saturdayId,r[a].sundayId),g.updateAllWeekendAvailabilityStates(a),g.updateAllTitles(a),h=b=!1)}function l(a,b){return{isSaturdayChecked:c("#"+a).isChecked(),
isSundayChecked:c("#"+b).isChecked()}}function d(a){g.logExpanderState("spc",a.action,h,b)}var f=a.$,b=!0,h=!0,r={"sat-sun-availability-expander":{saturdayId:"sat-sun-availability-checkbox-sat",sundayId:"sat-sun-availability-checkbox-sun"},"sat-sun-availability-expander-domestic":{saturdayId:"sat-sun-availability-checkbox-sat-domestic",sundayId:"sat-sun-availability-checkbox-sun-domestic"}};a.on("checkout:reload:spp-shipaddress",function(){a.declarative("sat-sun-availability-checkbox-change","change",
function(a){var b=l(a.data.satCheckboxId,a.data.sunCheckboxId);g.updateAllWeekendAvailabilityStates(b);g.updateAllTitles(b);b=f("input[name\x3d'BusinessHours']").attr("value");b=g.stateToCheckboxes(b);f(".weekend-checkbox-sat input").prop("checked",b.isSaturdayChecked);f(".weekend-checkbox-sun input").prop("checked",b.isSundayChecked);g.updateAllOptOutMessages(l(a.data.satCheckboxId,a.data.sunCheckboxId))});a.on("a:expander:sat-sun-availability-expander:toggle:expand",e);a.on("a:expander:sat-sun-availability-expander-domestic:toggle:expand",
e);a.on("a:expander:sat-sun-availability-expander:toggle:collapse",function(a){b=!0;h=!1});a.on("a:expander:sat-sun-availability-expander-domestic:toggle:collapse",function(a){b=!0;h=!1});"expander"===f("input[name\x3d'weekendDeliveryDisplayType']").attr("value")&&(a.declarative("edit-address-popover-submit",["click"],d),a.declarative("add-address-popover-submit",["click"],d))})});"use strict";k.when("A","page-detector-current-page","delivery-preferences-csm-helper").register("spp-delivery-preferences-controller",
function(a,c,g){function e(a,f){"displayed"===a&&g.recordCSMForEligiblePages("address-form:"+f+":");g.recordCSMWithCurrentFieldValues("embedded-in-address-"+f+"-"+a,"prefDelLocation","isDefaultPreference")}var l=a.$;a.on("checkout:reload",function(){"spp-shipaddress"!==c.getCurrentPage()?g.recordCSMForEligiblePages():l("#inline-address-form").length&&(e("displayed","inline"),l("#inline-address-form form").submit(function(){e("submitted","inline")}))});a.on("a:popover:show:add-address",function(){e("displayed",
"popover")});a.declarative("add-address-popover-submit","click",function(a){e("submitted","popover")})});"use strict";k.when("A").register("spp-item-controller",function(a){function c(a,d,f){a=a.trim();a=JSON.parse(a);var b=e(".lineitem");d=e("#address-filter-message");if(""!==a.address_results){var h=a.address_results.split(",");k.when("a-dropdown").execute(function(f){for(f=0;f<h.length;f++){var d=e(b).find("input:hidden[value\x3d"+h[f]+"]")[0];if(d){d=d.name.split(".")[1];d="#addressID.destinationType.destinationId.destinationOwnerId."+
d;d=d.replace(/\./g,"\\.");d=e(d)[0];if(!d)break;for(var c=1;c<d.length-1;c++)if(d[c].value.split(".")[0]===a.addr_id.split(".")[0]){e(d[c]).remove();break}}}});d.hasClass("aok-hidden")&&d.removeClass("aok-hidden")}}function g(){var a="",a="",d=e("#"+"addressID.destinationType.destinationId.destinationOwnerId.1-1".replace(/\./g,"\\."))[0];if(d)for(var f=1;f<d.length-1;f++)a=d[f].value.slice(0,-7),a="addressid\x3d"+a,e.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/get-shipping-eligibility.html",
dataType:"text",data:a,async:!0,cache:!1,error:function(a){alert("error: "+a.responseText)},success:function(a,d,f){c(a,d,f)}})}var e=a.$;a.on("checkout:reload:spp-itemselect",function(){e("form#changeQuantityFormId").attr("action",e("form#changeQuantityFormId").attr("action")+"\x26action\x3dcontinue");e(".lineitem-error-message")&&0!==e(".lineitem-error-message").length&&e("#address-filter-message")&&0!==e("#address-filter-message").length&&g()})});"use strict";k.when("A","a-carousel-framework").register("spp-gift-controller",
function(a,c){a.on("checkout:reload:spp-giftoptions",function(){c.createAll();c.initializeAll()})});"use strict";k.when("A").register("pay-popovers",function(a){var c=a.$;a.on("checkout:reload:spp-payment",function(){c("#payment .payment-popover").each(function(){var a=c(this);1===a.data("haserrors")&&c("#"+a.data("trigger")).trigger("click")})})});"use strict";k.when("A","pay-common-util","jppoints").register("gcpromo",function(a,c,g){function e(){var a=d.gcpromo.find("#pm_300");if(!a.is(":disabled")){var f=
a.is(":checked"),r=d.gcpromo.find('input[type\x3d"checkbox"][name\x3d"useAvailableBalance"]');f?r&&r.length&&d.gcpromo.addClass("payment-selected"):(d.gcpromo.removeClass("payment-selected"),c.selectDefaultPaymentMethodIfNotSelected());(f=l("#jppoints"))&&f.length&&g.handleJPPointsWithGC(a)}}var l=a.$,d={},f={gcpromo:"#gcPromo"};a.on("checkout:reload:spp-payment",function(){if(!c.isMobileCX()&&l("#gcPromo").length&&(d=c.getElements(f),d.gcpromo&&d.gcpromo.length)){var a=d.gcpromo.find("#pm_300");
c.isTouchCX()?a.parents("label").unbind("click").bind("click",e):a.unbind("click").bind("click",e)}})});"use strict";k.when("A").register("new-payment-methods",function(a){var c=a.$;a.declarative("click-store-card","click",function(a){a=c("#linkToApplyForStoreCard");a.length&&a[0].click()});a.declarative("click-add-loc","click",function(a){a=c("#linkToLoCPopup");a.length&&a[0].click()});a.declarative("trigger-add-new-direct-debit","click",function(a){a=c("#direct-debit-popover-link");a.length&&a[0].click()});
a.declarative("trigger-add-new-invoice-account","click",function(a){a=c("#invoice-account-popover-link");a.length&&a[0].click()})});"use strict";k.when("A","checkout-general-utils","a-tooltip").register("spp-button-blocker",function(a,c,g){var e=a.$;a.declarative("a-tooltip-button-blocker","mouseenter click mouseleave touchend touchenter touchleave".split(" "),function(a){if(c.protectAgainstDoubleAction("tooltip-button-blocker",400))a.$event.preventDefault();else{var d=a.$currentTarget.find(".a-button-disabled"),
f=a.$currentTarget.find("#orderSummaryPrimaryActionBtn");f.length&&(d=f);if("mouseleave"===a.type||"touchleave"===a.type)d.length&&g.remove(d);else if("mouseenter"===a.type||"click"===a.type||"touchenter"===a.type||"touchend"===a.type)a:if(f=e("#"+a.data.name),f=a.data.content||a.$currentTarget.data("blockerText")||f.html(),a=a.data.position,f&&f.length&&d.length){g.remove(d);var b=d.attr("id");if(b&&"orderSummaryPrimaryActionBtn"===b&&(b=e("#orderSummaryPrimaryActionBtn"),b.is(":visible")&&!b.hasClass("a-button-disabled")))break a;
d=g.create(d,{content:f,position:a});d.isActive()||d.show()}}});return{hideContinueBtnBlocker:function(){e(".continue-button-blocker").closest("span.a-declarative").each(function(){var a=e(this);a.length&&g.remove(a)})},showDefaultContinueBtnBlocker:function(){e("#show-default-blocker-in-prefetch").length&&k.when("button-blocker").execute(function(a){var d=e("#defaultBuyBtnBlockerMsg");d.length&&a.show("default-buy-btn-blocker",d.val())})},hideDefaultContinueBtnBlocker:function(){e("#show-default-blocker-in-prefetch").length&&
k.when("button-blocker").execute(function(a){a.hide("default-buy-btn-blocker")})}}});"use strict";k.when("A").register("addtocart-transition-controller",function(a){a.on("checkout:reload:addtocart",function(){k.when("page-transition-controller").execute(function(a){a.hidePageTransition()})})});"use strict";k.when("A","a-modal").execute(function(a,c){var g=a.$;a.declarative("trigger-modal-dialog","click",function(a){var l=a.$currentTarget.find(".a-declarative").filter(function(){return"a-modal"===
g(this).data("action")}).first();l.length&&(c.get(l).lock(11).show(),setTimeout(function(){c.get(l).unlock(12)},550))})});"use strict";k.when("A","a-button","weblab-helper").register("order-summary-primary-action",function(a,c,g){function e(){var a=d("#orderSummaryPrimaryActionBtn");if(a.length){var b=d(".primary-action-button");b.length&&a.find(".os-primary-action-button-text").text(b.text())}}function l(){var a=c("#orderSummaryPrimaryActionBtn");a.isEmpty()||(d(".primary-action-button").is(":visible")?
a.enable():a.disable())}var d=a.$;a.declarative("buy-button-as-primary-action",["click","touchend"],function(a){a=d(".primary-action-button");var b=c("#orderSummaryPrimaryActionBtn");a.length&&b.isEnabled()&&a.find("input").trigger("click")});a.on("orderSummary:primaryActionButton:mirrorPanelBtnState",l);a.on("checkout:afterReload",l);if(g.isRemoveOrderSummaryPrimaryActionBtnTextWeblabOff())a.on("checkout:afterReload",e)});"use strict";k.when("A","checkout-general-utils","page-conductor","loading-spinner-controller").register("feedback-controller",
function(a,c,g,e){var l=a.$,d;a.on("a:popover:show:feedback-banner",function(a){d=a.popover});a.declarative("submit-spp-feedback",["click","touchend"],function(a){if(!c.protectAgainstDoubleAction("submit-spp-feedback",200)&&(a=l("#feedback-form"),a.length)){e.showSpinner(a,!1,d);var b=a.serialize(),b=b+("\x26lineitems\x3d"+l("#lineitemcountforfeedback").val()),b=b+("\x26expandedPanel\x3d"+l(".expanded").attr("id")),b=b+("\x26ordertotal\x3d"+l(".grand-total-price").text().trim()),b=b+("\x26buttonStatus\x3d"+
l("#place-order-btn-blocker-msg").text().trim());l.ajax({type:"POST",url:a.attr("action"),data:b,dataType:"text",error:g.ajaxRedirect,success:function(a,b,d){b=d.getResponseHeader("spp-feedback-submitted");l(".a-button-close").trigger("click");null!==b&&b!==q&&l("#feedback-banner").append(a)}})}})});"use strict";k.when("A","page-conductor","ajax-utility","checkout-general-utils","page-transition-controller","client-side-metrics").register("page-conductor-spp",function(a,c,g,e,l,d){function f(a,b){try{a.replaceWith(b.hide())}catch(f){throw d.increaseCount("checkout:spp:panelreplacefailed:"+
a.attr("id"),1),l.show(),c.redirect(),Error(f);}}function b(a,b){b&&(d.startWidgetTiming(a),r("#"+a).replaceWith(b),d.finishWidgetTiming(a))}function h(h){var m=r("#auiAnimationSpeedRate");m.length&&(k=.05*(parseInt(m.val(),10)-1)+.2);if(h=g.jsonify(h)){c.overrideIsAnimating(!0);l.hide();var x,u,t,v,y,w=0,m=0,A=!1;if(h.panels)if(r.each(h.panels,function(b,h){b=r("#"+h.id);var c=r(h.content),e=b.hasClass("expanded"),g=c.hasClass("expanded");"revieworder"===h.id&&e&&!g&&(A=!0);e&&g?(d.startWidgetTiming(h.id),
f(b,c),a.fadeIn(c,300,"ease-in",function(){d.finishWidgetTiming(h.id)})):e||g?e&&!g?(v=b,y=c):(x=b,u=c,t=h.id,d.startWidgetTiming(t)):b.replaceWith(c)}),A&&r("#hidden-revieworder").html(r("#revieworder").html()),u!==q||y!==q){var z=r("#page-buffer");y!==q&&(m=Math.max(m,50),z.height(v.height()),w=Math.floor(v.height()*k),w=Math.min(w,600),v.slideUp(w,"swing",function(){v.replaceWith(y)}),z.slideDown(w,"swing"),u===q&&c.overrideIsAnimating(!1));u!==q&&(w+=50,m=Math.max(m,w),a.delay(function(){f(x,
u);var a=Math.floor(u.height()*k),a=Math.min(a,600);u.slideDown(a,"swing",function(){c.overrideIsAnimating(!1);t!==q&&d.finishWidgetTiming(t)});z.slideUp(a,"swing")},w))}else c.overrideIsAnimating(!1);b("spc-imb",h.imb);b("fixup-imb",h.fixupImb);b("tv-ham",h.ham);b("subtotals",h.subtotals);b("callouts",h.callouts);b("footer",h.footer);b("header",h.header);b("bottomsubtotals",h.bottomsubtotals);return m+5}e.logError("parsing data as JSON obj failed in SPP transition");c.ajaxSorryPage()}var r=a.$,k=
.7;c.initFunc(h,function(a){h(a)});c.overrideIsSPP(!0);a.on("checkout:afterReload",function(){c.enablePageNoUpdateTransition()})});"use strict";k.when("A","page-detector-current-page","first-load-dependencies-base","weblab-helper").register("first-load-dependencies",function(a,c,g,e){e=a.$;c={"spp-shipaddress":["spp-address-controller","spp-address-suggestion-controller","address-popovers","address-book-controller","weekend-availability-expander"],"spp-addresstranslate":["address-translator","address-translation-controller",
"spp-address-translation-controller"],"spp-itemselect":["spp-item-controller","itemselect-address-controller","itemselect-quantity-controller","address-popovers"],"spp-shipoption":["shipoptionselect-controller","deliv-prefs-sosp","scheduled-delivery-readiness-checker"],"spp-giftoptions":["gift-form-base-controller","gift-form-del-opt-controller"],"spp-payment":["existing-payments","new-payments","pay-popovers"],"spp-revieworder":"prime-popover-controller prime-decline-controller shipping-speed-selection-controller fast-track-controller gold-box-controller verification-checkbox-controller back-button-protection gift-popover-controller concealment-popover-controller cv-continue-blocker-controller installments-controller".split(" "),
"spp-billing-address":["address-popovers","address-book-controller","spp-address-controller"],"spp-taxid":["cpf-controller","taxid-threshold-controller"],"spp-taxaddress":["taxaddress-controller"],addtocart:["addtocart-transition-controller"]}[c.getCurrentPage()]||[];var l=e.merge("page-transition-controller page-conductor page-conductor-spp gc-redeem-controller inline-fps-balance-controller inline-points-controller order-summary-controller-spp checkout-modal-popover store-search-popover-controller imb-transition-controller verification-checkbox-spp order-summary-primary-action new-payment-methods checkout-federation-injector".split(" "),
c);a.on("afterReady",function(){g.allDependenciesCheck(l)})});"use strict";k.when("A","page-spinner-controller").register("transition-controller",function(a,c){function g(a,b){var f=d('\x3cdiv class\x3d"section-overwrap"/\x3e');f.css({opacity:null===b?.5:b}).css({width:a.outerWidth(),height:a.outerHeight()});a.prepend(f)}function e(a){a.find("div.section-overwrap").remove()}function l(a,b){var f=a.height(),h=a.width(),c=a.offset(),e=d(m),g=a=0;0<e.scrollTop()-c.top&&(a=e.scrollTop()-c.top);0>e.height()+
e.scrollTop()-(c.top+f)&&(g=c.top+f-(e.height()+e.scrollTop()));f=f-a-g;c=b.width();e=b.height();b.css("left",h/2-c/4+"px");e<f&&b.css("top",f/2-e/4+a+"px")}var d=a.$,f=null,b=null,h=null;d(document).delegate("a.disabled-link","click",function(a){a.preventDefault();return!1});c.initFunc({blockAllActions:function(){g(d("#subtotals"),.5);g(d("#bottomsubtotals"),.5);c.clearFocus();d(".spp-panel.collapsed span.a-declarative").each(function(){var a=d(this);a.find("span.a-button").addClass("a-button-disabled");
a.find("a").not(".a-button-text").addClass("disabled-link");a.find(":checkbox, :text").attr("disabled","disabled");a.addClass("off-declarative").removeClass("a-declarative")});g(d(".spp-panel.expanded"),0)},unblockAllActions:function(){e(d("#subtotals"));e(d("#bottomsubtotals"));d(".spp-panel.collapsed span.off-declarative").each(function(){var a=d(this);a.find("span.a-button").removeClass("a-button-disabled");a.find("a").not(".a-button-text").removeClass("disabled-link");a.find(":checkbox, :text").removeAttr("disabled");
a.addClass("a-declarative").removeClass("off-declarative")});e(d(".spp-panel.expanded"))},shrinkPanel:function(a,b,f){if(a){var c=a.find(".panel-content");a=a.find(".shrink-placeholder");c.hide();c=a.find(".loading-img-text");f&&0<f.length&&c.find(".loading-text").html(f);b?c.show():c.hide();a.addClass("current-spinner").show();d("html, body").animate({scrollTop:0},300)}},showTransitionInContainer:function(a,c){var e=a.find(".section-overwrap");e.length&&"0"!==e.css("opacity")||(e=a.height(),(c=400<
e||c?d("#bigLoadingSpinner"):d("#smallLoadingSpinner"))&&c.length||(c=d('\x3cimg id\x3d"loading-spinner-img" class\x3d"loading-spinner-img" src\x3d"https://images-na.ssl-images-amazon.com/images/G/01/amazonui/loading/loading-'+(400<e?"4":"1")+'x._V391853217_.gif" /\x3e')),e=d('\x3cdiv class\x3d"section-overwrap"\x3e\x3cdiv class\x3d"loading-spinner-inner loading-spinner-image-only"\x3e\x3c/div\x3e\x3c/div\x3e'),e.find(".loading-spinner-image-only").prepend(c.removeClass("aok-hidden")),c=e.find("div.loading-spinner-inner"),
e.css({opacity:.8}).css({width:a.outerWidth(),height:a.outerHeight()}),a.prepend(e),b=a,h=c,l(b,h),d(m).unbind("scroll.checkout-panel-spinner").bind("scroll.checkout-panel-spinner",function(a){f&&m.clearTimeout(f);f=setTimeout(function(){l(b,h);f=null},50)}),d(m).unbind("resize.checkout-panel-spinner").bind("resize.checkout-panel-spinner",function(){l(b,h)}))},hideSpinner:function(){d(".spp-panel").each(function(){d(this).find("div.section-overwrap").remove()});d(m).unbind("scroll.checkout-panel-spinner");
d(m).unbind("resize.checkout-panel-spinner")}})});"use strict";k.when("A").register("page-mash-transition-controller",function(a){function c(a){return function(b){console.error("Could not run MASHLoadingMessage: "+a+b)}}function g(){k.when("mash").execute(function(a){var d=b===q?"":b;a!==q&&m.cordova!==q?m.cordova.exec(null,c("showTransition(): "),"MASHLoadingMessage","startLoading",{message:d}):console.error("Error showing loading screen:"+(a!==q).toString()+", cordova:"+(m.cordova!==q).toString())});
l();return!0}function e(){k.when("mash").execute(function(a){a!==q&&m.cordova!==q?m.cordova.exec(null,c("hideTransition(): "),"MASHLoadingMessage","finishLoading",{}):console.error("Error Hiding loading screen:"+(a!==q).toString()+", cordova:"+(m.cordova!==q).toString())});d();return!0}function l(){k.when("a-tv").execute(function(a){a.disable()})}function d(){k.when("a-tv").execute(function(a){a.enable()})}var f=a.$,b;return{show:g,hide:e,showPageTransition:function(){if("0"===f("#showPageTransition").attr("content"))return!1;
l();return g()},hidePageTransition:function(){d();return e()},blockAllActions:l,unblockAllActions:d,showTransitionInContainer:function(a){return g()},shrinkPanel:function(a,b,d){return g()},setLoadingMessage:function(a){b=a},resetLoadingMessage:function(){b=q}}});"use strict";k.when("A","client-side-metrics").register("imb-transition-controller",function(a,c){function g(a){var b=d(a.target);if(!b.is(":visible"))return a.stopPropagation(),!1;a=b.closest(".imb-content");a.hide();var h=a.closest(".tv-imb");
k.when("a-tv").execute(function(a){a.add(h);a.select(h)});a=a.find("input[type\x3dcheckbox]");a.is(":checked")?(a.prop("checked",!1),c.increaseCount("checkouttv:imb-actionable-content-unselected",1)):(a.prop("checked",!0),c.increaseCount("checkouttv:imb-actionable-content-selected",1));e(h,".outer-box");k.when("verification-checkbox-controller").execute(function(a){a.verifyCheckboxes()})}function e(a,b){a.find("input[type\x3dcheckbox]").is(":checked")?(a.find("i.empty-checkbox"+b).addClass("aok-hidden"),
a.find("i.checked-checkbox"+b).removeClass("aok-hidden")):(a.find("i.empty-checkbox"+b).removeClass("aok-hidden"),a.find("i.checked-checkbox"+b).addClass("aok-hidden"))}function l(a){var b=d(a.target);if(b.hasClass("tv-imb")){a=d(".tv-checkbox-container:visible");if(a.length){var h=a.closest(".tv-imb");e(h,".outer-box");k.when("a-tv").execute(function(a){a.add(h);a.select(b)})}a=b.find(".imb-content");var g=a.is(":hidden");d(".imb-content").hide();var l=b.find(".confirm-button");l.length?(a.show(),
c.increaseCount("checkouttv:imb-actionable-content-shown",1),k.when("a-tv").execute(function(a){a.remove(b);a.select(l)})):g?(c.increaseCount("checkouttv:imb-non-actionable-content-shown",1),a.show()):a.hide()}}var d=a.$;a.on("checkout:reload",function(){if(d("#hasTVNavigation").length&&d(".tv-imb").length){d(".imb-content").hide();var a=d("#fixup-imb");if(a.length){var b=d(".tv-scroll-area");if(b.length){var c=b.height()-a.outerHeight(!0);b.height(c)}a.find(".imb-content").show()}d(".tv-checkbox-container").length&&
d(".tv-imb").each(function(){e(d(this),".outer-box")});d(".tv-imb").unbind("click").bind("click",l);d(".confirm-button").unbind("click").bind("click",g)}})});"use strict";k.when("A","a-tv","page-conductor").register("tv-controller",function(a,c,g){function e(a){a===q&&(a=".tv-selected-first:visible:first");return function(){0<l(a).length?c.select(a):c.select(".a-tv-navigate:visible:first")}}var l=a.$;g.overrideAddToCart(!0);a.on("checkout:beforeReload",e());a.on("checkout:reload:spp-collapsed",e(".continue-button.a-tv-navigate:visible:first"))});
k.when("A","mash","client-side-metrics").register("firetv-legal-disclaimer-mash",function(a,c,g){a.declarative("firetv-legal-disclaimer-mash","click",function(a){g.increaseCount("checkouttv:legal-ingress-clicked",1);m.cordova.exec(null,null,"MASHLegalDisclaimerPlugin","execute",{})})});k.when("A","mash").register("firetv-seller-mash",function(a,c){a.declarative("firetv-seller-mash","click",function(a){m.cordova.exec(null,null,"MASHDisplaySellerInfoPlugin","execute",{merchant_id:a.data.sellerMerchantID})})});
k.when("A","page-mash-transition-controller").execute(function(a,c){a.on("checkout:beforeReload",c.resetLoadingMessage);a.declarative("tv-abort-checkout","click",function(a){var e=a.data.url;c.setLoadingMessage(a.data.loadingMsg);c.showPageTransition();m.location=e})});"use strict";k.when("A","verification-checkbox-controller","page-detector-current-page").register("verification-checkbox-spp",function(a,c,g){var e=a.$;a.on("checkout:reload",function(){e("#show-default-blocker-in-prefetch").length&&
"spc"!==g.getCurrentPage()&&"spp-revieworder"!==g.getCurrentPage()&&c.verifyCheckboxes()})});"use strict";k.when("A","a-tv").register("kindle-controller",function(a,c){function g(){var a=e(".tv-kindle-register-row");a.find(".tv-kindle-register").toggleClass("tv-kindle-register-selected");a.find(".kindle-register-checkmark").toggleClass("aok-hidden")}var e=a.$;a.declarative("tv-kindle-register-select","click",function(a){if(!a.$target.is(".tv-kindle-register-selected")){g();a=e(".tv-kindle-register-row");
var d=a.find(".tv-kindle-register-selected").is(".tv-kindle-register-other"),c="obfuscatedEntityId\x3d"+a.find("input:hidden[name\x3dkindleLineItem]:first").val()+"\x26",c=c+"isKindlePurchase\x3d1\x26",c=c+("hidePrices\x3d"+(d?"1":"0")+"\x26");k.when("page-conductor","page-transition-controller").execute(function(a,d){d.show();e.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/update-gift.html",data:c,dataType:"text",async:!0,cache:!1,headers:a.setAjaxTransitionHeader({"x-amz-checkout-page":"spc",
"x-amz-checkout-transition":"ajax"}),contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",success:function(a,b,c){d.hide();e(".kindle-register-error-message").addClass("aok-hidden")},error:function(a,b,c){d.hide();g();e(".kindle-register-error-message").removeClass("aok-hidden")}})})}})});"use strict";k.when("A","a-carousel-framework").register("gift-carousel-utils",function(a,c){function g(a,c,d,e){b("."+a,b(e)).not("."+c).each(function(){var a=b(this),c=a.parent();c&&c.is("div")&&
c.hasClass(d)&&a.unwrap()})}function e(a,c){a.each(function(){b(this).attr("aria-posinset",c);c++});return c}function l(a,c){b("li",b(a)).hide();b("li",b(a)).css("visibility","hidden");b(".gift-wrap",b(a)).css("visibility","visible");b(".gw-hidden",b(a)).size()&&g("gift-wrap","noshi-wrap","gw-hidden",a);b(".noshi-wrap",b(a)).not(".gift-wrap").each(function(){b(this).wrap("\x3cdiv class\x3d'noshi-hidden'\x3e\x3c/div\x3e")});c=b(".gift-wrap",b(a));e(c,1);b(".gift-wrap",b(a)).show()}function d(a,c){b("li",
b(a)).hide();b("li",b(a)).css("visibility","hidden");b(".noshi-wrap",b(a)).css("visibility","visible");b(".noshi-hidden",b(a)).size()&&g("noshi-wrap","gift-wrap","noshi-hidden",a);b(".gift-wrap",b(a)).not(".noshi-wrap").each(function(){b(this).wrap("\x3cdiv class\x3d'gw-hidden'\x3e\x3c/div\x3e")});c=b(".noshi-wrap",b(a));e(c,1);b(".noshi-wrap",b(a)).show()}function f(a,d,e,f){var g=c.getCarousel(document.getElementById("giftwrap-carousel-wrap-holder-"+a));b("#afn-gift-options-wrapper-"+a);"all"===
d?a=7:(a=4,e=f);g.setAttr("set_size",a);g.setAttr("totalPages",e);g.gotoPage(1)}var b=a.$;a.on("checkout:gift:changeCarouselWrapOptions",function(a,c,f){"all"===c?(b("li",b(a)).show(),b(".noshi-hidden").size()?g("noshi-wrap","gift-wrap","noshi-hidden",a):b(".gw-hidden").size()&&g("gift-wrap","noshi-wrap","gw-hidden",a),b("li",b(a)).css("visibility","visible"),c=1,f=b(".gift-wrap",b(a)),c=e(f,c),f=b(".noshi-wrap",b(a)).not(".gift-wrap"),e(f,c)):"GW"===c||"gift-wrap"===c?l(a,f):"noshi"===c&&d(a,f)});
a.on("checkout:gift:adaptCarouselGiftPanel",function(a,b){f(a,b,3,2)});a.on("checkout:gift:adaptCarouselSPCPanel",function(a,b){f(a,b,2,1)})});"use strict";k.when("A","order-summary-controller").register("order-summary-controller-spp",function(a,c){a.on("checkout:reload",function(){c.initOrderSummary()})});"use strict";k.when("A","button-blocker").register("cv-continue-blocker-controller",function(a,c){function g(){var a=e("#cv-block-msg");a&&a.length&&c.show("cv-block-msg",a.html())}var e=a.$;a.on("checkout:reload:spc",
g);a.on("checkout:reload:spp-revieworder",g)});"use strict";k.when("A","page-transition-controller","page-conductor","a-popover-base").register("pallet-delivery-controller",function(a,c,g,e){function l(f){var b=d('input[name\x3d"pallet-delivery-option"]:checked').val(),h=f.loadingText,l=d("#shipaddress");f=function(){c.blockAllActions();c.shrinkPanel(d(".spp-panel.expanded"),!1);c.shrinkPanel(l,!0,h)};var k=(new Date).getTime(),m=d('input[name\x3d"palletDeliveryAddressId"]').val(),b="cachebuster\x3d"+
k+"hasWorkingJavascript\x3d1\x26addressId\x3d"+m+"\x26palletDelivery\x3d"+b,k=g.setAjaxTransitionHeader({"x-amz-checkout-page":"truespc","x-amz-checkout-transition":"ajax"});e.get("pallet-delivery-setting").hide();g.isNonBlockingAnimationEnabled()?a.delay(f,0):f();d.ajax({type:"POST",url:"/gp/buy/spc/handlers/set-pallet-delivery.html/ref\x3dox_truespc_set_pallet_delivery",data:b,dataType:"text",async:!0,cache:!1,headers:k,success:function(a,b,c){c.getResponseHeader("x-amz-checkout-page")?g.ajaxUpdatePage(a,
b,c):c.getResponseHeader("x-amz-checkout-pallet-warning")?(g.ajaxUpdatePage(a,b,c),d(".pallet-delivery-setting-error-message").removeClass("aok-hidden")):g.redirect(a)},error:g.ajaxRedirect})}var d=a.$;d("html").hasClass("a-ie6")||a.declarative("pallet-delivery-select","click",function(a){l(a.data)})});"use strict";k.when("A","a-carousel-framework").register("spp-gift-popover-controller",function(a,c){var g=a.$;a.on("checkout:gift:adjustCarouselInitial",function(a,g){a=a.options.wraps.length+1;var d;
d=Math.ceil(a/4);var f=g.find(".carousel-gift-wrap").attr("id"),f=c.getCarousel(document.getElementById(f));f.setAttr("set_size",a);f.setAttr("pageSize",4);f.setAttr("totalPages",d);f.gotoPage(1);g.find(".a-carousel-viewport").css("height",160)});a.on("checkout:gift:removeEmptyCarouselCards",function(a){a.find(".a-carousel-card-empty").each(function(){g(this).remove()})})});"use strict";k.when("A").register("dhl-controller",function(a){var c=a.$;a.declarative("change-existing-dhl-number","click",
function(a){c("#existing-dhl-number").hide();c("#change-dhl-number").show()});a.declarative("save-dhl-number","click",function(a){a=c("#dhlPostNumberInput").val();c.ajax({type:"POST",url:"/gp/buy/storeaddress/handlers/change-name.html",data:{callFromSearchPage:1,changeDhlPostNumberInEmbu:1,dhlPostNumber:a},dataType:"text",async:!0,cache:!1,headers:{"x-amz-checkout-page":"truespc"}});c("#dhl-number").html(a);c("#change-dhl-number").hide();c("#existing-dhl-number").show()})});"use strict";k.when("A",
"a-dropdown").register("search-utilities-controller",function(a,c){function g(){var a=f("#popover_storeCountry"),b=f("#pickupType"),d=c.getSelect("pickupType");d.removeOptions(b.find(".de-pickup-option"));d.removeOptions(b.find(".at-pickup-option"));d.removeOptions(b.find(".lb-pickup-option"));d.removeOptions(b.find(".nl-pickup-option"));d.removeOptions(b.find(".pl-pickup-option"));"Germany"===a.val()?(b.append(m),b.find('option[value\x3d"'+b.val()+'"]').hasClass("de-pickup-option")||d.setValue("All")):
"Austria"===a.val()?(b.append(q),b.find('option[value\x3d"'+b.val()+'"]').hasClass("at-pickup-option")||d.setValue("All")):"Luxembourg"===a.val()?(b.append(u),b.find('option[value\x3d"'+b.val()+'"]').hasClass("lb-pickup-option")||d.setValue("All")):"Netherland"===a.val()?(b.append(t),b.find('option[value\x3d"'+b.val()+'"]').hasClass("nl-pickup-option")||d.setValue("All")):"Poland"===a.val()&&(b.append(v),b.find('option[value\x3d"'+b.val()+'"]').hasClass("pl-pickup-option")||d.setValue("All"))}function e(){var a=
f("#popover_storeCountry"),b=f("#pickupType"),d=c.getSelect("pickupType");d.removeOptions(b.find(".fr-pickup-option"));d.removeOptions(b.find(".be-pickup-option"));"France"===a.val()?(b.append(C),b.find('option[value\x3d"'+b.val()+'"]').hasClass("be-pickup-option")&&d.setValue("All")):(b.append(x),b.find('option[value\x3d"'+b.val()+'"]').hasClass("fr-pickup-option")&&d.setValue("All"))}function l(){var a=f("form.locker-search");b=a.find("select[name\x3dstoreCountry]");h=a.find("select[name\x3dpickupType]");
b&&h&&b.length&&h.length&&(b.find("option").each(function(a,b){(a=f(b))&&a.attr("data-pickuptypeclass")&&(k[a.attr("data-pickuptypeclass")]=h.find("option."+a.attr("data-pickuptypeclass")).clone())}),d())}function d(){if(b&&h&&b.length&&h.length&&k){var a=b.find("option:selected"),a=f(a).attr("data-pickuptypeclass"),d=f("#pickupType"),e=c.getSelect("pickupType");f.each(k,function(a,b){e.removeOptions(d.find("."+a))});k.hasOwnProperty(a)&&(d.append(k[a]),d.find('option[value\x3d"'+d.val()+'"]').hasClass(a)||
e.setValue("All"))}}var f=a.$,b,h,k={},m,q,C,x,u,t,v;a.declarative("country-filter-pickup-point","change",d);a.declarative("filter-de-pickup-types","change",g);a.declarative("filter-fr-pickup-types","change",e);return{reloadSearchUtils:function(){var a=f("input[name\x3dmerchantAutomation]");a&&a.length?l():(a=f("#searchLocale"),a.length&&"de"===a.val()?(m=f(".de-pickup-option").clone(),q=f(".at-pickup-option").clone(),t=f(".nl-pickup-option").clone(),u=f(".lb-pickup-option").clone(),v=f(".pl-pickup-option").clone(),
g()):a.length&&"fr"===a.val()&&(C=f(".fr-pickup-option").clone(),x=f(".be-pickup-option").clone(),e()))}}});"use strict";k.when("A","a-popover-data","a-modal","search-utilities-controller","page-conductor","a-dropdown","client-side-metrics").register("store-search-popover-controller",function(a,c,g,e,l,d,f){function b(){p!==q&&null!==p&&k.when("a-modal").execute(function(a){a.remove(p);p=q})}function h(){!p.isContentLoaded()&&0<D?(D--,setTimeout(h,100)):(r(),D=20)}function r(){if(0<B&&"undefined"!==
typeof m.Map)try{m.Map.getMapAndIcons(),"undefined"!==typeof m.Map&&m.Map.registerPinClickCallback(M),"undefined"!==typeof m.Map&&m.Map.registerPinClickCallback(N),L=!0}catch(a){--B,0<B&&setTimeout(r,500)}0===B&&(B=20)}function M(a){var b=n("#storeAddressList");a=b.find("#form_"+(a+1));a.length&&b.length&&(x(b,a),u(b,a))}function N(a){n("#storeAddressList #form_"+(a+1)).length||f.increaseCount("checkout:locker-map:click-on-search-location-pin",1)}function C(a){a.filter("script").each(function(){this.src&&
0<this.src.indexOf("mapcontrol")&&(E=this.src)})}function x(a,b){a.animate({scrollTop:b.offset().top-a.offset().top+a.scrollTop()})}function u(a,b){a.find(".address-row").removeClass("list-address-selected");b.find(".address-row").addClass("list-address-selected")}function t(a){c.showSpinner(p);n.ajax({type:"POST",url:a,dataType:"html",async:!0,cache:!1,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",headers:{"x-amz-checkout-page":"truespc"},success:function(a,b,c){if(!c.getResponseHeader("x-amz-checkout-popover-valid"))return l.redirect({conductoraction:{url:"/gp/cart/view.html",
type:"redirect"}});b=n(a);p.updateContent(a);p.updatePosition(!0);C(b);null!==E&&!1===L?n.ajax({url:E,async:!1,success:h,dataType:"script"}):h();e.reloadSearchUtils()},error:function(a,b,c){p.updateContent("")}})}function v(a,b){if(a.is("span.a-declarative")){var c=a.find("a");if(c.length&&c.hasClass("locker-search-link"))return c.attr("href")}a=a.parents("form");c=(c=a.attr("action"))?c:"/gp/buy/storeaddress/handlers/popover/search.html";b&&(a=n("#form_"+b));return c+"?"+a.serialize()}function y(){var a=
n("#inlineStoreSearchRow"),b=a.find("[name\x3dpickupUrl]").val()+"?",a=w(a,"pickupUrl"),b=b+a;n("#storeCountry").length&&(a&&a.length&&(b+="\x26"),a=d.getSelect("storeCountry").val(),b+="storeCountry\x3d"+a);return b}function w(a,b){var c="";a.find("input").not("[name\x3d"+b+"]").each(function(){""!==c&&(c+="\x26");c+=n(this).serialize()});return c}function A(a,b){"undefined"!==typeof a&&(a=parseInt(a,10)-1,m.Map.togglePinVisibility(a,b))}function z(a){a.length&&(p&&p.hide(),a.submit())}function I(a,
b){var c=a.find('input[name\x3d"storeId"]'),d=a.find('input[name\x3d"formBaseAction"]');c.length&&d.length&&a.attr("action",d.val()+"/ref\x3d"+b+c.val())}function J(a){if(!p){var b=n("#search-popover-header").html();p=g.create(a,{name:"inline-store-search-popover",header:b,popoverLabel:b})}p.isActive()?(a=y(),t(a)):p.show()}function O(){F&&(l.reloadPage(),F=0)}function K(){if(p!==q&&null!==p){var a=n("#accessibilityPreferenceLink"),a=y(a);null!=G&&null!=H&&(a+="\x26latitude\x3d"+G+"\x26longitude\x3d"+
H);t(a)}else l.reloadPage()}var n=a.$;if(!n("html").hasClass("a-ie6")){var p,E=null,L=!1,B=20,D=20,G=null,H=null;a.declarative("zoom-in-pinpoint","click",function(a){a=a.$target[0].id.replace("pinpointImage_idx_","");var b=n("#storeAddressList"),c=b.find("#form_"+a);c.length&&b.length&&"undefined"!==typeof m.Map&&(m.Map.selectPin(a-1),x(b,c),u(b,c))});a.on("a:popover:show:store-search-popover",function(a){p=a.popover;p.updateContent("");var b=p.attrs("urlTrigger");b?p.attrs("urlTrigger",""):(b=p.attrs("formTrigger"),
b||(b=a.popover.$trigger),b=v(b));t(b)});a.on("a:popover:show:inline-store-search-popover",function(a){p=a.popover;p.updateContent("");a=y();t(a)});a.declarative("trigger-store-search-popover","click",function(a){p?p.updateContent(""):p=g.create(a.$currentTarget,{name:"store-search-popover",header:a.data.header});p.attrs("urlTrigger",v(a.$currentTarget));p.show()});a.on("a:popover:positionUpdated:inline-store-search-popover",function(a){a=a.popover.getContent();if(a.length){var b=a.find(".locker_map_scale");
b.length&&a.find("#sl_map").width(b.innerWidth())}});n(document).delegate("div.store-restrict-warning input[type\x3dcheckbox]","click",function(a){a=n(this).is(":checked");var b=n(this).parents("div.store-restrict-warning").parent().find(".store-ship-btn"),c="ship_to_store_map_button_"+b.attr("id").replace("ship_to_store_button_",""),c=n("#"+c);a?(b.hasClass("a-button-disabled")&&(b.removeClass("a-button-disabled"),b.find("input[type\x3dsubmit]").removeAttr("disabled")),c.hasClass("a-button-disabled")&&
(c.removeClass("a-button-disabled"),c.find("input[type\x3dsubmit]").removeAttr("disabled"))):(b.hasClass("a-button-disabled")||(b.addClass("a-button-disabled"),b.find("input[type\x3dsubmit]").attr("disabled","disabled")),c.hasClass("a-button-disabled")||(c.addClass("a-button-disabled"),c.find("input[type\x3dsubmit]").attr("disabled","disabled")))});n(document).delegate("div#store-search-result input[name\x3dsearchCriterion][type\x3dradio]","click",function(a){a=n(this).attr("value");n(this).parents("form").find("input.search-term").attr("name",
a)});n(document).delegate("div#store-search-result input[name\x3drefineSearch][type\x3dradio]","click",function(a){var b=n(this).parents("[data-a-input-name\x3drefineSearch]");a=b.attr("data-longitude");var b=b.attr("data-latitude"),c=n(this).parents("form");c.find("input[name\x3dlongitude][type\x3dhidden]").attr("value",a);c.find("input[name\x3dlatitude][type\x3dhidden]").attr("value",b);G=b;H=a});n(document).delegate("div#store-search-result .store-address-list input[type\x3dsubmit]","click",function(a){a.preventDefault();
f.increaseCount("checkout:locker-map:click-on-ship-to-address-from-store-list",1);a=n(this).parents("form");I(a,"chk_addr_locker_search_selected_");z(a)});n(document).delegate("form.locker-search","submit",function(a){a.preventDefault();a=n(this).find(".search-btn");if(!p){var b=n("#search-popover-header").html();p=g.create(a,{name:"store-search-popover",header:b,popoverLabel:b})}p.isActive()?(a=v(a),t(a)):(p.attrs("formTrigger",a),p.show())});n(document).delegate("input[name\x3dfilterLocations]",
"change",function(a){n(this).is(":checked")?(n(".ineligible-store").hide(),"undefined"!==typeof m.Map&&n(".ineligible-store").each(function(){A(n(this).attr("data-store-display-number"),!1)})):(n(".ineligible-store").show(),"undefined"!==typeof m.Map&&n(".ineligible-store").each(function(){A(n(this).attr("data-store-display-number"),!0)}))});n(document).delegate("input[name\x3dstoreZip]","keydown",function(a){13===a.which&&n("[name\x3disUnifiedActionsDesignEnabled]").length&&(a.stopPropagation(),
p&&p.isActive()?(a=n("form.locker-search").find(".search-btn"),a=v(a),t(a)):(a=n("#pickupSearchBtn"),J(a)))});a.declarative("trigger-addressselect-search-popover","click",function(a){n("[name\x3disUnifiedActionsDesignEnabled]").length&&J(a.$currentTarget)});a.declarative("map-popover-ship-to-store","submit",function(a){a.$event.preventDefault();f.increaseCount("checkout:locker-map:click-on-ship-to-address-from-popover",1);a=n("#storeAddressList #form_"+a.data.storeIndex);I(a,"chk_locker_map_search_selected_");
z(a)});var F=0;a.on("toggle-preference-success",function(){K();F=1});a.on("toggle-preference-failure",K);a.on("a:popover:dismiss",O);a.on("checkout:reload",b)}});"use strict";k.when("A","mash","client-side-metrics").register("continue-shopping-mash",function(a,c,g){a.declarative("continue-shopping-mash","click",function(a){m.cordova.exec(null,null,"MASHCloseWebview","execute",{})});a.declarative("firetv-review-order-mash","click",function(a){g.increaseCount("checkouttv:review-order-clicked-from-thank-you-page",
1);m.cordova.exec(null,null,"MASHReviewOrder","execute",{})})});k.when("A","a-tv").execute(function(a,c){var g=a.$;c.select(".continuebutton");a.on.ready(function(){var a=g(".review");0<a.length&&c.add(a)})});k.when("A","mash","client-side-metrics").execute(function(a,c,g){a=a.$;a("#tv-final-page-addToCart").length&&(c=m.cordova,c.exec(null,null,"MASHFinalPageNotification","execute",{message:"AddToCart"}));a("#tv-final-page-TYP").length&&(c=m.cordova,c.exec(null,null,"MASHFinalPageNotification","execute",
{message:"ThankYouPage"}));a("#native-add-to-cart").length&&(g.increaseCount("checkouttv:native-add-to-cart-triggered",1),c=m.cordova,c.exec(null,null,"MASHNativeAddToCartPlugin","execute",{}))})});
/* ******** */
